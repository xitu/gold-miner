> * åŸæ–‡åœ°å€ï¼š[Google Santa Trackerâ€Šâ€”â€ŠMoving to an Android App Bundle](https://medium.com/androiddevelopers/google-santa-tracker-moving-to-an-android-app-bundle-dde180716096)
> * åŸæ–‡ä½œè€…ï¼š[Chris Banes](https://medium.com/@chrisbanes)
> * è¯‘æ–‡å‡ºè‡ªï¼š[æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)
> * æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼š[https://github.com/xitu/gold-miner/blob/master/TODO1/google-santa-tracker-moving-to-an-android-app-bundle.md](https://github.com/xitu/gold-miner/blob/master/TODO1/google-santa-tracker-moving-to-an-android-app-bundle.md)
> * è¯‘è€…ï¼š[phxnirvana](https://github.com/phxnirvana)
> * æ ¡å¯¹è€…ï¼š[portandbridge](https://github.com/portandbridge)

# è°·æ­Œå¯»è¸ªåœ£è¯è€äººåº”ç”¨ï¼ˆSanta Trackerï¼‰è¿ç§»åˆ° Android App Bundle è®°å½•

![](https://cdn-images-1.medium.com/max/4240/1*ksxyyNT2V-A2N626DZ9D7A.png)

**æœ¬æ–‡æ˜¯ 2018 è°·æ­Œå¯»è¸ªåœ£è¯è€äººåº”ç”¨æ”¹è¿›æ¢ç´¢ç³»åˆ—æ–‡ç« çš„ç¬¬ä¸€ç¯‡ã€‚**

å¯»è¸ªåœ£è¯è€äººæ˜¯è°·æ­Œæ¯å¹´éƒ½ä¼šå‘å¸ƒçš„ä¸€æ¬¾åº”ç”¨ï¼Œè¿™æ¬¾åº”ç”¨è®©äººä»¬å¯ä»¥åœ¨å…¨çƒè¿½å¯»åœ£è¯è€äººçš„è¶³è¿¹ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ¬¾åº”ç”¨åœ¨ç»è¿‡å‡ å¹´çš„è¿­ä»£åï¼Œä½“ç§¯å‰§å¢ï¼Œ2017 å¹´ç”šè‡³è¾¾åˆ°äº† **60MB**ã€‚æˆ‘ä»¬åœ¨åˆšåˆšè¿‡å»çš„åœ£è¯å­£çš„ç›®æ ‡æ˜¯å¸®å®ƒå¤§é‡å‡è‚¥ï¼Œæœ¬æ–‡è®²è¿°äº†æˆ‘ä»¬å®ç°è¯¥ç›®æ ‡çš„è¿‡ç¨‹ã€‚

***

å¦‚æœè¯»è€…ä½“éªŒè¿‡ [å¯»è¸ªåœ£è¯è€äººåº”ç”¨](https://play.google.com/store/apps/details?id=com.google.android.apps.santatracker) çš„è¯ï¼Œå°±ä¼šå‘ç°è¯¥åº”ç”¨æœ‰ä¸¤å¤§ç‰¹è‰²ï¼Œã€Œè¿½è¸ªå™¨ã€è®©ç”¨æˆ·å¾—ä»¥åœ¨å…¨çƒèŒƒå›´å†…å¯»è§…åœ£è¯è€äººï¼Œå¦å¤–ä¸€ç³»åˆ—åœ¨åäºŒæœˆæä¾›çš„å°æ¸¸æˆæ¥å¸®åŠ©ç”¨æˆ·äº«å—åœ£è¯å­£ğŸ„ã€‚

ã€Œè¿½è¸ªå™¨ã€æ˜¯è¯¥åº”ç”¨çš„ä¸»è¦åŠŸèƒ½ï¼Œä¹Ÿæ˜¯æœ€å¤šè¢«ç”¨æˆ·ä½¿ç”¨çš„åŠŸèƒ½ã€‚è¯¥åŠŸèƒ½äº‹å®ä¸Šåªåœ¨åœ£è¯èŠ‚å‰ 26 å°æ—¶ï¼ˆ12 æœˆ 24 æ—¥ï¼‰å¯ç”¨ï¼Œåœ¨æ­¤æœŸé—´ï¼Œè¿½è¸ªå™¨æ˜¯æœ€å¤šè¢«ä½¿ç”¨çš„åŠŸèƒ½ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œåœ¨ 12 æœˆçš„æ‰€æœ‰ç•Œé¢ä½¿ç”¨ç»Ÿè®¡ä¸­ï¼Œ**37%** æ˜¯åœ¨ 12 æœˆ 24 æ—¥ ä½¿ç”¨çš„ï¼Œè€Œé‚£ä¸€å¤©ï¼Œè¿½è¸ªå™¨çš„ä½¿ç”¨ç‡è¶…è¿‡äº† **65%**ã€‚

é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿™é¡¹åŠŸèƒ½å¦‚æ­¤é‡è¦å‘¢ï¼Ÿåªæœ‰äº†è§£æˆ‘ä»¬çš„ä¸»è¦ç‰¹è‰²æ˜¯ä»€ä¹ˆï¼Œæ‰èƒ½è®©æˆ‘ä»¬æƒ³æ˜ç™½ï¼Œå“ªäº›æ˜¯åº”ç”¨é¦–æ¬¡å®‰è£…æ—¶æœ€å…³é”®çš„åŠŸèƒ½ï¼Œå“ªäº›æ˜¯æ¬¡è¦çš„ã€å¯ä»¥ç§»åˆ°å¦å¤– module ä¸­åŠ¨æ€ä¸‹å‘çš„åŠŸèƒ½ï¼Œè¿™æ ·å°±ä½¿å¾—æˆ‘ä»¬çš„é¦–æ¬¡å®‰è£…ä½“ç§¯å˜å°ã€‚2017 å¹´å‘å¸ƒçš„ app åŒ…å«å…¨éƒ¨åŠŸèƒ½ï¼Œå…¶ä¸­åŒ…æ‹¬å…¨éƒ¨çš„æ¸¸æˆï¼Œå³ä½¿ç”¨æˆ·æ ¹æœ¬ä¸ç©è¿™äº›æ¸¸æˆã€‚

æ˜¯æ—¶å€™å¯¹å¯»è¸ªåœ£è¯è€äººåŠ¨åˆ€å­äº†ï¼Œæˆ‘ä»¬è®¾ç«‹äº†å°†é¦–æ¬¡ä¸‹è½½ä½“ç§¯å‡å°‘åˆ°**ä»…ä»…** 10MB çš„ç›®æ ‡ğŸ˜¥ã€‚

ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªæ•°å­—ï¼Ÿå› ä¸ºæ•°æ®æ˜¾ç¤ºï¼Œç›¸æ¯” 100MB çš„åº”ç”¨ï¼Œ10MB çš„åº”ç”¨æé«˜äº† 30% çš„è½¬åŒ–ç‡ã€‚å½“ç„¶ï¼Œå°½ç®¡è®¸å¤šåº”ç”¨éƒ½åœ¨è¿½è¸ªè½¬åŒ–ç‡ï¼Œå¯»è¸ªåœ£è¯è€äººå´å¹¶ä¸æ˜¯æˆ‘ä»¬è¿½è¸ªè½¬åŒ–ç‡çš„ appã€‚10MB ä¹Ÿæ˜¯ä¸€ä¸ªå°è¯•èµ·æ¥å¾ˆéš¾è¾¾åˆ°çš„ç›®æ ‡ï¼Œæˆ‘ä»¬æƒ³çœ‹çœ‹è¿™ç©¶ç«Ÿæ˜¯ä¸æ˜¯å¯è¡Œçš„ã€‚å…³äºæ›´å¤šç»Ÿè®¡èƒŒåçš„ä¿¡æ¯ï¼Œå¯ä»¥é˜…è¯» [Google Play å›¢é˜Ÿ](https://medium.com/googleplaydev) çš„è¿™ç¯‡æ–‡ç« ï¼š

- [**ä½“ç§¯è¶Šå°ï¼Œå®‰è£…ç‡è¶Šé«˜**ï¼šåº”ç”¨ APK çš„ä½“ç§¯æ˜¯å¦‚ä½•å½±å“å®‰è£…ç‡çš„](https://medium.com/googleplaydev/shrinking-apks-growing-installs-5d3fcba23ce2)

## åŠ¨æ€åˆ†å‘

è¯»è€…å¯èƒ½å¬è¯´è¿‡ [Android App Bundle](https://developer.android.com/platform/technology/app-bundle/) è¿™é¡¹æ–°æŠ€æœ¯ï¼Œè¯¥æŠ€æœ¯ä½¿å¾— Google Play å•†åº—å¯ä»¥åŠ¨æ€ä¸‹å‘ä»…ä»…å’Œç”¨æˆ·è®¾å¤‡ç›¸å…³çš„å®šåˆ¶åº”ç”¨ã€‚è¿™é¡¹æŠ€æœ¯ä¹Ÿå¸®åŠ©æˆ‘ä»¬å¼€äº†ä¸ªå¥½å¤´ã€‚åªéœ€ä¸Šä¼  AABï¼ˆAndroid App Bundleï¼‰æ¥ä»£æ›¿ APKï¼Œæˆ‘ä»¬å°±é©¬ä¸Šè®©ä¸‹è½½ä½“ç§¯å‡å°‘äº†å°†è¿‘ **20%** ï¼Œè¾¾åˆ°äº† **48.5MB**ï¼ˆä» 60MBï¼‰ã€‚ä»¬åªä¸è¿‡æ˜¯èŠ±äº†**ä¸€å°æ­¥**çš„åŠŸå¤«ï¼Œå°±åœ¨ç¼©å‡ä½“ç§¯æ–¹é¢è¿ˆè¿›äº†**ä¸€å¤§æ­¥**ï¼

> å¦‚æœåªæ‰“ç®—ä»æœ¬æ–‡ä¸­å­¦ä¸€é¡¹æŠ€æœ¯ï¼Œä¸€å®šå¾—æ˜¯ä¸Šä¼  AAB æ¥å–ä»£ APKã€‚è¿™ä¸€å°æ”¹åŠ¨æœ‰å¾ˆå¤§æœºä¼šæ¥èŠ‚çœç”¨æˆ·çš„æ—¶é—´å’Œé‡‘é’±ã€‚

Google Play æ˜¯æ€ä¹ˆå®ç°è¿™ç§ç˜¦èº«çš„å‘¢ï¼Ÿè¿™ä¸€åšæ³•èƒ½å¤Ÿåˆ†å‘é’ˆå¯¹ä¸ªåˆ«è®¾å¤‡çš„ä¼˜åŒ–åŒ…ï¼Œè¿™ä¹ˆä¸€æ¥ï¼Œç›¸åº”å·¥å…·å°±èƒ½ä»å®‰è£…åŒ…ä¸­ç§»é™¤æ‰€æœ‰ä¸é€‚ç”¨äºè®¾å¤‡çš„è¯­è¨€èµ„æºã€åˆ†è¾¨ç‡èµ„æºä»¥åŠæœ¬åœ°åº“ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ çš„è®¾å¤‡è®¾ç½®æ˜¯ `fr-FR`ï¼ˆæ³•è¯­ï¼‰ï¼Œåˆ†è¾¨ç‡æ˜¯ `xxhdpi` ï¼ŒCPUæ˜¯ `arm64-v8a` æ¶æ„çš„ï¼Œä¸‹å‘çš„ APK ä¾¿åªä¼šåŒ…å«å¿…è¦çš„èµ„æºï¼Œè€Œä¸ä¼šåŒ…å«è¯¸å¦‚é’ˆå¯¹è¥¿ç­ç‰™è¯­æœ¬åœ°åŒ–çš„å­—ç¬¦ä¸²ä¹‹ç±»çš„ä¸œè¥¿ã€‚å½“å‘ç°æœ¬åœ°åŒ–å­—ç¬¦ä¸²å ç”¨çš„ç©ºé—´æœ‰å¤šå¤§æ—¶ï¼Œä½ ä¸€å®šä¼šå¤§åƒä¸€æƒŠã€‚

ä¸è¦å¿˜äº†è§‚çœ‹ [Android å¼€å‘å¤§ä¼š â€™18](https://developer.android.com/dev-summit/) ä¸Šçš„ â€˜[ä¼˜åŒ–åº”ç”¨çš„ä½“ç§¯](https://www.youtube.com/watch?v=QdoEcfibG-s)â€™ æ¼”è®²æ¥è·å–æ›´å¤šä¿¡æ¯ï¼š

- YouTube è§†é¢‘é“¾æ¥ï¼šhttps://youtu.be/QdoEcfibG-s

## åŠŸèƒ½æ¨¡å—

å°½ç®¡æˆ‘ä»¬æœ‰ç€è‰¯å¥½çš„å¼€å¤´ï¼Œå´ä»è·ç¦» 10MB çš„ç›®æ ‡åä¸‡å…«åƒé‡Œï¼æ‰€ä»¥æˆ‘ä»¬å¼€å§‹è€ƒè™‘å“ªäº›åŠŸèƒ½å¯ä»¥è¢«æ‹†åˆ°åŠ¨æ€åŠŸèƒ½æ¨¡å—ä¸­ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ [Play Core library](https://developer.android.com/guide/app-bundle/playcore) æ¥è·å–æ‰€éœ€çš„æ¨¡å—ã€‚å¥½æ¶ˆæ¯æ˜¯æˆ‘ä»¬å·²ç»æŒ‰é€»è¾‘åˆ†ç¦»äº†ä¸€å¤§æ¨¡å—ï¼šæ¸¸æˆğŸ®ã€‚

äºæ˜¯ä¾¿æœ‰äº†å¦‚ä¸‹çš„è®¡åˆ’ï¼šå°†æ¯ä¸ªæ¸¸æˆæ‹†åˆ†åˆ°å•ç‹¬çš„åŠŸèƒ½æ¨¡å—ä¸­ï¼Œå¹¶åªå½“ç”¨æˆ·ç¬¬ä¸€æ¬¡æ‰“å¼€ç‰¹å®šæ¸¸æˆçš„æ—¶å€™æ‰å®‰è£…ã€‚å¬èµ·æ¥å¾ˆæ£’ï¼Œä¸æ˜¯ä¹ˆï¼Ÿå°½ç®¡é€»è¾‘ä¸Šæ¸¸æˆéƒ½åˆ†ç¦»äº†ï¼Œä½†åŸºç¡€ä»£ç å´**å¹¶æ²¡æœ‰**åˆ†ç¦»ã€‚ç»è¿‡æ•°å¹´çš„åŠŸèƒ½å˜è¿ï¼Œå®ƒä»¬å·²ç»ç¼ ç¼ ç»µç»µéš¾ä»¥åˆ†ç¦»äº†ã€‚åº”ç”¨ä¸­çš„åº“æ¨¡å—å±‚å±‚å å ï¼Œè€Œä¸”åˆ°å¤„æ˜¯é‡å¤çš„èµ„æºã€‚

æˆ‘ä»¬çš„é¦–è¦å·¥ä½œæ˜¯å°†å…¶è§£è€¦å’Œï¼Œå¹¶åœ¨æ¸¸æˆæ¨¡å—ä¹‹é—´å»ºç«‹è¶³å¤Ÿæ¸…æ™°çš„è¾¹ç•Œã€‚æˆ‘ä»¬å°å¿ƒç¿¼ç¿¼åœ°åˆ†ç¦»äº†å…¨éƒ¨çš„æ¸¸æˆæ¨¡å—ï¼Œé€šè¿‡ä½¿ç”¨æ–°çš„ `com.android.dynamic-feature` Gradle æ’ä»¶ï¼Œç°åœ¨æ¯ä¸ªæ¸¸æˆéƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„æ¨¡å—äº†ã€‚å¯¹äºé‚£äº›æœ‰ç€ç›¸åŒä¾èµ–çš„æ¸¸æˆï¼ˆæ¯”å¦‚ â€˜Penguin Swimâ€™ å’Œ â€˜Elf Jetpackâ€™ å…±äº«äº†è®¸å¤šä»£ç ï¼‰ï¼Œä¾èµ–è¢«æ·»åŠ åˆ° â€˜baseâ€™ æ¨¡å—ä¸­ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥åªå®‰è£…ä¸€æ¬¡ï¼ˆåŒæ—¶ç©ä¸¤ä¸ªæ¸¸æˆï¼‰äº†ã€‚

### åŠŸèƒ½æ¨¡å—çš„å®ç°

æ­£å¦‚ä¹‹å‰è¯´è¿‡çš„é‚£æ ·ï¼Œæ¨¡å—è¿ç§»ä¸­å å¤§å¤´çš„å·¥ä½œæ˜¯å·²æœ‰ä»£ç çš„é‡æ–°ç»„ç»‡ï¼Œå¦å¤–ä¹Ÿæœ‰ä¸€äº›å°çš„æ•´åˆå·¥ä½œéœ€è¦é€šè¿‡ [Play Core library](https://developer.android.com/guide/app-bundle/playcore) æ¥å°†å…¶ç©¿æ’èµ·æ¥ã€‚

é¦–å…ˆæ˜¯ç”¨æˆ·å¯åŠ¨æ¸¸æˆæ—¶çš„ UXã€‚æˆ‘ä»¬é¦–å…ˆæ‰“å¼€æ˜¾ç¤º logo å’Œæ¸¸æˆæ ‡é¢˜çš„ â€˜å¯åŠ¨é¡µï¼ˆsplash screenï¼‰â€™ activityï¼Œè¿‡ä¸€å°æ®µæ—¶é—´å†è¿è¡Œæ¸¸æˆã€‚è¿è¡Œæ¸¸æˆéœ€è¦çš„å…¨éƒ¨ä¿¡æ¯éƒ½ä½œä¸º intent extras ä¼ é€åˆ°å¯åŠ¨é¡µäº†ã€‚æ•°å¹´æ¥è¯¥è¡Œä¸ºéƒ½æ²¡æœ‰å˜åŒ–ï¼Œæˆ‘ä»¬ä¹Ÿå¹¶ä¸æ‰“ç®—ä¿®æ”¹è¿™ä¸€è¡Œä¸ºã€‚ç›¸åï¼Œæˆ‘ä»¬ä»ä¸­æ‰¾åˆ°äº†åŠ¨æ€åˆ†å‘åŠŸèƒ½æ¨¡å—çš„åˆ‡å…¥ç‚¹ã€‚

2018 å¹´æˆ‘ä»¬æ›´æ–°äº†å¯åŠ¨è¡Œä¸ºï¼Œå‘é€äº†å››ç‚¹ä¿¡æ¯ï¼šæ¸¸æˆæ ‡é¢˜ã€æ¸¸æˆå›¾æ ‡ã€è¦è¿è¡Œçš„ Activity ç±»ä»¥åŠè¯¥åŠŸèƒ½æ¨¡å—çš„ IDã€‚ä¸€æ—¦å¯åŠ¨é¡µå±•ç¤ºå‡ºæ¥ï¼Œå°±æ£€æŸ¥æ˜¯å¦å®‰è£…äº†ç›¸å…³æ¨¡å—ã€‚å¦‚æœå®‰è£…äº†ï¼Œå°±ç›´æ¥è¿è¡Œï¼Œåä¹‹åˆ™é€šè¿‡ Play Core library è¯·æ±‚å®‰è£…ï¼Œå¹¶å±•ç¤ºä¸‹è½½è¿›åº¦æ¡ï¼š

![](https://cdn-images-1.medium.com/max/2000/1*KPoBN-zNlJPVmjrIy8A8jQ.gif)

æˆ‘ä»¬åœ¨æ—©æœŸæµ‹è¯•ä¸­å‘ç°éœ€è¦å°å¿ƒå¤„ç†ä¸‹è½½å®‰è£…æ—¶çš„åœºæ™¯ã€‚æˆ‘ä»¬å¹¶ä¸æƒ³å› ä¸ºåœ¨ç”¨æˆ·å¤„äºç§»åŠ¨ç½‘ç»œæ—¶å®‰è£…åŠŸèƒ½æ¨¡å—ï¼Œè€Œæ— æ„ä¸­è®©ä»–ä»¬èŠ±é’±ã€‚ä¸ºäº†åº”å¯¹è¿™ç§æƒ…å½¢ï¼Œæˆ‘ä»¬åœ¨æ£€æµ‹åˆ°å½“å‰ç½‘ç»œæ˜¯æµé‡ç½‘ç»œï¼ˆå¦‚ç§»åŠ¨ç½‘ç»œï¼‰æ—¶å¢åŠ äº†ç¡®è®¤å¯¹è¯æ¡†ï¼š

![å½“è¿æ¥åˆ°æµé‡ç½‘ç»œæ—¶çš„ç¡®è®¤å¯¹è¯æ¡†](https://cdn-images-1.medium.com/max/2160/1*2qCP_mHG0gr4eKJ0Md0H1A.png)

æ•´ä½“é€»è¾‘å¦‚ä¸‹ï¼š

```
/* Copyright 2018 Google LLC.
   SPDX-License-Identifier: Apache-2.0 */

override fun onCreate(savedInstanceState: Bundle?) {
    // ... å®‰è£…

    // æ¸¸æˆåŠŸèƒ½æ¨¡å—çš„ Id 
    val featureModuleId = intent.getStringExtra(...)

    if (featureModuleName in splitInstallManager.installedModules) {
        // åŠŸèƒ½æ¨¡å—å·²ç»å®‰è£…ï¼Œç›´æ¥è¿è¡Œ
        launchTargetActivity()
    } else {
        // åŠŸèƒ½æ¨¡å—æ²¡æœ‰å®‰è£…ï¼Œè¯·æ±‚å®‰è£…
        val mgr = getSystemService(Context.CONNECTIVITY_SERVICE) as ConnectivityManager
        if (mgr.activeNetworkInfo?.isConnected == true) {
            // æœ‰ç½‘ç»œ...
            if (mgr.isActiveNetworkMetered) {
                // TODO ...æµé‡ç½‘ç»œï¼Œè¯·æ±‚ç”¨æˆ·ç¡®è®¤
                showMeteredNetworkConfirmDialog()
            } else {
                // ...å¦åˆ™ï¼Œç›´æ¥ä¸‹è½½
                startModuleInstall(featureModuleId)
            }
        } else {
            // æ²¡æœ‰ç½‘ç»œï¼Œæ˜¾ç¤ºé”™è¯¯æ¡†å¹¶é€€å‡º
            onFeatureModuleLaunchFailure()
        }
    }
}
```

ç”±äº Play Core API çš„ç¼˜æ•…ï¼Œ`startModuleInstall()` çš„æ–¹æ³•çœ‹èµ·æ¥æœ‰äº›å¤æ‚ã€‚éœ€è¦åœ¨å®‰è£…æ—¶æ·»åŠ ä¸€ä¸ªç”¨äºå›è°ƒçš„ listenerï¼Œç„¶åå†è¯·æ±‚å®‰è£…ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```
/* Copyright 2018 Google LLC.
   SPDX-License-Identifier: Apache-2.0 */

private lateinit var splitInstallManager: SplitInstallManager
private lateinit var installListener: SplitInstallStateUpdatedListener

private fun startModuleInstall(featureModuleId: String) {
    // æ˜¾ç¤ºè¿›åº¦æ¡
    progressbar.isVisible = true
    progressbar.isIndeterminate = true

    // æ·»åŠ  listener
    splitInstallManager.registerListener(installListener)
    
    // å‘é€è¯·æ±‚ï¼Œå¼€å§‹å®‰è£…
    val request = SplitInstallRequest.newBuilder()
            .addModule(featureModuleId)
            .build()
    splitInstallManager.startInstall(request)
}
```

listener ä¼šç›‘å¬åˆ°å®‰è£…å®Œæˆçš„ä¿¡å·ï¼Œç„¶åè¿è¡Œæ¸¸æˆã€‚å¯ä»¥åœ¨ [è¿™é‡Œ](https://github.com/google/santa-tracker-android/tree/master/santa-tracker/src/main/java/com/google/android/apps/santatracker/games/SplashActivity.kt) æ‰¾åˆ°å®Œæ•´ä»£ç ã€‚

## æˆæœ

å¦‚æœä½ è¯»åˆ°è¿™é‡Œäº†ï¼Œä¸€å®šä¼šæƒ³çŸ¥é“æˆ‘ä»¬çš„æˆæœå¦‚ä½•â€¦â€¦

Android Studio åˆ†æ App Bundleï¼ˆä»¥åŠ APKï¼‰çš„å·¥å…·ç›¸å½“å¥½ç”¨ï¼Œå¯ä»¥æ·±å…¥è§‚å¯Ÿæ¯ä¸ªåŠŸèƒ½æ¨¡å—çš„ä¸‹è½½ä½“ç§¯ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­çœ‹åˆ°æˆ‘ä»¬åº”ç”¨çš„åˆå§‹ä¸‹è½½ä½“ç§¯æ˜¯  11.6MB ï¼ˆå¹¶æ²¡æœ‰è¾¾åˆ° 10MB çš„ç›®æ ‡ï¼‰ï¼Œæ€»ä¸‹è½½ä½“ç§¯æ˜¯ 25.5MBã€‚

![**ä½¿ç”¨ Android Studio ä¸­ Analyze Bundle åŠŸèƒ½è®¡ç®—çš„ä¸‹è½½ä½“ç§¯**](https://cdn-images-1.medium.com/max/3652/1*z6BiUOLlfqpwx58ywfSsVw.png)

![å±•ç¤ºæ¨¡å—ä½“ç§¯å¯¹æ¯”çš„å›¾è¡¨](https://cdn-images-1.medium.com/max/3592/1*aamb-oJ9fhE-7VPpvHh-bA.png)

ä½†â€¦â€¦è¿™äº›å€¼åªå±•ç¤ºäº†ç”Ÿæˆçš„ Android App Bundle æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰è®¡ç®— Google Play åŠ¨æ€ä¸‹å‘ï¼ˆä¸Šæ–‡è®¨è®ºè¿‡ï¼‰èŠ‚çœçš„ä½“ç§¯ã€‚è§‚å¯Ÿç‰¹å®šè®¾å¤‡ä¸‹è½½ä½“ç§¯æœ€å‡†ç¡®çš„æ–¹å¼æ˜¯åœ¨ [Google Play å¼€å‘è€…æ§åˆ¶å°](https://play.google.com/apps/publish/) ä¸­ã€‚ä¸Šä¼  App Bundle åï¼Œå°±å¯ä»¥åœ¨ â€˜Release Managementâ€™ -> â€˜Artifact Libraryâ€™ çœ‹åˆ°ç‰¹å®šè®¾å¤‡çš„ä¸‹å‘åŒ…ä½“ç§¯ï¼š

![è®¡ç®—ç»“æœæ˜¯â€¦â€¦](https://cdn-images-1.medium.com/max/2516/1*yno3GA8adiZ14mVoxpwTVw.png)

å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¾¾åˆ°äº† 10MB çš„ç›®æ ‡ï¼Œä¸‹è½½ä½“ç§¯åªæœ‰ **9.21MB**ï¼ç›¸æ¯” 2017 å¹´ 60MB çš„åº”ç”¨ï¼Œæˆ‘ä»¬å‡å°‘äº† **85%** çš„ä½“ç§¯ï¼ ğŸ‰ğŸ†

![é«˜ç”»è´¨çš„å®é™…æˆªå›¾](https://cdn-images-1.medium.com/max/2048/1*UT_XNkjswxZIyvLT2l-nyg.gif)

### æ™®æƒ ä¼—ç”Ÿ

å¸Œæœ›æœ¬æ–‡å±•ç¤ºäº†è¿ç§»åˆ° App Bundle å¯ä»¥å¸¦ç»™ç”¨æˆ·çš„å·¨å¤§æ”¶ç›Šã€‚å°½ç®¡åˆ†ç¦»æ¨¡å—å¹¶ä¸æ˜¯ä»€ä¹ˆä¸¾æ‰‹ä¹‹åŠ³ï¼Œä½†å¥½çš„ä»£ç å®è·µè¯¸å¦‚é«˜å†…èšä½è€¦åˆä¹Ÿä¼šæ”¶ç›Šè‰¯å¤šã€‚

å…³äºä¸Šé¢çš„æ•°å­—è¿˜æœ‰ä¸€å°ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼Œå…¶ä¸­ä¹Ÿæœ‰æˆ‘ä»¬ä½¿ç”¨çš„å…¶ä»–ä½“ç§¯å‹ç¼©æŠ€æœ¯çš„åŠŸåŠ³ï¼ŒåŒ…æ‹¬ asset å‹ç¼©å’Œè¿ç§»åˆ° R8ã€‚æˆ‘ä»¬ä¼šåœ¨ä¸‹ç¯‡æ–‡ç« ä¸­è®¨è®ºè¿™äº›ã€‚

* **è¯»è€…å¯èƒ½ä¼šå¥½å¥‡ä¸ºä»€ä¹ˆæ˜¯ 26 ä¸ªå°æ—¶è€Œä¸æ˜¯ 24ï¼Ÿè¿™æ˜¯å› ä¸ºå›½é™…æ—¥æœŸå˜æ›´çº¿ [å¹¶ä¸æ˜¯ä¸€æ¡ç›´çº¿](https://en.wikipedia.org/wiki/International_Date_Line#/media/File:International_Date_Line.png)ã€‚åŸºé‡Œå·´æ–¯çš„æ—¶åŒºæ˜¯ [UTC+14](https://www.timeanddate.com/worldclock/difference.html?p1=274)ï¼Œè¿™æ„å‘³ç€å®ƒå’Œè±ªå…°å²›å’Œè´å…‹å²›ï¼ˆUTC-12 æ—¶åŒºï¼‰é—´æœ‰ 26 å°æ—¶çš„æ—¶å·®ã€‚**

> å¦‚æœå‘ç°è¯‘æ–‡å­˜åœ¨é”™è¯¯æˆ–å…¶ä»–éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Œæ¬¢è¿åˆ° [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner) å¯¹è¯‘æ–‡è¿›è¡Œä¿®æ”¹å¹¶ PRï¼Œä¹Ÿå¯è·å¾—ç›¸åº”å¥–åŠ±ç§¯åˆ†ã€‚æ–‡ç« å¼€å¤´çš„ **æœ¬æ–‡æ°¸ä¹…é“¾æ¥** å³ä¸ºæœ¬æ–‡åœ¨ GitHub ä¸Šçš„ MarkDown é“¾æ¥ã€‚

---

> [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner) æ˜¯ä¸€ä¸ªç¿»è¯‘ä¼˜è´¨äº’è”ç½‘æŠ€æœ¯æ–‡ç« çš„ç¤¾åŒºï¼Œæ–‡ç« æ¥æºä¸º [æ˜é‡‘](https://juejin.im) ä¸Šçš„è‹±æ–‡åˆ†äº«æ–‡ç« ã€‚å†…å®¹è¦†ç›– [Android](https://github.com/xitu/gold-miner#android)ã€[iOS](https://github.com/xitu/gold-miner#ios)ã€[å‰ç«¯](https://github.com/xitu/gold-miner#å‰ç«¯)ã€[åç«¯](https://github.com/xitu/gold-miner#åç«¯)ã€[åŒºå—é“¾](https://github.com/xitu/gold-miner#åŒºå—é“¾)ã€[äº§å“](https://github.com/xitu/gold-miner#äº§å“)ã€[è®¾è®¡](https://github.com/xitu/gold-miner#è®¾è®¡)ã€[äººå·¥æ™ºèƒ½](https://github.com/xitu/gold-miner#äººå·¥æ™ºèƒ½)ç­‰é¢†åŸŸï¼Œæƒ³è¦æŸ¥çœ‹æ›´å¤šä¼˜è´¨è¯‘æ–‡è¯·æŒç»­å…³æ³¨ [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)ã€[å®˜æ–¹å¾®åš](http://weibo.com/juejinfanyi)ã€[çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/juejinfanyi)ã€‚
