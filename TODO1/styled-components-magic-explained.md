> * åŸæ–‡åœ°å€ï¼š[The magic behind ğŸ’… styled-components](https://mxstbr.blog/2016/11/styled-components-magic-explained/)
> * åŸæ–‡ä½œè€…ï¼š[https://mxstbr.blog](https://mxstbr.blog)
> * è¯‘æ–‡å‡ºè‡ªï¼š[æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)
> * æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼š[https://github.com/xitu/gold-miner/blob/master/TODO1/styled-components-magic-explained.md](https://github.com/xitu/gold-miner/blob/master/TODO1/styled-components-magic-explained.md)
> * è¯‘è€…ï¼š[WangLeto](https://github.com/WangLeto)
> * æ ¡å¯¹è€…ï¼š[kezhenxu94](https://github.com/kezhenxu94)ï¼Œ[ziyin feng](https://github.com/Fengziyin1234)

# ğŸ’… styled-components èƒŒåçš„é­”æ³•

å¦‚æœä½ ä¸æ›¾äº†è§£ [`styled-components`](https://styled-components.com)ï¼Œä¸‹é¢æ˜¯ styled component ä¸­å®šä¹‰ React ç»„ä»¶çš„å½¢å¼ï¼š

```javascript
const Button = styled.button`
  background-color: papayawhip;
  border-radius: 3px;
  color: palevioletred;
`
```

ä½ å¯ä»¥ç”¨ `Button` å˜é‡æ¥æ¸²æŸ“ç»„ä»¶ï¼Œå°±å¦‚åŒå…¶ä»–ä»»ä½• React ç»„ä»¶ä¸€æ ·ã€‚

```javascript
<Button>Hi Dad!</Button>
```

æ‰€ä»¥åŸç†æ˜¯ä»€ä¹ˆï¼Ÿä½ è§‰å¾—æ˜¯å“ªç§ webpackã€babel ä¹‹ç±»çš„ç¥å¥‡è½¬è¯‘å™¨èƒ½åšåˆ°è¿™æ ·ï¼Ÿ

## æ ‡ç­¾æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆTagged Template Literalsï¼‰

å®é™…ä¸Šï¼Œ`styled.button`` ` è¿™ç§å¤æ€ªçš„å£°æ˜ï¼Œæ˜¯ JavaScript è¯­æ³•çš„ä¸€éƒ¨åˆ†ï¼è¿™æ˜¯ä¸€ç§å«åšâ€œæ ‡ç­¾æ¨¡æ¿å­—ç¬¦ä¸²â€çš„ç‰¹æ€§ï¼Œåœ¨ ES6 ä¸­å¼•å…¥ã€‚

æœ¬è´¨ä¸Šæ¥è¯´ï¼Œè°ƒç”¨å‡½æ•° `styled.button()` å’Œä½¿ç”¨ `styled.button`` ` å‡ ä¹æ˜¯ä¸€å›äº‹ï¼ä½†æ˜¯å½“ä½ ä¼ å…¥å‚æ•°æ—¶å°±ä¼šçœ‹åˆ°ä¸åŒä¹‹å¤„äº†ã€‚

æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªç®€å•çš„å‡½æ•°ç”¨äºæ¢ç´¢ï¼š

```javascript
const logArgs = (...args) => console.log(...args)
```

è¿™ä¸ªå‡½æ•°ä¼šè¾“å‡ºè°ƒç”¨æ—¶ä¼ å…¥çš„å‚æ•°ï¼Œåˆ«çš„ä»€ä¹ˆéƒ½ä¸åšã€‚

> ä½ å¯ä»¥åœ¨ï¼ˆä»»ä½•ç°ä»£æµè§ˆå™¨ï¼‰æ§åˆ¶å°ä¸­ï¼Œç²˜è´´ä¸Šé¢çš„å‡½æ•°ï¼Œç„¶åæ‰§è¡Œæ¥ä¸‹æ¥çš„ä»£ç ï¼Œæ¥è·Ÿéšæˆ‘çš„åˆ†æã€‚

ä¸€ä¸ªç®€å•çš„ä½¿ç”¨ä¾‹å­ï¼š

```javascript
logArgs('a', 'b')
// -> a b
```

> `->` åœ¨æœ¬æ–‡ä¸­è¡¨ç¤ºè¾“å‡ºå†…å®¹

ç°åœ¨ï¼Œè¯•ç€ç”¨æ ‡ç­¾æ¨¡æ¿å­—ç¬¦ä¸²æ¥è°ƒç”¨å®ƒï¼š

```javascript
logArgs``
// -> [""]
```

åªæ‰“å°å‡ºæ¥ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚æœ‰è¶£ï¼å½“ä¼ å…¥ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²è¿›å»åˆä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ

```javascript
logArgs`I like pizza`
// -> ["I like pizza"]
```

å¥½å§ï¼Œæ‰€ä»¥è¿™ä¸ªæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ­£æ˜¯ä¼ å…¥çš„å­—ç¬¦ä¸²ï¼Œä¸ç®¡é‡Œé¢æ˜¯ä»€ä¹ˆå†…å®¹ã€‚é‚£ä¸ºä»€ä¹ˆè¿˜è¦æä¸ªæ•°ç»„å‡ºæ¥å‘¢ï¼Ÿ

### æ’å€¼

æ¨¡æ¿å­—ç¬¦ä¸²å¯ä»¥è¿›è¡Œ**æ’å€¼**ï¼Œç±»ä¼¼äºï¼š`` `I like ${favoriteFood}` ``ã€‚è®©æˆ‘ä»¬å°†ä¸€ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œä½¿ç”¨å°æ‹¬å·è°ƒç”¨ `logArgs`ï¼š

```javascript
const favoriteFood = 'pizza'

logArgs(`I like ${favoriteFood}.`)
// -> I like pizza.
```

å¦‚ä½ æ‰€è§ï¼ŒJavaScript ç»§ç»­è¿è¡Œï¼Œå°†æ’å…¥å­—ç¬¦ä¸²çš„å€¼æ”¾å…¥å­—ç¬¦ä¸²ï¼Œç„¶åä¼ é€’ç»™äº†å‡½æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²æ¥è°ƒç”¨ `logArgs` å‘¢ï¼Ÿ

```javascript
const favoriteFood = 'pizza'

logArgs`I like ${favoriteFood}.`
// -> ["I like ", "."] "pizza"
```

å¼€å§‹æœ‰è¶£èµ·æ¥äº†ï¼šå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¸å†ä»…ä»…æ˜¯å¾—åˆ°äº†ä¸€ä¸ªå†…å®¹ä¸º `"I like pizza"` çš„å­—ç¬¦ä¸²ï¼ˆåƒæˆ‘ä»¬ä½¿ç”¨å°æ‹¬å·è°ƒç”¨çš„æ—¶å€™ï¼‰ã€‚

ä¼ å…¥å‚æ•°çš„ç¬¬ä¸€ä½ä»ç„¶æ˜¯æ•°ç»„ï¼Œä¸è¿‡ç°åœ¨æœ‰äº† 2 ä¸ªå…ƒç´ ï¼šä½äºæ’å€¼å·¦ä¾§çš„ `I like`ï¼Œä½œä¸ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›ä½äºæ’å€¼çš„å³ä¾§çš„ `.`ï¼Œæ˜¯æ•°ç»„ç¬¬äºŒä¸ªå…ƒç´ ã€‚æ’å€¼å†…å®¹ `favoriteFoor` æˆä¸ºäº†ç¬¬äºŒä¸ªä¼ å…¥å‚æ•°ã€‚

![](https://mxstbr.blog/img/logargs-explanation.png)

å¯ä»¥çœ‹åˆ°ï¼Œå·®åˆ«åœ¨äºå½“æˆ‘ä»¬ä½¿ç”¨æ ‡ç­¾æ¨¡æ¿å­—ç¬¦ä¸²è°ƒç”¨ `logArgs` æ—¶ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²è¢«åˆ†è§£äº†ï¼Œé¦–å…ˆæ˜¯åŸå§‹æ–‡å­—ç»„æˆçš„æ•°ç»„ï¼Œç„¶åæ˜¯æ’å€¼ã€‚

å¦‚æœæˆ‘ä»¬æ’å…¥ä¸æ­¢ä¸€ä¸ªå˜é‡å‘¢ï¼Œä½ èƒ½çŒœåˆ°å—ï¼Ÿ

```javascript
const favoriteFood = 'pizza'
const favoriteDrink = 'obi'

logArgs`I like ${favoriteFood} and ${favoriteDrink}.`
// -> ["I like ", " and ", "."] "pizza" "obi"
```

æ¯ä¸ªæ’å…¥çš„å˜é‡ï¼Œéƒ½æˆä¸ºäº†è°ƒç”¨å‡½æ•°ä¼ å…¥çš„ä¸‹ä¸ªå‚æ•°ã€‚ä½ å°½å¯ä»¥æ’å…¥æ–°çš„å˜é‡ï¼Œä¼šä¸€ç›´å‘åç»§ç»­ï¼

ä¸é€šå¸¸è°ƒç”¨å‡½æ•°çš„æ–¹æ³•æ¯”è¾ƒä¸€ä¸‹ï¼š

```javascript
const favoriteFood = 'pizza'
const favoriteDrink = 'obi'

logArgs(`I like ${favoriteFood} and ${favoriteDrink}.`)
// -> I like pizza and obi.
```

æˆ‘ä»¬ä»…ä»…å¾—åˆ°äº†ä¸€ä¸ªé•¿å­—ç¬¦ä¸²ï¼Œæ‰€æœ‰ä¸œè¥¿éƒ½æ‰åœ¨ä¸€èµ·äº†ã€‚

## ä¸ºä»€ä¹ˆè¿™å¾ˆæœ‰ç”¨?

å“å‘¦ä¸é”™å“¦ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½ç”¨ç”¨é‡éŸ³ç¬¦ï¼ˆ`` ` ``ï¼‰è°ƒç”¨å‡½æ•°äº†ï¼Œè€Œä¸”ä¼ å‚ä¹Ÿåˆ«å…·ä¸€æ ¼ï¼Œå“‡å“¦ â€”â€” ä¸è¿‡è¿™åˆæœ‰ä»€ä¹ˆäº†ä¸èµ·çš„ï¼Ÿ

å¥½å§ï¼Œäº‹å®è¯æ˜å¯ä»¥ç”¨å®ƒè¿›è¡Œä¸€äº›å¾ˆé…·çš„æ¢ç´¢ã€‚æˆ‘ä»¬å°† [`styled-components`](https://styled-components.com) ä½œä¸ºæ¡ˆä¾‹ï¼Œåˆ†æä¸€ä¸‹ã€‚

å¯¹äº React ç»„ä»¶ï¼Œä½ å¸Œæœ›ä½¿ç”¨ props å€¼è°ƒæ•´ä»–ä»¬çš„æ ·å¼ã€‚æ¯”å¦‚æˆ‘ä»¬é€šè¿‡ä¼ å…¥ä¸€ä¸ª `primary` çš„ prop å€¼ï¼Œè®© `<Button />` ç»„ä»¶å˜å¤§ä¸€äº›ï¼Œåƒè¿™æ ·ï¼š`<Button primary />`ã€‚

å½“ä½ ä½¿ç”¨ `styled-components` ä¼ å…¥ä¸€ä¸ªæ’å€¼å‡½æ•°ï¼Œæˆ‘ä»¬å…¶å®å°±å‘ç»„ä»¶ä¼ å…¥äº†ä¸€ä¸ª `props`ï¼Œä½¿ç”¨å®ƒå°±å¯ä»¥è¿›è¡Œç»„ä»¶æ ·å¼è°ƒæ•´ã€‚

```javascript
const Button = styled.button`
  font-size: ${props => props.primary ? '2em' : '1em'};
`
```

ç°åœ¨å¦‚æœ `Button` æ˜¯ä¸ªåŸºæœ¬æŒ‰é’®ï¼ˆprimaryï¼‰ï¼Œå°±æœ‰ 2em å¤§å°çš„å­—ä½“ï¼Œå¦åˆ™ä¸º 1emã€‚

```javascript
// font-size: 2em;
<Button primary />

// font-size: 1em;
<Button />
```

å›å¤´çœ‹ä¸€çœ¼ `logArgs` å‡½æ•°ã€‚æˆ‘ä»¬å°è¯•ä½¿ç”¨æ’å€¼å‡½æ•°è°ƒç”¨å®ƒï¼Œå°±åƒä¸Šé¢ `styled.button` ä¸€æ ·ï¼Œåªä¸è¿‡æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨æ’å€¼æ¨¡æ¿å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬ä¼ å…¥ä»€ä¹ˆå‘¢ï¼Ÿ

```javascript
logArgs(`Test ${() => console.log('test')}`)
// -> Test () => console.log('test')
```

å‡½æ•°è¢« `toString` è½¬åŒ–äº†ï¼Œ`logArgs` è·å–åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œçœ‹ä¸Šå»å°±æ˜¯ï¼š`"Test () => console.log('test')"`ã€‚ï¼ˆ**æ³¨æ„ç°åœ¨åªæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸æ˜¯çœŸçš„å‡½æ•°**ï¼‰

æ¯”è¾ƒä¸€ä¸‹ç›´æ¥ä½¿ç”¨æ’å€¼æ¨¡æ¿å­—ç¬¦ä¸²è°ƒç”¨ï¼š

```javascript
logArgs`Test ${() => console.log('test')}`
// -> ["Test", ""] () => console.log('test')
```

æˆ‘çŸ¥é“ä¸Šé¢çš„æ–‡å­—ç°åœ¨è¿˜æ˜¯ä¸æ˜æ˜¾ï¼Œä½†æ˜¯æˆ‘ä»¬æ‹¿åˆ°çš„ç¬¬äºŒä¸ªä¼ å…¥å‚æ•°ç¡®å®æ˜¯ä¸ªå‡½æ•°äº†ï¼ï¼ˆä¸ä»…æ˜¯å‡½æ•°å£°æ˜æ—¶çš„å­—ç¬¦ä¸²ï¼‰åœ¨ä½ çš„æ§åˆ¶å°å¤šè¯•å‡ æ¬¡ï¼Œä»”ç»†è§‚å¯Ÿï¼Œæ¥æ›´å¥½åœ°æ„Ÿå—å®ƒã€‚

è¿™è¡¨ç¤ºæˆ‘ä»¬ç°åœ¨èƒ½å¤Ÿæ‹¿åˆ°å‡½æ•°äº†ï¼Œä¹Ÿèƒ½ç›´æ¥è¿è¡Œå®ƒï¼ä¸ºäº†æ·±å…¥æµ‹è¯•ï¼Œè®©æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªç¨æœ‰ä¸åŒçš„å‡½æ•°ï¼Œå®ƒå¯ä»¥æ‰§è¡Œæ‰€æœ‰ä¼ å…¥å‚æ•°ä¸­çš„å‡½æ•°ï¼š

```javascript
const execFuncArgs = (...args) => args.forEach(arg => {
  if (typeof arg === 'function') {
    arg()
  }
})
```

å½“è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒä¼šå¿½ç•¥æ‰€æœ‰ä¸æ˜¯å‡½æ•°çš„å‚æ•°ï¼Œä½†æ˜¯å¦‚æœä¼ å…¥å‚æ•°æ˜¯å‡½æ•°ï¼Œå®ƒå°±ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼š

```javascript
execFuncArgs('a', 'b')
// -> undefined

execFuncArgs(() => { console.log('this is a function') })
// -> "this is a function"

execFuncArgs('a', () => { console.log('another one') })
// -> "another one"
```

è®©æˆ‘ä»¬è¯•ç€ç”¨å°æ‹¬å·åŒ…è£¹ç€æ¨¡æ¿å­—ç¬¦ä¸²æ¥å†è°ƒç”¨ä¸€æ¬¡ï¼š

```javascript
execFuncArgs(`Hi, ${() => { console.log('Executed!') }}`)
// -> undefined
```

ä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿï¼Œå› ä¸º `execFuncArgs` æ²¡æœ‰è¢«ä¼ å…¥å‡½æ•°ã€‚å®ƒä¸è¿‡å¾—åˆ°äº†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š`"Hi, () => { console.log('I got executed!') }"`ã€‚

ç°åœ¨çœ‹ä¸€ä¸‹ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨æ ‡ç­¾æ¨¡æ¿å­—ç¬¦ä¸²è°ƒç”¨å‡½æ•°ä¼šå‘ç”Ÿä»€ä¹ˆï¼š

```javascript
execFuncArgs`Hi, ${() => { console.log('Executed!') }}`
// -> "Executed!"
```

ä¸ä¹‹å‰ç›¸æ¯”ï¼Œ`execFuncArgs` è·å¾—çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ª**çœŸæ­£çš„å‡½æ•°**ï¼Œå¹¶ä¸”æ‰§è¡Œäº†å®ƒã€‚

`styled-components` åº•å±‚å°±æ˜¯è¿™ä¹ˆåšçš„ï¼åœ¨æ¸²æŸ“æ—¶ï¼Œæˆ‘ä»¬å‘æ‰€æœ‰æ’å€¼å‡½æ•°ä¸­ä¼ å…¥ propsï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥åŸºäº props ä¿®æ”¹æ ·å¼ã€‚

æ ‡ç­¾æ¨¡æ¿å­—ç¬¦ä¸²ä½¿å¾— `styled-components` API å¾—ä»¥å®ç°ï¼Œæ²¡æœ‰è¿™ä¸ªç‰¹æ€§ `styled-compnents` å°±ä¸å¯èƒ½å‡ºç°ã€‚æœŸå¾…å¤§å®¶èƒ½ä»¥ä¸åŒçš„æ–¹å¼åˆ©ç”¨æ ‡ç­¾æ¨¡æ¿å­—ç¬¦ä¸²ï¼

> å¦‚æœå‘ç°è¯‘æ–‡å­˜åœ¨é”™è¯¯æˆ–å…¶ä»–éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Œæ¬¢è¿åˆ° [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner) å¯¹è¯‘æ–‡è¿›è¡Œä¿®æ”¹å¹¶ PRï¼Œä¹Ÿå¯è·å¾—ç›¸åº”å¥–åŠ±ç§¯åˆ†ã€‚æ–‡ç« å¼€å¤´çš„ **æœ¬æ–‡æ°¸ä¹…é“¾æ¥** å³ä¸ºæœ¬æ–‡åœ¨ GitHub ä¸Šçš„ MarkDown é“¾æ¥ã€‚

---

> [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner) æ˜¯ä¸€ä¸ªç¿»è¯‘ä¼˜è´¨äº’è”ç½‘æŠ€æœ¯æ–‡ç« çš„ç¤¾åŒºï¼Œæ–‡ç« æ¥æºä¸º [æ˜é‡‘](https://juejin.im) ä¸Šçš„è‹±æ–‡åˆ†äº«æ–‡ç« ã€‚å†…å®¹è¦†ç›– [Android](https://github.com/xitu/gold-miner#android)ã€[iOS](https://github.com/xitu/gold-miner#ios)ã€[å‰ç«¯](https://github.com/xitu/gold-miner#å‰ç«¯)ã€[åç«¯](https://github.com/xitu/gold-miner#åç«¯)ã€[åŒºå—é“¾](https://github.com/xitu/gold-miner#åŒºå—é“¾)ã€[äº§å“](https://github.com/xitu/gold-miner#äº§å“)ã€[è®¾è®¡](https://github.com/xitu/gold-miner#è®¾è®¡)ã€[äººå·¥æ™ºèƒ½](https://github.com/xitu/gold-miner#äººå·¥æ™ºèƒ½)ç­‰é¢†åŸŸï¼Œæƒ³è¦æŸ¥çœ‹æ›´å¤šä¼˜è´¨è¯‘æ–‡è¯·æŒç»­å…³æ³¨ [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)ã€[å®˜æ–¹å¾®åš](http://weibo.com/juejinfanyi)ã€[çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/juejinfanyi)ã€‚
