> * åŸæ–‡åœ°å€ï¼š[Memory Leaks in Swift: Unit Testing and other tools to avoid them.](https://medium.com/flawless-app-stories/memory-leaks-in-swift-bfd5f95f3a74)
> * åŸæ–‡ä½œè€…ï¼š[Leandro PÃ©rez](https://medium.com/@leandromperez?source=post_header_lockup)
> * è¯‘æ–‡å‡ºè‡ªï¼š[æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)
> * æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼š[https://github.com/xitu/gold-miner/blob/master/TODO1/memory-leaks-in-swift.md](https://github.com/xitu/gold-miner/blob/master/TODO1/memory-leaks-in-swift.md)
> * è¯‘è€…ï¼š[RickeyBoy](https://github.com/rickeyboy)
> * æ ¡å¯¹è€…ï¼š

# Swift ä¸­çš„å†…å­˜æ³„æ¼

## é€šè¿‡å•å…ƒæµ‹è¯•ç­‰æ–¹å¼é¿å…

![](https://cdn-images-1.medium.com/max/2000/1*7ISuh6UwWtqCmfzSUpyUBw.png)

æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å†…å­˜æ³„æ¼ï¼Œä»¥åŠå­¦ä¹ å¦‚ä½•ä½¿ç”¨å•å…ƒæµ‹è¯•æ£€æµ‹å†…å­˜æ³„æ¼ã€‚ç°åœ¨æˆ‘ä»¬å…ˆæ¥å¿«é€Ÿçœ‹ä¸€ä¸ªä¾‹å­ï¼š

```
describe("MyViewController"){
    describe("init") {
        it("must not leak"){
            let vc = LeakTest{
                return MyViewController()
            }
            expect(vc).toNot(leak())
        }
    }
}
```

è¿™æ˜¯ [**SpecLeaks**](https://cocoapods.org/pods/SpecLeaks) ä¸­çš„ä¸€ä¸ªæµ‹è¯•ã€‚

é‡ç‚¹ï¼šæˆ‘å°†è¦è§£é‡Šä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼ï¼Œè®¨è®ºå¾ªç¯å¼•ç”¨ä»¥åŠä¸€äº›å…¶ä»–ä½ å¯èƒ½æ—©å·²çŸ¥é“çš„äº‹æƒ…ã€‚å¦‚æœä½ ä»…ä»…æƒ³é˜…è¯»æœ‰å…³å¯¹æ³„æ¼è¿›è¡Œå•å…ƒæµ‹è¯•çš„éƒ¨åˆ†ï¼Œç›´æ¥è·³åˆ°æœ€åä¸€ç« å³å¯ã€‚

### **å†…å­˜æ³„æ¼**

åœ¨å®é™…ä¸­ï¼Œå†…å­˜æ³„æ¼æ˜¯æˆ‘ä»¬å¼€å‘è€…æœ€å¸¸é¢ä¸´çš„é—®é¢˜ã€‚éšç€ app çš„æˆé•¿ï¼Œæˆ‘ä»¬ä¸º app å¼€å‘äº†ä¸€ä¸ªåˆä¸€ä¸ªçš„åŠŸèƒ½ï¼Œå´ä¹ŸåŒæ—¶å¸¦æ¥äº†å†…å­˜æ³„æ¼çš„é—®é¢˜ã€‚

å†…å­˜æ³„æ¼å°±æ˜¯æŒ‡å†…å­˜ç‰‡æ®µä¸å†ä¼šè¢«ä½¿ç”¨ï¼Œå´è¢«æ°¸ä¹…æŒæœ‰ã€‚å®ƒæ˜¯å†…å­˜åƒåœ¾ï¼Œä¸ä»…å æ®ç©ºé—´ä¹Ÿä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ã€‚

> æŸä¸ªæ—¶åˆ»è¢«åˆ†é…è¿‡ï¼Œä½†åˆæœªè¢«é‡Šæ”¾ï¼Œå¹¶ä¸”ä¹Ÿä¸å†è¢«ä½ çš„ app æŒæœ‰çš„å†…å­˜ï¼Œå°±æ˜¯è¢«æ³„æ¼çš„å†…å­˜ã€‚å› ä¸ºå®ƒä¸å†è¢«å¼•ç”¨ï¼Œæ‰€ä»¥ç°åœ¨æ²¡æœ‰åŠæ³•é‡Šæ”¾æ‰å®ƒï¼Œå®ƒä¹Ÿæ²¡æœ‰åŠæ³•è¢«å†æ¬¡ä½¿ç”¨ã€‚
>
>  [è‹¹æœå®˜æ–¹æ–‡æ¡£](https://developer.apple.com/library/content/documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/CommonMemoryProblems.html)

ä¸è®ºæˆ‘ä»¬æ˜¯æ–°äººè¿˜æ˜¯è€æ‰‹ï¼Œæˆ‘ä»¬æ€»ä¼šåœ¨æŸä¸ªæ—¶é—´ç‚¹åˆ›é€ å†…å­˜æ³„æ¼ï¼Œè¿™æ— å…³æˆ‘ä»¬çš„ç»éªŒå¤šå°‘ã€‚ä¸ºäº†æ‰“é€ ä¸€ä¸ªå¹²å‡€ã€ä¸å´©æºƒçš„åº”ç”¨ï¼Œæ¶ˆé™¤å†…å­˜æ³„æ¼ååˆ†é‡è¦ï¼Œå› ä¸ºå®ƒä»¬**ååˆ†å±é™©**ã€‚

## å†…å­˜æ³„æ¼å¾ˆå±é™©

å†…å­˜æ³„æ¼ä¸ä»…ä¼š**å¢åŠ  app çš„å†…å­˜å ç”¨**ï¼Œä¹Ÿä¼š**å¼•å…¥æœ‰å®³çš„çš„å‰¯ä½œç”¨**ç”šè‡³**å´©æºƒ**ã€‚

ä¸ºä»€ä¹ˆ**å†…å­˜å ç”¨**ä¼šä¸æ–­å¢é•¿ï¼Ÿå®ƒæ˜¯å¯¹è±¡æ²¡æœ‰è¢«é‡Šæ”¾æ‰çš„ç›´æ¥åæœã€‚è¿™äº›å¯¹è±¡å®Œå…¨å°±æ˜¯å†…å­˜åƒåœ¾ï¼Œå½“åˆ›å»ºè¿™äº›å¯¹è±¡çš„æ“ä½œä¸æ–­è¢«æ‰§è¡Œï¼Œå®ƒä»¬å æ®çš„å†…å­˜å°±ä¼šä¸æ–­å¢é•¿ã€‚å¤ªå¤šçš„å†…å­˜åƒåœ¾ï¼è¿™å¯èƒ½å¯¼è‡´å†…å­˜è­¦å‘Šçš„æƒ…å†µï¼Œå¹¶ä¸”æœ€ç»ˆ app ä¼šå´©æºƒã€‚

è§£é‡Š**æœ‰å®³çš„å‰¯ä½œç”¨**éœ€è¦æ›´è¯¦ç»†ä¸€ç‚¹çš„ç»†èŠ‚ã€‚

å‡è®¾æœ‰ä¸€ä¸ªå¯¹è±¡åœ¨è¢«åˆ›å»ºæ—¶çš„ `init` æ–¹æ³•ä¸­å¼€å§‹ç›‘å¬ä¸€ä¸ªé€šçŸ¥ã€‚å®ƒæ¯æ¬¡ç›‘å¬åˆ°é€šçŸ¥åçš„åŠ¨ä½œå°±æ˜¯å°†ä¸€äº›ä¸œè¥¿å­˜å…¥æ•°æ®åº“ä¸­ï¼Œæ’­æ”¾è§†é¢‘æˆ–è€…æ˜¯å¯¹ä¸€ä¸ªåˆ†æå¼•æ“å‘å¸ƒä¸€ä¸ªäº‹ä»¶ã€‚ç”±äºå¯¹è±¡éœ€è¦è¢«å¹³è¡¡ï¼Œæˆ‘ä»¬å¿…é¡»è¦åœ¨å®ƒè¢«é‡Šæ”¾æ—¶åœæ­¢ç›‘å¬é€šçŸ¥ï¼Œè¿™åœ¨ `deinit` ä¸­å®ç°ã€‚

å¦‚æœè¿™æ ·ä¸€ä¸ªå¯¹è±¡æ³„æ¼äº†ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

è¿™ä¸ªå¯¹è±¡æ°¸è¿œä¸ä¼šè¢«é‡Šæ”¾ï¼Œå®ƒæ°¸è¿œä¸ä¼šåœæ­¢ç›‘å¬é€šçŸ¥ã€‚æ¯ä¸€æ¬¡é€šçŸ¥è¢«å‘å¸ƒï¼Œè¯¥å¯¹è±¡å°±ä¼šå“åº”ã€‚å¦‚æœç”¨æˆ·åå¤æ‰§è¡Œæ“ä½œï¼Œåˆ›å»ºè¿™ä¸ªæœ‰é—®é¢˜çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰å¤šä¸ªé‡å¤å¯¹è±¡å­˜åœ¨ã€‚æ‰€æœ‰è¿™äº›å¯¹è±¡éƒ½ä¼šå“åº”è¿™ä¸ªé€šçŸ¥ï¼Œå¹¶ä¸”ä¼šå½¼æ­¤å½±å“ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ**å´©æºƒå¯èƒ½æ˜¯å‘ç”Ÿçš„æœ€å¥½æƒ…å†µ**ã€‚

å¤§é‡æ³„æ¼çš„å¯¹è±¡é‡å¤å“åº”äº† app é€šçŸ¥ï¼Œæ”¹å˜æ•°æ®åº“ã€ç”¨æˆ·ç•Œé¢ï¼Œè…åŒ–æ•´ä¸ª app çš„çŠ¶æ€ã€‚ä½ å¯ä»¥é€šè¿‡ [The Pragmatic Programmer](https://www.goodreads.com/book/show/4099.The_Pragmatic_Programmer) è¿™ç¯‡æ–‡ç« ä¸­çš„ **Dead Programs tell no lies** äº†è§£è¿™ç±»é—®é¢˜çš„é‡è¦æ€§ã€‚

å†…å­˜æ³„æ¼æ¯«æ— ç–‘é—®ä¼šå¯¼è‡´éå¸¸å·®çš„ç”¨æˆ·ä½“éªŒä»¥åŠ App Store ä¸Šçš„ä½åˆ†ã€‚

### å†…å­˜æ³„æ¼äºä½•å¤„äº§ç”Ÿï¼Ÿ

æ¯”å¦‚ç¬¬ä¸‰æ–¹ SDK æˆ–è€…æ¡†æ¶éƒ½å¯èƒ½äº§ç”Ÿå†…å­˜æ³„æ¼ï¼Œç”šè‡³ä¹ŸåŒ…æ‹¬ Apple åˆ›é€ çš„æŸäº›ç±»è¯¸å¦‚ `CALayer` æˆ–è€… `UILabel`ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é™¤äº†ç­‰å¾…æ›´æ–°æˆ–è€… SDK è¢«åºŸå¼ƒä¹‹å¤–åˆ«æ— ä»–æ³•ã€‚

ä½†å†…å­˜æ³„æ¼æ›´å¯èƒ½çš„æ˜¯ç”±æˆ‘ä»¬è‡ªèº«çš„ä»£ç å¯¼è‡´çš„ã€‚**å†…å­˜æ³„æ¼çš„å¤´å·åŸå› åˆ™æ˜¯å¾ªç¯å¼•ç”¨**ã€‚

ä¸ºäº†é¿å…å†…å­˜æ³„æ¼ï¼Œæˆ‘ä»¬å¿…é¡»ç†è§£å†…å­˜ç®¡ç†å’Œå¾ªç¯å¼•ç”¨ã€‚

### å¾ªç¯å¼•ç”¨

**å¾ªç¯**è¿™ä¸ªè¯æ¥æºäº Objective-C ä½¿ç”¨æ‰‹åŠ¨å¼•ç”¨è®¡æ•°çš„æ—¶æœŸã€‚åœ¨èƒ½å¤Ÿä½¿ç”¨è‡ªåŠ¨å¼•ç”¨è®¡æ•°å’Œ Swiftï¼Œä»¥åŠæˆ‘ä»¬ç°åœ¨é’ˆå¯¹å€¼ç±»å‹æ‰€èƒ½åšçš„ä¸€åˆ‡æ–¹ä¾¿çš„äº‹æƒ…ä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Objective-C å’Œæ‰‹åŠ¨å¼•ç”¨è®¡æ•°ã€‚ä½ å¯ä»¥é€šè¿‡ [è¿™ç¯‡æ–‡ç« ](https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/AutomaticReferenceCounting.html) äº†è§£æ‰‹åŠ¨å¼•ç”¨è®¡æ•°å’Œè‡ªåŠ¨å¼•ç”¨è®¡æ•°ã€‚

åœ¨é‚£æ®µæ—¶æœŸï¼Œæˆ‘ä»¬éœ€è¦å¯¹å†…å­˜å¤„ç†äº†è§£æ›´å¤šã€‚ç†è§£åˆ†é…ã€æ‹·è´ã€å¼•ç”¨çš„å«ä¹‰ï¼Œä»¥åŠå¦‚ä½•å¹³è¡¡è¿™äº›æ“ä½œï¼ˆæ¯”å¦‚é‡Šæ”¾ï¼‰æ˜¯éå¸¸é‡è¦çš„ã€‚åŸºæœ¬è§„åˆ™æ˜¯ä¸è®ºä½ ä½•æ—¶åˆ›é€ äº†ä¸€ä¸ªå¯¹è±¡ï¼Œä½ å°±æ‹¥æœ‰äº†å®ƒå¹¶ä¸”ä½ éœ€è¦è´Ÿè´£é‡Šæ”¾æ‰å®ƒã€‚

ç°åœ¨çš„äº‹æƒ…ç®€å•å¾ˆå¤šï¼Œä½†æ˜¯ä»ç„¶éœ€è¦å­¦ä¹ ä¸€äº›æ¦‚å¿µã€‚

Swift ä¸­å½“ä¸€ä¸ªå¯¹è±¡å¯¹å¼ºå…³è”äº†å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå°±æ˜¯å¼•ç”¨äº†å®ƒã€‚è¿™é‡Œè¯´çš„å¯¹è±¡æŒ‡çš„æ˜¯å¼•ç”¨ç±»å‹ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ç±»ã€‚

ç»“æ„ä½“å’Œæšä¸¾éƒ½æ˜¯**å€¼ç±»å‹**ã€‚ä»…æœ‰å€¼ç±»å‹çš„è¯ä¸å¤ªå¯èƒ½äº§ç”Ÿå¾ªç¯å¼•ç”¨ã€‚å½“æ•è·å’Œå­˜å‚¨å€¼ç±»å‹ï¼ˆç»“æ„ä½“å’Œæšä¸¾ï¼‰æ—¶ï¼Œå¹¶ä¸ä¼šæœ‰ä¹‹å‰è¯´çš„å…³äºå¼•ç”¨çš„ç§ç§é—®é¢˜ã€‚å€¼éƒ½æ˜¯è¢«æ‹·è´çš„ï¼Œè€Œä¸æ˜¯è¢«å¼•ç”¨ï¼Œå°½ç®¡å€¼ä¹Ÿèƒ½æŒæœ‰å¯¹å¯¹è±¡çš„å¼•ç”¨ã€‚

å½“ä¸€ä¸ªå¯¹è±¡å¼•ç”¨äº†ç¬¬äºŒä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå°±æ‹¥æœ‰äº†å®ƒã€‚ç¬¬äºŒä¸ªå¯¹è±¡å°†ä¼šä¸€ç›´å­˜åœ¨ç›´åˆ°å®ƒè¢«é‡Šæ”¾ã€‚è¿™è¢«ç§°ä½œ**å¼ºå¼•ç”¨**ã€‚ç›´åˆ°å½“ä½ å°†å¯¹åº”å±æ€§è®¾ç½®ä¸º **nil** æ—¶ç¬¬äºŒä¸ªå¯¹è±¡æ‰ä¼šè¢«é”€æ¯ã€‚

```
class Server {
}

class Client {
    var server : Server //Strong association to a Server instance
    
    init (server : Server) {
        self.server = server
    }
}
```

å¼ºå…³è”ã€‚

A æŒæœ‰ B å¹¶ä¸” B æŒæœ‰ A é‚£ä¹ˆå°±é€ æˆäº†å¾ªç¯å¼•ç”¨ã€‚

A ğŸ‘‰ B + A ğŸ‘ˆ B = ğŸŒ€

```
class Server {
    var clients : [Client] // å› ä¸ºè¿™é‡Œæ˜¯å¼ºå¼•ç”¨
    
    func add(client:Client){
        self.clients.append(client)
    }
}

class Client {
    var server : Server // å¹¶ä¸”è¿™é‡Œä¹Ÿæ˜¯å¼ºå¼•ç”¨
    
    init (server : Server) {
        self.server = server
        
        self.server.add(client:self) // è¿™ä¸€è¡Œäº§ç”Ÿäº†å¾ªç¯å¼•ç”¨ -> å†…å­˜è°¢æ³„æ¼
    }
}
```

å¾ªç¯å¼•ç”¨ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸è®º client è¿˜æ˜¯ server éƒ½å°†æ— æ³•è¢«é‡Šæ”¾å†…å­˜ã€‚

ä¸ºäº†ä»å†…å­˜ä¸­é‡Šæ”¾ï¼Œå¯¹è±¡å¿…é¡»é¦–å…ˆé‡Šæ”¾å…¶æ‰€æœ‰çš„ä¾èµ–å…³ç³»ã€‚ç”±äºå¯¹è±¡æœ¬èº«ä¹Ÿæ˜¯ä¾èµ–é¡¹ï¼Œå› æ­¤æ— æ³•é‡Šæ”¾ã€‚åŒæ ·ï¼Œ**å½“ä¸€ä¸ªå¯¹è±¡å­˜åœ¨å¾ªç¯å¼•ç”¨æ—¶ï¼Œå®ƒä¸ä¼šè¢«é‡Šæ”¾**ã€‚

å½“å¾ªç¯å¼•ç”¨ä¸­çš„ä¸€ä¸ªå¼•ç”¨æ˜¯**å¼±å¼•ç”¨ï¼ˆweakï¼‰æˆ–è€…æ— ä¸»å¼•ç”¨ï¼ˆunownedï¼‰**çš„æ—¶å€™ï¼Œå¾ªç¯å¼•ç”¨å°±å¯ä»¥è¢«æ‰“ç ´ã€‚æœ‰æ—¶å€™ç”±äºæˆ‘ä»¬æ­£åœ¨ç¼–å†™çš„ä»£ç éœ€è¦ç›¸äº’å…³è”ï¼Œå› æ­¤å¾ªç¯å¿…é¡»å­˜åœ¨ã€‚ä½†é—®é¢˜å°±åœ¨äºä¸èƒ½æ‰€æœ‰çš„å…³è”å…³ç³»éƒ½æ˜¯å¼ºå…³è”ï¼Œå…¶ä¸­è‡³å°‘å¿…é¡»æœ‰ä¸€ä¸ªæ˜¯å¼±å…³è”ã€‚

```
class Server {
    var clients : [Client] 
    
    func add(client:Client){
        self.clients.append(client)
    }
}

class Client {
    weak var server : Server! // æ­¤å¤„ä¸ºå¼±å¼•ç”¨
    
    init (server : Server) {
        self.server = server
        
        self.server.add(client:self) // ç°åœ¨ä¸å­˜åœ¨å¾ªç¯å¼•ç”¨äº†
    }
}
```


å¼±å¼•ç”¨å¯ä»¥æ‰“ç ´å¾ªç¯å¼•ç”¨ã€‚

### å¦‚ä½•æ‰“ç ´å¾ªç¯å¼•ç”¨

> Swift æä¾›äº†ä¸¤ç§æ–¹å¼ç”¨ä»¥è§£å†³ä½¿ç”¨å¼•ç”¨ç±»å‹æ—¶å¯¼è‡´çš„çš„å¼ºå¼•ç”¨å¾ªç¯ï¼šWeak å’Œ Unownedã€‚
>
> åœ¨å¾ªç¯å¼•ç”¨ä¸­ä½¿ç”¨ Weak ä»¥åŠ Unownedï¼Œèƒ½è®©ä¸€ä¸ªå®ä¾‹å¼•ç”¨å¦ä¸€ä¸ªå®ä¾‹æ—¶**ä¸å†**ä¿æŒå¼ºæŒæœ‰ã€‚è¿™æ ·å®ä¾‹ä¹‹é—´èƒ½å¤Ÿäº’ç›¸å¼•ç”¨è€Œä¸ä¼šäº§ç”Ÿå¼ºå¼•ç”¨å¾ªç¯ã€‚
>
> [Appleâ€™s Swift Programming Language](https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/AutomaticReferenceCounting.html#//apple_ref/doc/uid/TP40014097-CH20-ID48)

**Weak:** ä¸€ä¸ªå˜é‡èƒ½å¤Ÿå¯é€‰åœ°ä¸æŒæœ‰å…¶å¼•ç”¨çš„å¯¹è±¡ã€‚å½“å˜é‡å¹¶ä¸æŒæœ‰å…¶å¼•ç”¨å¯¹è±¡æ—¶ï¼Œå°±æ˜¯å¼±å¼•ç”¨ã€‚**å¼±å¼•ç”¨å¯ä»¥ä¸º nil**ã€‚

**Unowned:** å’Œå¼±å¼•ç”¨ç›¸ä¼¼ï¼Œæ— ä¸»å¼•ç”¨ä¹Ÿä¸ä¼šå¼ºæŒæœ‰å…¶å¼•ç”¨çš„å®ä¾‹ã€‚ä½†ä¸å¼±å¼•ç”¨ä¸åŒçš„æ˜¯ï¼Œæ— ä¸»å¼•ç”¨å¿…é¡»æ˜¯ä¸€ç›´æœ‰å€¼çš„ã€‚æ­£å› å¦‚æ­¤ï¼Œæ— ä¸»å¼•ç”¨å§‹ç»ˆè¢«å®šä¹‰ä¸ºéå¯é€‰ç±»å‹ã€‚**æ— ä¸»å¼•ç”¨ä¸èƒ½ä¸º nil**ã€‚

[äºŒè€…çš„ä½¿ç”¨æ—¶æœº](https://krakendev.io/blog/weak-and-unowned-references-in-swift)

> å½“é—­åŒ…å’Œå®ƒæ•è·çš„å®ä¾‹äº’ç›¸å¼•ç”¨æ—¶ï¼Œå°†é—­åŒ…ä¸­çš„æ•è·å€¼å®šä¹‰ä¸ºæ— ä¸»å¼•ç”¨ï¼Œè¿™æ ·ä»–ä»¬æ€»æ˜¯ä¼šåŒæ—¶è¢«é‡Šæ”¾å‡ºå†…å­˜ã€‚
>
> ç›¸åçš„ï¼Œå°†é—­åŒ…ä¸­æ•è·çš„å®ä¾‹å®šä¹‰ä¸ºå¼±å¼•ç”¨æ—¶ï¼Œè¿™ä¸ªæ•è·çš„å¼•ç”¨æœ‰å¯èƒ½åœ¨æœªæ¥å˜æˆ `nil`ã€‚å¼±å¼•ç”¨å§‹ç»ˆæ˜¯ä¸€ä¸ªå¯é€‰ç±»å‹ï¼Œå½“å¼•ç”¨çš„å®ä¾‹è¢«é‡Šæ”¾å‡ºå†…å­˜æ—¶å®ƒå°±ä¼šè‡ªåŠ¨å˜æˆ `nil`ã€‚
>
> [Appleâ€™s Swift Programming Language](https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/AutomaticReferenceCounting.html)

```
class Parent {
    var child : Child
    var friend : Friend
    
    init (friend: Friend) {
        self.child = Child()
        self.friend = friend
    }
    
    func doSomething() {
        self.child.doSomething( onComplete: { [unowned self] in  
              //The child dies with the parent, so, when the child calls onComplete, the Parent will be alive
              self.mustBeAlive() 
        })
        
        self.friend.doSomething( onComplete: { [weak self] in
            // The friend might outlive the Parent. The Parent might die and later the friend calls onComplete.
              self?.mightNotBeAlive()
        })
    }
}
```

å¯¹æ¯”å¼±å¼•ç”¨å’Œæ— ä¸»å¼•ç”¨ã€‚

å†™ä»£ç æ—¶å¿˜è®°ä½¿ç”¨ `weak self` çš„æƒ…å†µå¹¶ä¸ç¨€å¥‡ã€‚æˆ‘ä»¬ç»å¸¸åœ¨å†™é—­åŒ…æ—¶å¼•å…¥å†…å­˜æ³„æ¼ï¼Œæ¯”å¦‚åœ¨ä½¿ç”¨ `flatMap` å’Œ `map` è¿™æ ·çš„å‡½æ•°å¼ä»£ç æ—¶ï¼Œæˆ–è€…æ˜¯åœ¨å†™æ¶ˆæ¯ç›‘å¬ã€ä»£ç†çš„ç›¸å…³ä»£ç æ—¶ã€‚[è¿™ç¯‡æ–‡ç« ](https://medium.com/@stremsdoerfer/understanding-memory-leaks-in-closures-48207214cba) é‡Œä½ å¯ä»¥è¯»åˆ°æ›´å¤šå…³äºé—­åŒ…ä¸­å†…å­˜æ³„æ¼çš„å†…å®¹ã€‚

### å¦‚ä½•æ¶ˆé™¤å†…å­˜æ³„æ¼ï¼Ÿ

1. ä¸è¦åˆ›é€ å‡ºå†…å­˜æ³„æ¼ã€‚å¯¹å†…å­˜ç®¡ç†æœ‰æ›´æ·±åˆ»çš„è®¤è¯†ã€‚ä¸ºé¡¹ç›®å®šä¹‰å®Œå–„çš„ [ä»£ç é£æ ¼](https://swift.org/documentation/api-design-guidelines/%5C)ï¼Œå¹¶ä¸”ä¸¥æ ¼éµå®ˆã€‚å¦‚æœä½ è¶³å¤Ÿä¸¥è°¨ï¼Œå¹¶ä¸”éµå¾ªä½ çš„ä»£ç é£æ ¼ï¼Œé‚£ä¹ˆç¼ºå°‘ `weak self` ä¹Ÿå°†å®¹æ˜“è¢«å‘ç°ã€‚ä»£ç å®¡æŸ¥ä¹Ÿèƒ½æä¾›å¾ˆå¤§å¸®åŠ©ã€‚
2. ä½¿ç”¨ [Swift Lint](https://github.com/realm/SwiftLint)ã€‚è¿™æ˜¯ä¸€ä¸ªä¸€ä¸ªå¾ˆæ£’çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¼ºåˆ¶ä½ éµå¾ªä¸€ç§ä»£ç é£æ ¼ï¼Œéµå¾ªç¬¬ä¸€æ¡è§„åˆ™ã€‚å®ƒèƒ½å¤Ÿå¸®ä½ æ—©åœ¨ç¼–è¯‘æœŸå°±å‘ç°ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚ä»£ç†å˜é‡å£°æ˜æ—¶å¹¶æ²¡æœ‰è¢«å£°æ˜ä¸ºå¼±å¼•ç”¨ï¼Œè¿™åŸæœ¬å¯èƒ½å¯¼è‡´å¾ªç¯å¼•ç”¨ã€‚
3. åœ¨è¿è¡ŒæœŸé—´æ£€æµ‹å†…å­˜æ³„æ¼ï¼Œå¹¶å°†å®ƒä»¬å¯è§†åŒ–ã€‚å¦‚æœä½ æ¸…æ¥šæŸä¸ªç‰¹å®šçš„å¯¹è±¡åœ¨ç‰¹å®šæ—¶åˆ»æœ‰å¤šå°‘å®ä¾‹å­˜åœ¨ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨ [LifetimeTracker](https://github.com/krzysztofzablocki/LifetimeTracker)ã€‚è¿™æ˜¯ä¸€ä¸ªèƒ½åœ¨å¼€å‘æ¨¡å¼ä¸‹è¿è¡Œçš„å¥½å·¥å…·ã€‚
4. ç»å¸¸è¯„æµ‹ appã€‚Xcode ä¸­çš„ [å†…å­˜åˆ†æå·¥å…·](https://developer.apple.com/library/content/documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/CommonMemoryProblems.html) éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥å‚è€ƒ [è¿™ç¯‡æ–‡ç« ](https://useyourloaf.com/blog/xcode-visual-memory-debugger/). ä¸ä¹…ä¹‹å‰ Instruments ä¹Ÿæ˜¯ä¸€ç§æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯éå¸¸æ£’çš„å·¥å…·ã€‚
5. ä½¿ç”¨ [**SpecLeaks**](https://cocoapods.org/pods/SpecLeaks) å¯¹å†…å­˜æ³„æ¼è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚è¿™ä¸ªç¬¬ä¸‰æ–¹åº“ä½¿ç”¨ Quick å’Œ Nimble è®©ä½ æ–¹ä¾¿åœ°å¯¹å†…å­˜æ³„æ¼è¿›è¡Œæµ‹è¯•ã€‚ä½ å¯ä»¥åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­æ›´å¤šåœ°äº†è§£åˆ°å®ƒã€‚

### å¯¹å†…å­˜æ³„æ¼è¿›è¡Œå•å…ƒæµ‹è¯•

ä¸€æ—¦æˆ‘ä»¬çŸ¥é“å¾ªç¯å’Œå¼±å¼•ç”¨æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Œæˆ‘ä»¬å°±èƒ½ä¸ºå¾ªç¯å¼•ç”¨ç¼–å†™æµ‹è¯•ï¼Œæ–¹æ³•å°±æ˜¯å¼±å¼•ç”¨å»æ£€æµ‹å¾ªç¯ã€‚åªéœ€è¦å¯¹æŸä¸ªå¯¹è±¡è¿›è¡Œå¼±å¼•ç”¨ï¼Œæˆ‘ä»¬å°±èƒ½æµ‹è¯•å‡ºè¯¥å¯¹è±¡æ˜¯å¦æœ‰å†…å­˜æ³„æ¼ã€‚

> å› ä¸ºå¼±å¼•ç”¨å¹¶ä¸ä¼šæŒæœ‰å…¶å¼•ç”¨çš„å®ä¾‹ï¼Œæ‰€ä»¥å½“å®ä¾‹è¢«é‡Šæ”¾å‡ºå†…å­˜æ—¶ï¼Œå¾ˆå¯èƒ½å¼±å¼•ç”¨ä»ç„¶æŒ‡å‘è¯¥å®ä¾‹ã€‚å› æ­¤ï¼Œ**å½“å¼±å¼•ç”¨å¼•ç”¨çš„å¯¹è±¡è¢«é‡Šæ”¾åï¼Œè‡ªåŠ¨å¼•ç”¨è®¡æ•°ä¼šå°†å¼±å¼•ç”¨è®¾ç½®ä¸º**  `nil`ã€‚

å‡è®¾æˆ‘ä»¬æƒ³çŸ¥é“ `x` æ˜¯å¦å‘ç”Ÿäº†å†…å­˜æ³„æ¼ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘å®ƒçš„å¼±å¼•ç”¨ï¼Œå«åš `leakReference`ã€‚å¦‚æœ `x` è¢«ä»å†…å­˜ä¸­é‡Šæ”¾ï¼ŒARC ä¼šå°† `leakReference` è®¾ç½®ä¸º nilã€‚æ‰€ä»¥ï¼Œå¦‚æœ `x` å‘ç”Ÿäº†å†…å­˜æ³„æ¼ï¼Œ`leakReference` æ°¸è¿œä¸ä¼šè¢«è®¾ç½®ä¸º nilã€‚

```
func isLeaking() -> Bool {
   
    var x : SomeObject? = SomeObject()
  
    weak var leakReference = x
  
    x = nil
    
    if leakReference == nil {
        return false // æ²¡å‘ç”Ÿå†…å­˜æ³„æ¼
    }
    else{
        return true // å‘ç”Ÿäº†å†…å­˜æ³„æ¼
    }
}
```

æµ‹è¯•ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å‘ç”Ÿå†…å­˜æ³„æ¼ã€‚

å¦‚æœ `x` çœŸçš„å‘ç”Ÿäº†å†…å­˜æ³„æ¼ï¼Œå¼±å¼•ç”¨ `leakReference` ä¼šæŒ‡å‘è¿™ä¸ªå‘ç”Ÿå†…å­˜æ³„æ¼çš„å®ä¾‹ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœè¯¥å¯¹è±¡æ²¡å‘ç”Ÿå†…å­˜æ³„éœ²ï¼Œé‚£ä¹ˆåœ¨è¯¥å¯¹è±¡è¢«è®¾ç½®ä¸º nil ä¹‹åï¼Œå®ƒå°†ä¸å†å­˜åœ¨ã€‚è¿™æ ·çš„è¯ï¼Œ`leakReference` å°†ä¼šä¸º nilã€‚

"Swift by Sundell" åœ¨ [è¿™ç¯‡æ–‡ç« ](https://www.swiftbysundell.com/posts/using-unit-tests-to-identify-avoid-memory-leaks-in-swift) ä¸­è¯¦ç»†é˜è¿°äº†ä¸åŒå†…å­˜æ³„æ¼çš„åŒºåˆ«ï¼Œå¯¹æˆ‘å†™æœ¬æ–‡ä»¥åŠ SpecLeaks éƒ½æœ‰æå¤§çš„å¸®åŠ©ã€‚å¦å¤– [ä¸€ç¯‡ä½³ä½œ](https://medium.com/wolox-driving-innovation/how-to-automatically-detect-a-memory-leak-in-ios-769b7bb1ec7c) ä¹Ÿé‡‡ç”¨äº†ç±»ä¼¼çš„æ–¹å¼ã€‚

åŸºäºè¿™äº›ç†è®ºï¼Œæˆ‘å†™å‡ºäº† SpecLeacksï¼Œä¸€ä¸ªåŸºäº Quick å’Œ Nimbleã€èƒ½å¤Ÿæ£€æµ‹å†…å­˜æ³„æ¼çš„æ‹“å±•ã€‚æ ¸å¿ƒå°±æ˜¯ç¼–å†™å•å…ƒæµ‹è¯•æ¥æ£€æµ‹å†…å­˜æ³„æ¼ï¼Œä¸éœ€è¦å¤§é‡å†—ä½™çš„æ ·æ¿ä»£ç ã€‚

### SpecLeaks

ç»“åˆä½¿ç”¨ Quick å’Œ Nimble èƒ½æ›´å¥½åœ°ç¼–å†™æ›´äººæ€§åŒ–ã€å¯è¯»æ€§æ›´å¼ºçš„å•å…ƒæµ‹è¯•ã€‚[SpecLeaks](https://cocoapods.org/pods/SpecLeaks) åªæ˜¯åœ¨è¿™ä¸¤ä¸ªæ¡†æ¶çš„åŸºç¡€ä¹‹ä¸Šå¢åŠ äº†ä¸€ç‚¹ç‚¹åŠŸèƒ½ï¼Œä½¿å…¶èƒ½å¤Ÿè®©ä½ æ›´æ–¹ä¾¿åœ°ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œæ¥æ£€æµ‹æ˜¯å¦æœ‰å¯¹è±¡å‘ç”Ÿäº†å†…å­˜æ³„æ¼ã€‚

å¦‚æœä½ å¯¹å•å…ƒæµ‹è¯•å¹¶ä¸äº†è§£ï¼Œé‚£ä¹ˆè¿™å¼ æˆªå›¾ä¹Ÿè®¸èƒ½å¤Ÿç»™ä½ ä¸€ä¸ªæç¤ºï¼Œå‘Šè¯‰ä½ å•å…ƒæµ‹è¯•åšäº†äº›ä»€ä¹ˆï¼š

![](https://cdn-images-1.medium.com/max/1000/1*i8K2uBxYToiym52MvIrFFQ.png)

ä½ å¯ä»¥å†™å•å…ƒæµ‹è¯•æ¥å®ä¾‹åŒ–ä¸€äº›å¯¹è±¡ï¼Œå¹¶åœ¨åŸºäºå®ƒä»¬åšä¸€äº›å°è¯•ã€‚ä½ å®šä¹‰æœŸæœ›çš„ç»“æœï¼Œä»¥åŠæ€æ ·çš„ç»“æœæ‰ç®—ç¬¦åˆé¢„æœŸï¼Œæ‰èƒ½é€šè¿‡æµ‹è¯•ï¼Œè®©æµ‹è¯•ç»“æœå‘ˆç°ç»¿è‰²ã€‚å¦‚æœæœ€ç»ˆç»“æœå¹¶ä¸ç¬¦åˆæœ€å¼€å§‹å®šä¹‰çš„é¢„æœŸï¼Œé‚£ä¹ˆæµ‹è¯•å°†ä¼šå¤±è´¥å¹¶å‘ˆç°å‡ºçº¢è‰²ã€‚

#### **æµ‹è¯•åˆå§‹åŒ–é˜¶æ®µçš„å†…å­˜æ³„æ¼**

è¿™æ˜¯æ£€æµ‹å†…å­˜æ³„æ¼çš„æµ‹è¯•ä¸­ï¼Œæœ€ç®€å•çš„ä¸€ä¸ªï¼Œåªéœ€è¦åˆå§‹åŒ–ä¸€ä¸ªå®ä¾‹å¹¶çœ‹å®ƒæ˜¯å¦å‘ç”Ÿäº†å†…å­˜æ³„æ¼ã€‚æœ‰æ—¶ï¼Œè¿™ä¸ªå¯¹è±¡æ³¨å†Œäº†ç›‘å¬äº‹ä»¶ï¼Œæˆ–è€…æ˜¯æœ‰ä»£ç†æ–¹æ³•ï¼Œæˆ–è€…æ³¨å†Œäº†é€šçŸ¥ï¼Œè¿™äº›æƒ…å†µä¸‹ï¼Œè¿™ç±»æµ‹è¯•å°±èƒ½æ£€æµ‹å‡ºä¸€äº›å†…å­˜æ³„æ¼ï¼š

```
describe("UIViewController"){
    let test = LeakTest{
        return UIViewController()
    }

    describe("init") {
        it("must not leak"){
            expect(test).toNot(leak())
        }
    }
}
```

æµ‹è¯•åˆå§‹åŒ–é˜¶æ®µã€‚

#### æµ‹è¯• viewController ä¸­çš„å†…å­˜æ³„æ¼

ä¸€ä¸ª viewController å¯èƒ½åœ¨å®ƒçš„å­è§†å›¾åŠ è½½å®Œæˆåå¼€å§‹å‘ç”Ÿå†…å­˜æ³„æ¼ã€‚åœ¨æ­¤ä¹‹åï¼Œä¼šå‘ç”Ÿå¤§é‡çš„äº‹æƒ…ï¼Œä½†æ˜¯ä½¿ç”¨è¿™ä¸ªç®€å•çš„æµ‹è¯•ä½ å°±èƒ½ä¿è¯åœ¨ viewDidLoad æ–¹æ³•ä¸­ä¸å­˜åœ¨å†…å­˜æ³„æ¼ã€‚

```
describe("a CustomViewController") {
    let test = LeakTest{
        let storyboard = UIStoryboard.init(name: "CustomViewController", bundle: Bundle(for: CustomViewController.self))
        return storyboard.instantiateInitialViewController() as! CustomViewController
    }

    describe("init + viewDidLoad()") {
        it("must not leak"){
            expect(test).toNot(leak())
            //SpecLeaks will detect that a view controller is being tested 
            // It will create it's view so viewDidLoad() is called too
        }
    }
}
```

å¯¹ä¸€ä¸ª viewController çš„ init å’Œ viewDidLoad è¿›è¡Œæµ‹è¯•ã€‚

ä½¿ç”¨ **SpecLeaks** ä½ ä¸éœ€è¦ä¸ºäº†ä½¿ `viewDidLoad` æ–¹æ³•è¢«è°ƒç”¨è€Œæ‰‹åŠ¨è°ƒç”¨ viewController ä¸Šçš„ `view`ã€‚å½“ä½ æµ‹è¯• `UIViewController` çš„å­ç±»æ—¶ SpecLeaks å°†ä¼šæ›¿ä½ åšè¿™äº›ã€‚

#### æµ‹è¯•æ–¹æ³•è¢«è°ƒç”¨æ—¶çš„å†…å­˜æ³„æ¼

æœ‰æ—¶å€™åˆå§‹åŒ–ä¸€ä¸ªå®ä¾‹å¹¶ä¸èƒ½åˆ¤æ–­æ˜¯å¦å‘ç”Ÿäº†å†…å­˜æ³„æ¼ï¼Œå› ä¸ºå†…å­˜æ³„æ¼æœ‰å¯èƒ½åœ¨æŸä¸ªæ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™å‘ç”Ÿã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥åœ¨æ“ä½œè¢«æ‰§è¡Œçš„æ—¶å€™æµ‹è¯•æ˜¯å¦æœ‰å†…å­˜æ³„æ¼ï¼Œåƒè¿™æ ·ï¼š

```
describe("doSomething") {
    it("must not leak"){
        
        let doSomething : (CustomViewController) -> () = { vc in
            vc.doSomething()
        }

        expect(test).toNot(leakWhen(doSomething))
    }
}
```

æ£€æµ‹è‡ªå®šä¹‰ viewController æ˜¯å¦åœ¨ `doSomething` æ–¹æ³•è¢«è°ƒç”¨æ—¶å‘ç”Ÿå†…å­˜æ³„æ¼ã€‚

### æ€»ç»“ä¸€ä¸‹

å†…å­˜æ³„æ¼èƒ½äº§ç”Ÿå¤§é‡é—®é¢˜ï¼Œä»–ä»¬ä¼šå¯¼è‡´æå·®çš„ç”¨æˆ·ä½“éªŒã€å´©æºƒå’Œ App Store ä¸­çš„å·®è¯„ï¼Œæˆ‘ä»¬å¿…é¡»è¦æ¶ˆé™¤å®ƒä»¬ã€‚è‰¯å¥½çš„ä»£ç é£æ ¼ã€è‰¯å¥½çš„å®è·µã€å¯¹å†…å­˜ç®¡ç†é€å½»çš„ç†è§£ä»¥åŠå•å…ƒæµ‹è¯•éƒ½èƒ½èµ·åˆ°æœ‰æ•ˆçš„å¸®åŠ©ã€‚

ä½†æ˜¯å•å…ƒæµ‹è¯•å¹¶ä¸èƒ½ä¿è¯å†…å­˜æµ‹è¯•å®Œå…¨ä¸å‘ç”Ÿï¼Œä½ å¹¶ä¸èƒ½è¦†ç›–æ‰€æœ‰çš„æ–¹æ³•è°ƒç”¨å’ŒçŠ¶æ€ï¼Œæµ‹è¯•æ¯ä¸€ä¸ªå­˜åœ¨ä¸å…¶ä»–å¯¹è±¡ç›¸äº’ä½œç”¨çš„ä¸œè¥¿æ˜¯ä¸å¤ªå¯èƒ½çš„ã€‚å¦å¤–ï¼Œæœ‰æ—¶å€™å¿…é¡»è¦æ¨¡æ‹Ÿä¾èµ–ï¼Œæ‰èƒ½å‘ç°åŸå§‹çš„ä¾èµ–å¯èƒ½å‘ç”Ÿçš„å†…å­˜æ³„æ¼ã€‚

å•å…ƒæµ‹è¯•ç¡®å®èƒ½é™ä½å‘ç”Ÿå†…å­˜æ³„æ¼çš„å¯èƒ½æ€§ï¼Œä½¿ç”¨ [**SpeakLeaks**](https://cocoapods.org/pods/SpecLeaks) å¯ä»¥éå¸¸æ–¹ä¾¿çš„æ£€æµ‹ã€å‘ç°å‡ºé—­åŒ…ä¸­çš„å†…å­˜æ³„æ¼ï¼Œå°±æ¯”å¦‚ `flatMap` æˆ–è€…æ˜¯å…¶ä»–æŒæœ‰äº† `self` çš„é€ƒé€¸é—­åŒ…ã€‚å¦‚æœä½ å¿˜è®°å°†ä»£ç†å£°æ˜ä¸ºå¼±å¼•ç”¨ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ã€‚

æˆ‘å¤§é‡åœ°ä½¿ç”¨äº† RxSwiftï¼Œä»¥åŠ faltMapã€mapã€subscribe å’Œä¸€äº›å…¶ä»–éœ€è¦ä¼ é€’é—­åŒ…çš„å‡½æ•°ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œç¼ºå°‘ weak æˆ– unowned ç»å¸¸ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼Œè€Œä½¿ç”¨ SpecLeaks å°±èƒ½è½»æ˜“çš„æ£€æµ‹å‡ºæ¥ã€‚

å°±ä¸ªäººè€Œè¨€ï¼Œæˆ‘å§‹ç»ˆå°è¯•åœ¨æˆ‘çš„æ‰€æœ‰ç±»ä¹‹ä¸­å¢åŠ è¿™æ ·çš„æµ‹è¯•ã€‚ä¾‹å¦‚æ¯å½“æˆ‘åˆ›é€ ä¸€ä¸ª viewControllerï¼Œæˆ‘å°±ä¼šä¸ºå®ƒåˆ›é€ ä¸€ä»½ SpecLeaks ä»£ç ã€‚æœ‰æ—¶å€™ viewController ä¼šåœ¨åŠ è½½è§†å›¾æ—¶å‘ç”Ÿå†…å­˜æ³„æ¼ï¼Œç”¨è¿™ç±»æµ‹è¯•å°±èƒ½è½»è€Œæ˜“ä¸¾åœ°å‘ç°ã€‚

é‚£ä¹ˆä½ æ„ä¸‹å¦‚ä½•ï¼Ÿä½ ä¼šä¸ºæ£€æµ‹å†…å­˜æ³„æ¼è€Œå†™å•å…ƒæµ‹è¯•å—ï¼Ÿä½ ä¼šå†™æµ‹è¯•å—ï¼Ÿ

æˆ‘å¸Œæœ›ä½ å–œæ¬¢é˜…è¯»æœ¬æ–‡ï¼Œå¦‚æœä½ æœ‰ä»»ä½•çš„å»ºè®®å’Œç–‘é—®éƒ½å¯ä»¥ç»™æˆ‘å›å¤ï¼è¯·å°½æƒ…å°è¯• SpeckLeaks :)

* * *

æ„Ÿè°¢ [Flawless App](https://medium.com/@FlawlessApp?source=post_page)ã€‚

---

> [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner) æ˜¯ä¸€ä¸ªç¿»è¯‘ä¼˜è´¨äº’è”ç½‘æŠ€æœ¯æ–‡ç« çš„ç¤¾åŒºï¼Œæ–‡ç« æ¥æºä¸º [æ˜é‡‘](https://juejin.im) ä¸Šçš„è‹±æ–‡åˆ†äº«æ–‡ç« ã€‚å†…å®¹è¦†ç›– [Android](https://github.com/xitu/gold-miner#android)ã€[iOS](https://github.com/xitu/gold-miner#ios)ã€[å‰ç«¯](https://github.com/xitu/gold-miner#å‰ç«¯)ã€[åç«¯](https://github.com/xitu/gold-miner#åç«¯)ã€[åŒºå—é“¾](https://github.com/xitu/gold-miner#åŒºå—é“¾)ã€[äº§å“](https://github.com/xitu/gold-miner#äº§å“)ã€[è®¾è®¡](https://github.com/xitu/gold-miner#è®¾è®¡)ã€[äººå·¥æ™ºèƒ½](https://github.com/xitu/gold-miner#äººå·¥æ™ºèƒ½)ç­‰é¢†åŸŸï¼Œæƒ³è¦æŸ¥çœ‹æ›´å¤šä¼˜è´¨è¯‘æ–‡è¯·æŒç»­å…³æ³¨ [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)ã€[å®˜æ–¹å¾®åš](http://weibo.com/juejinfanyi)ã€[çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/juejinfanyi)ã€‚
