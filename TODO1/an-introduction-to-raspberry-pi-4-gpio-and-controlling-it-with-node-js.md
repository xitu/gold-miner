> * åŸæ–‡åœ°å€ï¼š[An introduction to Raspberry Pi 4 GPIO and controlling it with Node.js](https://itnext.io/an-introduction-to-raspberry-pi-4-gpio-and-controlling-it-with-node-js-10f2ce41af12)
> * åŸæ–‡ä½œè€…ï¼š[Uday Hiwarale](https://medium.com/@thatisuday)
> * è¯‘æ–‡å‡ºè‡ªï¼š[æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)
> * æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼š[https://github.com/xitu/gold-miner/blob/master/TODO1/an-introduction-to-raspberry-pi-4-gpio-and-controlling-it-with-node-js.md](https://github.com/xitu/gold-miner/blob/master/TODO1/an-introduction-to-raspberry-pi-4-gpio-and-controlling-it-with-node-js.md)
> * è¯‘è€…ï¼š[Weirdochr](https://github.com/Weirdochr), [lsvih](https://github.com/lsvih)
> * æ ¡å¯¹è€…ï¼š[xionglong58](https://github.com/xionglong58)

# æ ‘è“æ´¾ 4 GPIO ç®€ä»‹åŠä½¿ç”¨ Node.js æ§åˆ¶æ ‘è“æ´¾

> æ ‘è“æ´¾ + NODE.JS  
> é€šè¿‡æœ¬æ–‡ï¼Œæˆ‘ä»¬å°†ç†Ÿæ‚‰æ ‘è“æ´¾ GPIO åŠå…¶æŠ€æœ¯è§„èŒƒã€‚å¹¶ä¸”ï¼Œæˆ‘ä»¬å°†é€šè¿‡äº†ä¸€ä¸ªç®€å•ä¾‹å­ï¼Œè¯´æ˜å¦‚ä½•ä½¿ç”¨æ ‘è“æ´¾çš„ I/O æ§åˆ¶ LED å’Œå¼€å…³ã€‚

![(æ–‡ç« æ¥æºï¼š[**pexels.com**](https://www.pexels.com/photo/have-a-break-led-signage-2249342/))](https://cdn-images-1.medium.com/max/12000/1*t-dr_5CrKf45RE0Uuww2sg.jpeg)

ä½ å¯èƒ½è§è¿‡ â€œ**IoT**â€ è¿™ä¸ªæœ¯è¯­ï¼Œå®ƒæ˜¯ **Internet of Thingsï¼ˆç‰©è”ç½‘ï¼‰** çš„ç¼©å†™ã€‚æ„æ€æ˜¯ï¼Œäººä»¬å¯ä»¥é€šè¿‡äº’è”ç½‘æ§åˆ¶ä¸€å°è®¾å¤‡ï¼ˆå³â€œç‰©â€ **thing**ï¼‰ã€‚æ¯”å¦‚ï¼Œç”¨æ‰‹æœºæ§åˆ¶ä½ æˆ¿é—´å†…çš„æ™ºèƒ½ç”µç¯æ³¡å°±æ˜¯ä¸€ç§ç‰©è”ç½‘çš„åº”ç”¨ã€‚

ç”±äºç‰©è”ç½‘è®¾å¤‡å¯é€šè¿‡äº’è”ç½‘æ§åˆ¶ï¼Œæ‰€ä»¥ IoT è®¾å¤‡éœ€è¦å§‹ç»ˆä¸äº’è”ç½‘ç›¸è¿ã€‚æˆ‘ä»¬ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼å°†è®¾å¤‡è¿æ¥è‡³äº’è”ç½‘ï¼šä»¥å¤ªç½‘ç½‘çº¿å’Œ WiFiã€‚

ç‰©è”ç½‘è®¾å¤‡å¯è¢«ç”¨äºå„ç§ç›®çš„ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ç‰©è”ç½‘æ¥æ§åˆ¶ä½ å®¶çš„å®¤å†…æ¸©åº¦ã€ç…§æ˜æˆ–è€…åœ¨å›å®¶å‰æ‰“å¼€æŸäº›è®¾å¤‡ï¼Œæ‰€æœ‰è¿™äº›æ“ä½œéƒ½åªéœ€è¦é€šè¿‡ä½ çš„æ‰‹æœºä¾¿èƒ½å®ç°ã€‚

é‚£ä¹ˆï¼Œç‰©è”ç½‘è®¾å¤‡çš„æŠ€æœ¯è§„èŒƒæœ‰å“ªäº›ï¼Ÿç®€è¨€ä¹‹ï¼Œå®ƒåº”è¯¥åŒ…å«è¿æ¥åˆ°äº’è”ç½‘çš„å·¥å…·ï¼Œæœ‰ä¸€äº›è¾“å…¥å’Œè¾“å‡ºæ¥å£æ¥è¯»å†™è®¾å¤‡çš„æ¨¡æ‹Ÿæˆ–æ•°å­—ä¿¡å·ï¼Œå¹¶ä¸”ä½¿ç”¨æœ€å°‘çš„ç¡¬ä»¶æ¥è¯»å–å’Œæ‰§è¡Œç¨‹åºæŒ‡ä»¤ã€‚

ä¸€ä¸ªç‰©è”ç½‘è®¾å¤‡é…æœ‰ä¸€ä¸ªç¡¬ä»¶ç»„ä»¶ï¼Œä¸ºå¤–éƒ¨è®¾å¤‡è¯»å–æ•°å­—æ•°æ®å’Œå–ç”µæä¾›æ¥å£ã€‚è¯¥æ¥å£å°±æ˜¯ **GPIO** æˆ–ç§°ä½œ **General Purpose Input Outputï¼ˆé€šç”¨è¾“å…¥è¾“å‡ºæ¥å£ï¼‰** ã€‚è¿™ç§ç¡¬ä»¶ç»„ä»¶åŸºæœ¬ä¸Šéƒ½æ˜¯ç”±ä¸€ç³»åˆ—å¯ä»¥è¿æ¥åˆ°å¤–éƒ¨è®¾å¤‡çš„å¼•è„šï¼ˆæˆ–ç®¡è„šï¼Œpinï¼‰æ„æˆã€‚

è¿™äº› GPIO å¼•è„šå¯ä»¥è¢«ç¨‹åºæ§åˆ¶ã€‚æ¯”å¦‚ï¼Œåœ¨æ»¡è¶³ä¸€äº›æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ä¸€ä¸ª GPIO å¼•è„šæ–½ä»¥ 5V çš„ç”µå‹ï¼Œä»»ä½•è¿æ¥åˆ°è¯¥å¼•è„šçš„è®¾å¤‡éƒ½ä¼šè¢«å¼€å¯ã€‚ç¨‹åºä¹Ÿèƒ½å¤Ÿç›‘å¬æ¥è‡ªäº’è”ç½‘çš„ä¿¡å·ï¼Œå¹¶æ ¹æ®è¯¥ä¿¡å·å¯¹ GPIO å¼•è„šè¿›è¡Œæ§åˆ¶ã€‚è¿™å°±æ˜¯ç‰©è”ç½‘ã€‚

ä»å¤´å¼€å§‹æ„å»ºè¿™æ ·ä¸€ä¸ªç‰©è”ç½‘è®¾å¤‡å¯èƒ½å¾ˆå›°éš¾ï¼Œå› ä¸ºéœ€è¦å¤„ç†çš„ç»„ä»¶æœ‰å¾ˆå¤šã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è´­ä¹°å”®ä»·ä½å»‰çš„ç°æˆçš„è®¾å¤‡ã€‚è¿™äº›è®¾å¤‡é…æœ‰ GPIO ç¡¬ä»¶å’Œè¿æ¥äº’è”ç½‘çš„å·¥å…·ã€‚

#### Arduino å¾®æ§åˆ¶å™¨

ç›®å‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å®ç°ç®€å•çš„è‡ªåŠ¨åŒ–ï¼Œé‚£ä¹ˆ [**Arduino**](https://en.wikipedia.org/wiki/Arduino) æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚å®ƒæ˜¯ä¸€ä¸ª **å¾®æ§åˆ¶å™¨ï¼ˆmicro-controllerï¼‰** ï¼Œå¯ä»¥ç”¨ C å’Œ C++ è¿™æ ·çš„ç¼–ç¨‹è¯­è¨€æ¥ç¼–å†™ Arduino ç¨‹åºã€‚

![(æ¥æºï¼š[**Wikipedia**](https://en.wikipedia.org/wiki/File:Arduino_Uno_-_R3.jpg))](https://cdn-images-1.medium.com/max/2000/1*-Tmb_Q7yYmmtFGaUk6iv4A.jpeg)

ç„¶è€Œï¼Œè¯¥æ§åˆ¶å™¨ä¸é…æœ‰å†…ç½® WiFi æˆ–ä»¥å¤ªç½‘æ’å­”ï¼Œå¹¶ä¸”å¿…é¡»è¿æ¥å¤–éƒ¨å¤–å›´è®¾å¤‡ï¼ˆå³**å±è”½**ï¼‰æ‰èƒ½å°† Arduino è¿æ¥åˆ°äº’è”ç½‘ã€‚

Arduino æ—¨åœ¨å……å½“å¤–éƒ¨è®¾å¤‡çš„æ§åˆ¶å™¨ï¼Œè€Œä¸æ˜¯æˆç†Ÿçš„ç‰©è”ç½‘è®¾å¤‡ã€‚å› æ­¤ï¼Œè¯¥æ§åˆ¶å™¨ä»·æ ¼éå¸¸ä¾¿å®œï¼ŒæŸäº›æœ€æ–°æ¬¾çš„å”®ä»·å¯ä»¥ä½è‡³ 18 ç¾å…ƒã€‚

#### æ ‘è“æ´¾å¾®å‹ç”µè„‘

ç›¸è¾ƒäº Arduinoï¼Œ[**æ ‘è“æ´¾**](https://en.wikipedia.org/wiki/Raspberry_Pi) æ›´åƒæ˜¯ä¸€åª**é‡å…½**ã€‚å…¶å‘æ˜ä¹‹åˆçš„ç›®çš„å°±æ˜¯ä¸ºäº†ä¿ƒè¿›åŸºç¡€è®¡ç®—æœºç§‘å­¦æ•™å­¦åœ¨å­¦æ ¡å’Œå‘å±•ä¸­å›½å®¶çš„è¿›æ­¥ã€‚ä½†å®ƒç°åœ¨å´è¢«ä¹¦å‘†å­å’Œä¸šä½™çˆ±å¥½è€…ä»¬æ¡èµ·æ¥åˆ›é€ å„ç§å„æ ·çš„å°ç©æ„å„¿ã€‚ç›®å‰ï¼Œå®ƒæ˜¯ä¸–ç•Œä¸Šæœ€å—æ¬¢è¿çš„**å•æ¿è®¡ç®—æœº**ä¹‹ä¸€ã€‚

æ ‘è“æ´¾ï¼ˆ**æœ€æ–°ç‰ˆ 4B**ï¼‰é…æœ‰ä»¥å¤ªç½‘è¿æ¥å™¨ã€WiFiã€è“ç‰™ã€HDMI è¾“å‡ºã€USB è¿æ¥å™¨ã€ 40 ä¸ª GPIO å¼•è„šå’Œå…¶ä»–åŸºæœ¬åŠŸèƒ½ã€‚å®ƒç”± **ARM** CPUã€ **åšé€š** GPU å’Œ 1/2/4 GB çš„ **RAM** é©±åŠ¨ã€‚ä½ å¯ä»¥åœ¨[**æ­¤ç»´åŸºç™¾ç§‘**](https://en.wikipedia.org/wiki/Raspberry_Pi#Specifications)çš„è¡¨æ ¼ä¸­æŸ¥çœ‹è¿™äº›è§„èŒƒã€‚

![(æ¥æºï¼š[**Wikipedia**](https://en.wikipedia.org/wiki/File:Raspberry_Pi_4_Model_B_-_Side.jpg))](https://cdn-images-1.medium.com/max/2000/1*WE-9WUau6aQlMSHVLjq9KQ.jpeg)

å°½ç®¡æ ‘è“æ´¾çš„ç¡¬ä»¶å¾ˆä¸°å¯Œï¼Œä½†å®ƒæœ€æ–°ç‰ˆçš„å”®ä»·ä¹Ÿä»…åœ¨ \$40 åˆ° \$80 é—´ã€‚åˆ«å¿˜äº†ï¼Œè¿™å¯æ˜¯ä¸€å°æ‹¥æœ‰åŸç”Ÿæ“ä½œç³»ç»Ÿçš„æˆç†Ÿè®¡ç®—æœºã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¸éœ€è¦è¿æ¥å¤–éƒ¨è®¡ç®—æœºå°±èƒ½å¯¹å…¶è¿›è¡Œç¼–ç¨‹ã€‚

ä¸æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„ç”µè„‘ä¸åŒï¼Œæ ‘è“æ´¾æä¾›äº†ä¸€ä¸ª GPIO ç¡¬ä»¶ç»„ä»¶æ¥æ§åˆ¶å¤–éƒ¨è®¾å¤‡ã€‚è¿™ä½¿å¾—æ ‘è“æ´¾æˆä¸ºäº†ä¸€ç§å‡ ä¹å¯ä»¥åšä»»ä½•äº‹æƒ…çš„è®¾å¤‡ã€‚

è®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹æ–°ç‰ˆæ ‘è“æ´¾ GPIO çš„æŠ€æœ¯è§„æ ¼ã€‚

---

## æ ‘è“æ´¾ - GPIO å¼•è„šåˆ†é…

æ ‘è“æ´¾ï¼ˆ**4B ç‰ˆ**ï¼‰æ€»å…± **40 ä¸ª GPIO å¼•è„š**ï¼Œåˆ†å¸ƒåœ¨ `20 x 2` çš„é˜µåˆ—å½“ä¸­ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¯ä¸ªå¼•è„šéƒ½æœ‰ç‰¹å®šçš„ç”¨é€”ã€‚

![(æ¥æºï¼š[**raspberrypi.org**](https://www.raspberrypi.org/documentation/usage/gpio/))](https://cdn-images-1.medium.com/max/4128/0*VsaGvGskvJa20hZa.png)

åœ¨è®¨è®ºæ¯ä¸ªå¼•è„šçš„åŠŸèƒ½ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€äº›åè®®ã€‚æ¯ä¸ªå¼•è„šéƒ½æœ‰ç‰¹å®šçš„ç¼–å·ï¼Œæˆ‘ä»¬å°±æ˜¯é€šè¿‡è¿™äº›ç¼–å·ä»è½¯ä»¶ä¸­æ§åˆ¶è¿™äº›å¼•è„šã€‚

åœ¨åœ†åœˆä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°çš„æ•°å­—æ˜¯ GPIO ç¡¬ä»¶ä¸Šçš„ç‰©ç†å¼•è„šç¼–å·ã€‚ä¾‹å¦‚ï¼š**1 å·å¼•è„š** æä¾› 3.3V çš„æ’å®šç”µå‹ã€‚è¯¥ç¼–å·ç³»ç»Ÿç§°ä¸º **Board pin** æˆ–**ç‰©ç†å¼•è„š**ç¼–å·ç³»ç»Ÿã€‚

ç”±äºæ ‘è“æ´¾ 4B ä½¿ç”¨ [**BCM2711**](https://www.raspberrypi.org/documentation/hardware/raspberrypi/bcm2711/README.md) å¤„ç†å™¨èŠ¯ç‰‡ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦ä¸€ä¸ªç”±[**åšé€š**](https://en.wikipedia.org/wiki/Broadcom_Inc.)åˆ›å»ºçš„å¼•è„šç¼–å·ç³»ç»Ÿã€‚æ­¤ç³»ç»Ÿè¢«ç§°ä¸º **BCM** æˆ– **åšé€šæ¨¡å¼**ã€‚ä¸Šå›¾ä¸­ï¼Œæ¯ä¸ªå¼•è„šé™„å¸¦çš„æ ‡ç­¾éƒ½æ˜¾ç¤ºäº† BCM å¼•è„šç¼–å·ã€‚ä¾‹å¦‚ï¼šç‰©ç† **7 å·å¼•è„š**æ˜¯ **BCM 7 å·å¼•è„š**å¹¶è¢«æ ‡è®°ä¸º **GPIO 4**ã€‚

æˆ‘ä»¬æ—¢å¯ä»¥é€‰æ‹©éµå¾ª **Board pin** ç¼–ç ï¼Œä¹Ÿå¯ä»¥ç”¨ **BCM** ç¼–ç ç³»ç»Ÿã€‚ç„¶è€Œï¼Œç”±äºæˆ‘ä»¬ç”¨ GPIO ç¼–ç¨‹åº“çš„åŸå› ï¼ŒåŒæ—¶ä½¿ç”¨è¯¥ä¸¤ç§ç¼–ç ç³»ç»Ÿå¯èƒ½ä¼šé‡åˆ°é—®é¢˜ã€‚å¤§å¤šæ•°åº“éƒ½åå¥½äº BCM ç¼–å·ç³»ç»Ÿï¼Œå› ä¸ºå®ƒå¼•ç”¨äºåšé€š CPU èŠ¯ç‰‡ã€‚

> ä»ç°åœ¨å¼€å§‹ï¼Œå¦‚æœæ–‡ä¸­å‡ºç° **x å·å¼•è„š**ï¼Œå°±æ„å‘³ç€è¿™æ˜¯å¼•è„šæ¿ä¸Šçš„**ç‰©ç†å¼•è„šç¼–å·**ã€‚å¦‚æœæåˆ°äº† BCMï¼Œåˆ™æ„å‘³ç€æˆ‘ä»¬åœ¨ä½¿ç”¨ BCM å¼•è„šç¼–å·ã€‚

#### ğŸ’¡ ç”µæºå¼•è„šå’Œå¼•è„šåˆ†ç»„

**1 å·**å’Œ **17 å·**å¼•è„šæä¾› **3.3V** ç”µæºï¼Œè€Œ **2 å·**å’Œ **4 å·**å¼•è„šæä¾› **5V** ç”µæºã€‚å½“ä½ æ‰“å¼€æ ‘è“æ´¾æ—¶ï¼Œè¿™äº›å¼•è„šä¾¿ä¼šæä¾›**æ’å®šåŠŸç‡**ï¼Œå¹¶ä¸”æ— è®ºåœ¨ä½•ç§æ¡ä»¶ä¸‹ï¼Œè¿™å‡ ä¸ªå¼•è„šéƒ½æ˜¯**ä¸å¯ç¼–ç¨‹çš„**ã€‚

**6 å·**ã€ **9 å·**ã€ **14 å·**ã€ **20 å·**ã€ **25 å·**ã€ **30 å·**ã€ **34 å·**å’Œ **39 å·**å¼•è„šæ”¯æŒæ¥åœ°ã€‚å®ƒä»¬åº”è¯¥ä¸ç”µè·¯çš„**é˜´æ**ç›¸è¿ã€‚ç”µè·¯ä¸­æ‰€æœ‰çš„æ¥åœ°è¿æ¥éƒ½å¯ä»¥ç”¨åŒä¸€ä¸ªæ¥åœ°å¼•è„šï¼Œå› ä¸ºå®ƒä»¬éƒ½è¿æ¥åˆ°åŒä¸€æ ¹åœ°çº¿ã€‚

> å¦‚æœä½ æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆå¤šæ¥åœ°å¼•è„šï¼Œå¯ä»¥æŸ¥çœ‹[**è¿™ä¸ªå¸–å­**](https://www.raspberrypi.org/forums/viewtopic.php?t=132851)ã€‚

#### ğŸ”Œ GPIO å¼•è„š

é™¤äº†**ç”µæº**å’Œ**æ¥åœ°**å¼•è„šå¤–ï¼Œå…¶ä»–å¼•è„šå‡ä¸ºé€šç”¨è¾“å…¥å’Œè¾“å‡ºå¼•è„šã€‚å½“ GPIO å¼•è„šç”¨äº**è¾“å‡ºæ¨¡å¼**æ—¶ï¼Œå®ƒåœ¨å¼€å¯æ—¶æä¾› 3.3V æ’å®šåŠŸç‡ã€‚

åœ¨**è¾“å…¥æ¨¡å¼**ä¸‹ï¼ŒGPIO å¼•è„šä¹Ÿå¯ç”¨äºç›‘å¬å¤–éƒ¨ç”µæºã€‚ä»æŠ€æœ¯ä¸Šçœ‹ï¼Œå½“ç”¨ **3.3V** ç”µå‹ä¾›ç»™å¤„äºè¾“å…¥æ¨¡å¼çš„ GPIO å¼•è„šæ—¶ï¼Œè¯¥å¼•è„šå°†è¢«è¯»å–ä¸º**é€»è¾‘é«˜ç”µå¹³**æˆ– **1**ã€‚å½“å¼•è„šæ¥åœ°æˆ–æä¾› **0V** åŠŸç‡æ—¶ï¼Œå®ƒä¼šè¢«è¯»ä½œ**é€»è¾‘ä½ç”µå¹³**æˆ– **0**ã€‚

è€Œ**è¾“å‡ºæ¨¡å¼**æ›´åŠ ç®€å•ã€‚åœ¨è¾“å‡ºæ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬æ¥é€šä¸€ä¸ªå¼•è„šï¼Œè®¾å¤‡ä¼šé€šè¿‡è¯¥å¼•è„šæä¾› 3.3V çš„ç”µå‹ã€‚è€Œåœ¨å¼•è„šçš„è¾“å…¥ç«¯ï¼Œæˆ‘ä»¬éœ€è¦ç›‘å¬å¼•è„šä¸Šçš„ç”µå‹å˜åŒ–ï¼Œå½“å¼•è„šå¤„äºé€»è¾‘é«˜ç”µå¹³æˆ–ä½ç”µå¹³æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œå¦‚æ‰“å¼€ä¸€ä¸ªè¾“å‡º GPIO å¼•è„šã€‚

#### ğŸ§™â€â™€ï¸ SPIã€ IÂ²C å’Œ UART åè®®

SPIï¼ˆ[**Serial Peripheral Interface (ä¸²è¡Œå¤–è®¾æ¥å£)**](https://en.wikipedia.org/wiki/Serial_Peripheral_Interface)ï¼‰æ˜¯ä¸€ç§åŒæ­¥ä¸²è¡Œé€šä¿¡æ¥å£ï¼Œè®¾å¤‡å¯ä»¥ä½¿ç”¨å®ƒæ¥å®ç°ç›¸äº’é—´çš„é€šä¿¡ã€‚æ­¤æ¥å£éœ€è¦ 3 æ¡æˆ–æ›´å¤šæ•°æ®çº¿å°†ä¸»è®¾å¤‡è¿æ¥åˆ°ï¼ˆ**ä¸€ä¸ªæˆ–å¤šä¸ª**ï¼‰ä»è®¾å¤‡ã€‚

IÂ²Cï¼ˆ[**Inter-Integrated Circuit (å†…ç½®é›†æˆç”µè·¯)**](http://C)ï¼‰ç±»ä¼¼äº SPIï¼Œä½†å®ƒæ”¯æŒå¤šä¸ªä¸»è®¾å¤‡ã€‚æ­¤å¤–ï¼Œä¸ SPI ä¸åŒï¼Œå®ƒåªéœ€è¦ä¸¤æ¡æ•°æ®çº¿æ¥å®¹çº³å¤šä¸ªä»æœºã€‚ä¸è¿‡è¿™ä¼šè®© IÂ²C æ¯” SPI æ…¢ã€‚

UARTï¼ˆ[Universal asynchronous receiver-transmitter (é€šç”¨å¼‚æ­¥æ”¶å‘ä¼ è¾“å™¨)](https://en.wikipedia.org/wiki/Universal_asynchronous_receiver-transmitter)ï¼‰ä¹Ÿæ˜¯ä¸€ä¸ªä¸²è¡Œé€šä¿¡æ¥å£ï¼Œä½†æ•°æ®æ˜¯[**å¼‚æ­¥**](https://en.wikipedia.org/wiki/Asynchronous_serial_communication)å‘é€çš„ã€‚

æ ‘è“æ´¾æä¾›äº†ä¸€ä¸ªåº•å±‚æ¥å£ç”¨äºé€šè¿‡ GPIO å¼•è„šå°±åƒæˆ‘ä»¬å‰æ–‡è®¨è®ºè¿‡çš„è¾“å…¥è¾“å‡ºæ¨¡å¼ä¸€æ ·å¯ç”¨è¿™äº›æ¥å£ã€‚ç„¶è€Œï¼Œå¹¶éæ‰€æœ‰çš„ GPIO å¼•è„šéƒ½å¯ä»¥å®ç°è¿™äº›é€šä¿¡æ–¹å¼ã€‚

åœ¨ä¸‹å›¾ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°å“ªäº› GPIO é’ˆè„šæ˜¯å¯ä»¥é€šè¿‡ SPIã€IÂ²C å’Œ UART åè®®è¿›è¡Œé…ç½®çš„ã€‚ä½ å¯ä»¥è®¿é—® **[pinout.xyz](https://pinout.xyz/)**ï¼Œè¿™ä¸ªç½‘é¡µæä¾›äº†ä¸€ä¸ªäº¤äº’ç•Œé¢ä¾›ç”¨æˆ·æŸ¥çœ‹æ¯ä¸ª GPIO å¼•è„šçš„åŠŸèƒ½ã€‚

![(æ¥æºï¼š[**pinout.xyz**](https://pinout.xyz/))](https://cdn-images-1.medium.com/max/2000/1*mpKa3QDHL6G5CmjmMWX3UQ.png)

é™¤äº†ç®€å•çš„è¾“å…¥æˆ–è¾“å‡ºæ¨¡å¼ï¼ŒGPIO å¼•è„šæœ‰ **6 ç§æ¨¡å¼**ï¼Œä½†æ¯æ¬¡åªèƒ½åœ¨ä¸€ç§æ¨¡å¼ä¸‹å·¥ä½œã€‚å½“ä½ åœ¨ä¸Šé¢é‚£ä¸ªç½‘é¡µä¸­ç‚¹å‡» GPIO å¼•è„šæ—¶ï¼Œä½ å¯ä»¥åœ¨å±å¹•å³ä¾§çœ‹åˆ°å®ƒçš„å·¥ä½œæ¨¡å¼ã€‚å³è¡¨ä¸­çš„ ALT0 è‡³ ALT5 æè¿°äº†è¿™äº›æ¨¡å¼ã€‚

> ä½ è¿˜å¯ä»¥é€šè¿‡[**è¿™ä¸ªè§†é¢‘**](https://www.youtube.com/watch?v=IyGwvGzrqp8)æ¥äº†è§£è¿™äº›é€šä¿¡åè®®çš„è§„èŒƒã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šæ¶‰åŠè¿™äº›é€šä¿¡åè®®ï¼Œä½†æ˜¯ï¼Œæˆ‘å°†åœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­è®¨è®ºç›¸å…³ä¸»é¢˜ã€‚

#### âš¡ ç°è¡Œè§„èŒƒ

æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡ç”µæºå’Œ GPIO å¼•è„šçš„ç”µå‹è§„æ ¼ã€‚å› ä¸ºæ ‘è“æ´¾å®˜æ–¹æ–‡ä»¶ä¸­æœªæ›¾æåŠå…·ä½“è§„èŒƒï¼Œæ‰€ä»¥ç°è¡Œè§„èŒƒè¿˜ä¸å¤ªæ˜ç¡®ã€‚

ä¸è¿‡å¯ä»¥ç¡®å®šçš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨å¤„ç†ç”µæµæ—¶ï¼Œå¿…é¡»è¦éµå¾ªå®‰å…¨æªæ–½ï¼šä»ä»»ä½•å¼•è„šè·å–çš„æœ€å¤§ç”µæµåº”å°äºæˆ–ç­‰äº **16mA**ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»è°ƒæ•´è´Ÿè½½ä»¥æ»¡è¶³è¿™ä¸€è¦æ±‚ã€‚

å¦‚æœæˆ‘ä»¬å·²ç»å°†å¤šä¸ªè®¾å¤‡è¿æ¥åˆ°æ ‘è“æ´¾ GPIO å’Œå…¶ä»–ç«¯å£ï¼ˆå¦‚ USBï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»ç¡®ä¿ä»ç”µè·¯è·å–çš„æœ€å¤§ç”µæµå°äº **50mA**ã€‚

ä¸ºäº†é™åˆ¶ç”µæµï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç”µè·¯ä¸­å¢åŠ ç”µé˜»ï¼Œä½¿å¾—æœ€å¤§ç”µæµä¸ä¼šè¶…è¿‡è¿™äº›é™åˆ¶ã€‚å½“ä¸€ä¸ªè®¾å¤‡éœ€è¦çš„ç”µæµæ¯”æ ‘è“æ´¾çš„æœ€å¤§é™åˆ¶è¿˜è¦å¤§æ—¶ï¼Œåº”å½“ä½¿ç”¨ç»§ç”µå™¨å¼€å…³ã€‚

**è¾“å…¥**æ¨¡å¼ä½¿ç”¨çš„ä¹Ÿæ˜¯ç›¸åŒçš„è§„èŒƒã€‚å½“ GPIO å¼•è„šè¢«ç”¨ä½œ**æ¼æ**ï¼ˆ**è€Œé** æº **ç”µæµ**ï¼‰æ—¶ï¼Œæˆ‘ä»¬ä¸åº”è¯¥ä¾›åº”è¶…è¿‡ **16mA** çš„ç”µæµã€‚æ­¤å¤–ï¼Œå½“å¤šä¸ª GPIO å¼•è„šç”¨ä½œè¾“å…¥æ—¶ï¼Œæ€»å…±ä¸åº”æ–½åŠ è¶…è¿‡ **50mA** çš„ç”µæµã€‚

---

## å‰ææ¡ä»¶

æˆ‘ç›¸ä¿¡ä½ å·²ç»èµ°è¿‡ä¸€éæ ‘è“æ´¾çš„è®¾ç½®æµç¨‹ã€‚è¿™æ„å‘³ç€ä½ å·²ç»å®‰è£…äº†ä¸€ä¸ª [**Raspbian**](https://www.raspberrypi.org/downloads/raspbian/) ä¹‹ç±»çš„æˆ–æ˜¯ä½ ä¸ªäººåå¥½çš„æ“ä½œç³»ç»Ÿï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ SSH æˆ– HDMI è®¿é—®å®ƒã€‚

æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯åˆ›å»ºé¡¹ç›®ç›®å½•ã€‚æˆ‘å·²ç»åœ¨ `/home/pi/Programs/io-examples` è¿™ä¸ªè·¯å¾„ä¸‹åˆ›å»ºäº†é¡¹ç›®ç›®å½•ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„ç¨‹åºéƒ½å°†ä½œä¸ºæ•™ç¨‹ç¤ºä¾‹ä¿å­˜åœ¨è¯¥è·¯å¾„ä¸‹ã€‚

ç”±äºæˆ‘ä»¬æƒ³é€šè¿‡ Node.js æ¥æ§åˆ¶ GPIO å¼•è„šï¼Œé¦–å…ˆæˆ‘ä»¬å¿…é¡»å®‰è£… Nodeã€‚ä½ å¯ä»¥é€‰æ‹©ä½ æœ€å–œæ¬¢çš„æ–¹æ³•ï¼Œä½†æˆ‘ä¸ªäººä¼šä½¿ç”¨ **[NVM](https://github.com/nvm-sh/nvm)**ï¼ˆNode ç‰ˆæœ¬ç®¡ç†å™¨ï¼‰æ¥å®‰è£…ã€‚ä½ å¯ä»¥éµå¾ª[**è¯¥å»ºè®®æ­¥éª¤**](https://github.com/nvm-sh/nvm#install--update-script)å®‰è£… NVMã€‚

ä¸€æ—¦è£…å¥½äº† NVMï¼Œæˆ‘ä»¬å°±å¯ä»¥å®‰è£…ç‰¹å®šç‰ˆæœ¬çš„ Nodeã€‚æˆ‘å°†ä½¿ç”¨ Node v12ï¼Œå› ä¸ºå®ƒæ˜¯æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬ã€‚è¦å®‰è£… Node v12ï¼Œè¯·è¾“å…¥ä»¥ä¸‹å‘½ä»¤è¡Œï¼š

```bash
nvm install 12
nvm use 12
```

ä¸€æ—¦æ ‘è“æ´¾å®‰è£…äº† Node.jsï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­åˆ›å»ºé¡¹ç›®äº†ã€‚å› ä¸ºæˆ‘ä»¬æƒ³è¦æ§åˆ¶ GPIO å¼•è„šï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåº“æ¥ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¼–ç¨‹æ¥å£ã€‚

[**onoff**](https://www.npmjs.com/package/onoff) æ˜¯ä¸€ä¸ªçŸ¥åçš„ç”¨æ ‘è“æ´¾æ§åˆ¶ GPIO çš„åº“ã€‚é¦–å…ˆï¼Œåœ¨é¡¹ç›®ç›®å½•ä¸­åˆ›å»º package.jsonï¼Œç„¶åå®‰è£… `onoff` åŒ…ã€‚

```bash
cd /home/pi/Programs/io-examples
npm init -y
npm i -S onoff
```

ç°åœ¨ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹ç”µè·¯è®¾è®¡å¹¶ç¼–å†™ç¬¬ä¸€ä¸ªç¨‹åºæ¥æµ‹è¯• GPIO çš„èƒ½åŠ›ã€‚

---

## LED è¾“å‡ºç¤ºä¾‹

åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä»¥ç¼–ç¨‹æ–¹å¼æ‰“å¼€çº¢è‰² LEDã€‚è®©æˆ‘ä»¬å…ˆçœ‹çœ‹ä¸‹é¢çš„ç”µè·¯å›¾ï¼š

![(ç®€å• LED è¾“å‡º)](https://cdn-images-1.medium.com/max/3126/1*aarORNzRCTnQlSL-F6pe5Q.png)

ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å·²ç»å°† **6 å·å¼•è„š**ï¼ˆ**æ¥åœ°å¼•è„š**ï¼‰è¿æ¥åˆ°äº†çº¿è·¯æ¿çš„è´Ÿæï¼ˆ**åœ°çº¿**ï¼‰ä¸Šï¼Œå¹¶å°† **BCM 4** è¿æ¥åˆ°äº† **1k ohm** ç”µé˜»çš„ä¸€ç«¯ã€‚ç”µé˜»å™¨çš„å¦ä¸€ç«¯è¿æ¥åˆ°çº¢è‰² LED çš„è¾“å…¥ç«¯ä¸Šï¼ŒLED çš„è¾“å‡ºç«¯æ¥åœ°ã€‚

é™¤äº†æœ‰ä¸ªç”µé˜»ï¼Œè¿™ä¸ªç”µè·¯æ²¡ä»€ä¹ˆç‰¹åˆ«çš„ã€‚éœ€è¦è¿™ä¸ªé¢å¤–çš„ç”µé˜»æ˜¯å› ä¸ºçº¢è‰² LED åœ¨ **2.4V** ç”µå‹ä¸‹å·¥ä½œï¼Œè€Œæä¾› **3.3V** ç”µå‹çš„ GPIO ä¼šæŸå LEDã€‚æ­¤å¤–ï¼ŒLED é‡‡ç”¨çš„ **20mA** è¶…è¿‡äº†æ ‘è“æ´¾çš„å®‰å…¨é˜ˆå€¼ï¼Œå› æ­¤ï¼Œä¹Ÿéœ€è¦è¿™ä¸ªç”µé˜»æ¥é˜²æ­¢ç”µæµè¿‡å¤§ã€‚

> æˆ‘ä»¬å¯ä»¥é€‰æ‹© 330 ohms åˆ° 1k ohms çš„ç”µé˜»ã€‚è¿™ä¸ªæ•°å€¼èŒƒå›´çš„ç”µé˜»ä¼šå½±å“ç”µæµå¤§å°ï¼Œä½†éƒ½ä¸ä¼šæŸå LEDã€‚

ä»ä¸Šè¿°ç”µè·¯æ¥çœ‹ï¼Œç”µè·¯ä¸­å”¯ä¸€çš„å˜é‡æ˜¯ BCM 4 å¼•è„šè¾“å‡ºã€‚å¦‚æœå¼•è„šæ‰“å¼€ï¼ˆ**3.3V**ï¼‰ï¼Œç”µè·¯å°†é—­åˆï¼ŒLED å°†å‘å…‰ã€‚å¦‚æœå¼•è„šå…³é—­ï¼ˆ**0V**ï¼‰ï¼Œç”µè·¯æ–­å¼€ï¼ŒLED ä¸ä¼šå‘å…‰ã€‚

è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œå®ç°ä»¥ç¼–ç¨‹æ–¹å¼æ‰“å¼€ BCM 4 å¼•è„šã€‚

```JavaScript
const { Gpio } = require( 'onoff' );

// set BCM 4 pin as 'output'
const ledOut = new Gpio( '4', 'out' );

// current LED state
let isLedOn = false;

// run a infinite interval
setInterval( () => {
  ledOut.writeSync( isLedOn ? 0 : 1 ); // provide 1 or 0 
  isLedOn = !isLedOn; // toggle state
}, 3000 ); // 3s
```

åœ¨ä¸Šè¿°ç¨‹åºä¸­ï¼Œ æˆ‘ä»¬å¯¼å…¥ `onoff` åŒ…å¹¶å¼•å…¥ `Gpio` æ„é€ å‡½æ•°ã€‚ç”¨è®¾å®šå¥½çš„é…ç½®åˆ›å»º `Gpio` ç±»æ¥é…ç½®ä¸€ä¸ª GPIOã€‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°† **BCM 4** è®¾ç½®æˆäº†**è¾“å‡ºæ¨¡å¼**ã€‚

> ä½ å¯ä»¥å‚è€ƒè¯¥ `onoff` æ¨¡å—çš„ [**API æ–‡æ¡£**](https://github.com/fivdi/onoff#api)æ¥äº†è§£å„ç§é…ç½®é€‰é¡¹å’Œ APIã€‚

`Gpio` ç±»åˆ›å»ºçš„å®ä¾‹æä¾›äº†ä¸è¯¥å¼•è„šäº¤äº’çš„é«˜é˜¶ APIã€‚`writeSync` æ–¹æ³•ä¼šå°† **1** æˆ– **0** å†™å…¥å¼•è„šï¼Œä»¥å®ç°å¼€å¯æˆ–å…³é—­å¼•è„šã€‚å½“å¼•è„šè®¾ä¸º **1** æ—¶ï¼Œå¼•è„š**å¼€å¯**å¹¶è¾“å…¥ **3.3V** ç”µæºã€‚å½“å®ƒè®¾ä¸º **0** æ—¶ï¼Œå¼•è„šä¼š**å…³é—­**ä¸”ä¸å†æä¾›ä»»ä½•ç”µæºç”µå‹ï¼ˆ**0V**ï¼‰ã€‚

ä½¿ç”¨ `setInterval` æ—¶ï¼Œæˆ‘ä»¬å°±æ˜¯åœ¨è¿è¡Œä¸€ä¸ªæ— é™å¾ªç¯ï¼Œä¸æ–­åœ°è°ƒç”¨ `ledOut.writeSync(val)` æ–¹æ³•åœ¨ `ledOut` å¼•è„šä¸­å†™å…¥ 0 æˆ– 1ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ Node.js æ¥è¿è¡Œè¿™ä¸ªç¨‹åºï¼š

```bash
node rpi-led-out.js
```

ç”±äºè¿™æ˜¯ä¸€ä¸ªæ— é™å¾ªç¯çš„ç¨‹åºï¼Œä¸€æ—¦å¯åŠ¨ï¼Œå®ƒå°±ä¸ä¼šç»ˆæ­¢ï¼Œé™¤éæˆ‘ä»¬ä½¿ç”¨ `ctrl + c` å¼ºåˆ¶ç»ˆæ­¢ç¨‹åºã€‚åœ¨è¯¥ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œå®ƒå°†æ¯éš” **3 ç§’**åˆ‡æ¢ä¸€æ¬¡ **BCM 4** å¼•è„šçš„çŠ¶æ€ã€‚

æ ‘è“æ´¾ GPIO æœ‰æ„æ€çš„ä¸€ç‚¹æ˜¯ï¼Œä¸€æ—¦ GPIO å¼•è„šè¢«è®¾ä¸º **1** æˆ– **0**ï¼Œå®ƒå°†ä¸€ç›´ä¿æŒä¸å˜ï¼Œ é™¤éæˆ‘ä»¬è¦†ç›–è¯¥å€¼æˆ–å…³é—­æ ‘è“æ´¾çš„ç”µæºã€‚æ¯”å¦‚ï¼Œå½“ä½ å¯åŠ¨ç¨‹åºæ—¶ï¼ŒLED å¤„äºç†„ç­çŠ¶æ€ï¼Œä½†å½“ä½ ç»ˆæ­¢ç¨‹åºæ—¶ï¼ŒLED å¯èƒ½ä¼šä¿æŒäº®èµ·çŠ¶æ€ã€‚

## å¼€å…³è¾“å…¥ç¤ºä¾‹

ä¼—æ‰€å‘¨çŸ¥ï¼Œå½“æŠŠ GPIO ç”¨ä½œè¾“å…¥æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æä¾›æ¥è¿‘ **3.3V** çš„ç”µå‹ã€‚æˆ‘ä»¬å¯ä»¥è¿æ¥ä¸€ä¸ªå¼€å…³ï¼ˆ**æŒ‰é’®**ï¼‰ç›´æ¥ä» **3.3V** å¼•è„šæä¾›ç”µå‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![(ç®€å•æŒ‰é’®è¾“å…¥)](https://cdn-images-1.medium.com/max/3126/1*8TUu5IGDaYm0movHCM9hww.png)

åœ¨è¾“å…¥å¼€å…³ä¹‹å‰ï¼Œæˆ‘ä»¬å·²ç»åœ¨ç”µè·¯ä¸­ä½¿ç”¨äº†ä¸€ä¸ª **1K ohm** çš„ç”µé˜»ã€‚å®ƒèƒ½é˜²æ­¢ **3.3V** ç”µæºäº§ç”Ÿè¿‡å¤§çš„ç”µæµï¼Œé¿å…å¼€å…³ç†”æ–­ã€‚

æˆ‘ä»¬è¿˜è¿æ¥äº†ä¸€ä¸ª **10K ohm** ç”µé˜»ï¼Œè¯¥ç”µé˜»ä¹Ÿä»æŒ‰é’®çš„è¾“å‡ºç«¯æ±²å–ç”µæµå¹¶æ¥åœ°ã€‚è¿™ç±»ç”µé˜»è¢«ç§°ä¸º**ä¸‹æ‹‰**ç”µé˜»ï¼ˆ**å› ä¸ºå®ƒä»¬åœ¨ç”µè·¯ä¸­çš„ä½ç½®**ï¼‰ï¼Œå®ƒä»¬ä¼šå°†ç”µæµï¼ˆ**æˆ–å¤§æ°”ä¸­ç”µè·èšé›†äº§ç”Ÿçš„ç”µæµ**ï¼‰å¯¼å‘åœ°é¢ã€‚

> æˆ‘ä»¬ä¹Ÿå¯ä»¥å¢åŠ ä¸€ä¸ª**ä¸Šæ‹‰ç”µé˜»**ï¼Œä» **3.3V** å¼•è„šå¯¼å‡ºç”µæµï¼Œä¾›ç»™ç»™ GPIO çš„è¾“å…¥å¼•è„šã€‚åœ¨è¿™ç§é…ç½®ä¸‹ï¼Œè¾“å…¥å¼•è„šä¼šå§‹ç»ˆè¯»å– **é«˜** æˆ– **1**ã€‚æŒ‰ä¸‹æŒ‰é’®æ—¶ï¼Œå¼€å…³åœ¨ç”µé˜»å’Œåœ°é¢ä¹‹é—´äº§ç”ŸçŸ­è·¯ï¼Œå°†æ‰€æœ‰ç”µæµå¯¼å‘åœ°é¢ï¼Œå¹¶ä¸”æ²¡æœ‰ç”µæµé€šè¿‡å¼€å…³åˆ°è¾¾è¾“å…¥å¼•è„šï¼Œè¯»æ•°ä¸º **0**ã€‚[**æ­¤å¤„æœ‰ä¸€æ®µå¾ˆæ£’çš„è§†é¢‘**](https://www.youtube.com/watch?v=5vnW4U5Vj0k)æ¼”ç¤ºäº†ä¸Šæ‹‰å’Œä¸‹æ‹‰ç”µé˜»ã€‚

å¼€å…³çš„è¾“å‡ºè¿æ¥åˆ° **BCM 17** å¼•è„šã€‚å½“æŒ‰ä¸‹æŒ‰é’®ï¼ˆ**å¼€å…³**ï¼‰æ—¶ï¼Œç”µæµå°†é€šè¿‡å¼€å…³æµå…¥ BCM 17 å¼•è„šã€‚ç„¶è€Œï¼Œç”±äº 10K ohm ç”µé˜»ç»™ç”µæµæä¾›äº†æ›´å¤§çš„éšœç¢ï¼Œå¤§å¤šæ•°ç”µæµä¼šæµå‘ç”±**çº¢è‰²è™šçº¿**è¡¨ç¤ºçš„å›è·¯ã€‚

æœªæŒ‰ä¸‹æŒ‰é’®æ—¶ï¼Œç”±çº¢è‰²è™šçº¿è¡¨ç¤ºçš„å›è·¯é—­åˆï¼Œæ²¡æœ‰ç”µæµæµè¿‡ã€‚ç„¶è€Œï¼Œç”±**ç°è‰²è™šçº¿**è¡¨ç¤ºçš„ç¯è·¯æ˜¯é—­åˆçš„ï¼ŒBCM 17 å¼•è„šæ¥åœ°ï¼ˆ**0V**ï¼‰ã€‚

> å¢åŠ ä¸€ä¸ª 10k ohm ç”µé˜»æ˜¯ä¸ºäº†è®© BCM 17 å¼•è„šæ¥åœ°ï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šå°†ä»»ä½•å¤§æ°”å¹²æ‰°è¯»å–ä¸ºé«˜è¾“å…¥ã€‚å¦‚æœä¸å°†è¾“å…¥å¼•è„šæ¥åœ°ï¼Œè¾“å…¥å¼•è„šä¼šä¿æŒåœ¨**æµ®åŠ¨çŠ¶æ€**ã€‚åœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼Œç”±äºå¤§æ°”å¹²æ‰°ï¼Œè¾“å…¥å¼•è„šå¯èƒ½è¯»å–ä¸º 0 æˆ– 1ã€‚

æ—¢ç„¶ç”µè·¯å·²ç»å‡†å¤‡å¥½äº†ï¼Œè®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç¨‹åºæ¥è¯»å–è¾“å…¥å€¼ï¼š

```JavaScript
const { Gpio } = require( 'onoff' );

// set BCM 17 pin as 'input'
const switchIn = new Gpio( '17', 'in', 'both' );

// listen for pin voltage change
switchIn.watch( ( err, value ) => {
  if( err ) {
    console.log( 'Error', err );
  }

  // log pin value (0 or 1)
  console.log( 'Pin value', value );
} );
```

åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å°† **BCM 17** å¼•è„šè®¾ç½®ä¸ºè¾“å…¥æ¨¡å¼ã€‚`Gpio` æ„é€ å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°é…ç½®äº†æˆ‘ä»¬ä½•æ—¶éœ€è¦å¼•è„šè¾“å…¥ç”µå‹å˜åŒ–çš„é€šçŸ¥ã€‚è¯¥å‚æ•°åä¸º **`edge`**ï¼Œå› ä¸ºæˆ‘ä»¬è¯»å–çš„æ˜¯ç”µå‹ä¸Šå‡å’Œä¸‹é™å‘¨æœŸçš„è¾¹ç¼˜ç”µå‹å€¼ã€‚

`edge` å‚æ•°å¯ä»¥æœ‰ä»¥ä¸‹å€¼ï¼š

å½“ä½¿ç”¨ `rising` å€¼æ—¶ï¼Œå¦‚æœ GPIO å¼•è„šçš„è¾“å…¥ç”µå‹**ä» 0V ä¸Šå‡**ï¼ˆ**è‡³ 3.3V**ï¼‰ï¼Œæˆ‘ä»¬å°†æ”¶åˆ°é€šçŸ¥ã€‚ä½äºæ­¤ä½ç½®æ—¶ï¼Œå¼•è„šå°†è¯»å–**é€»è¾‘é«˜ä½**æˆ– **1**ï¼Œå› ä¸ºè¯¥å¼•è„šè·å¾—äº†æ›´é«˜çš„ç”µå‹ã€‚

å½“ä½¿ç”¨ `falling` å€¼æ—¶ï¼Œå¦‚æœè¾“å…¥ç”µå‹ï¼ˆ**ä» 3.3V**ï¼‰ **é™è‡³ 0V**ï¼Œæˆ‘ä»¬å°†æ”¶åˆ°é€šçŸ¥ã€‚ä½äºæ­¤ä½ç½®æ—¶ï¼Œå¼•è„šå°†è¯»å–**é€»è¾‘ä½ä½**æˆ– **0**ï¼Œå› ä¸ºå®ƒæ­£åœ¨å¤±å»ç”µå‹ã€‚

å½“ä½¿ç”¨ `both` å€¼æ—¶ï¼Œæˆ‘ä»¬å°†æ”¶åˆ°ä¸Šè¿°ä¸¤ä¸ªäº‹ä»¶çš„é€šçŸ¥ã€‚å½“ç”µå‹ä» 0V ä¸Šå‡ï¼ˆ**è‡³è¾“å…¥é«˜ç”µå¹³æˆ– 1**ï¼‰æˆ–ä» 3.3V ä¸‹é™ï¼ˆ**è‡³è¾“å…¥ä½ç”µå¹³æˆ– 0**ï¼‰æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šæ”¶åˆ°åˆ°è¿™äº›äº‹ä»¶çš„é€šçŸ¥ã€‚

> æ­¤å¤„ä¸è®¨è®º `none` å€¼ï¼Œè¯·é˜…è¯»[**æ–‡æ¡£**](https://github.com/fivdi/onoff#gpiogpio-direction--edge--options)äº†è§£æ›´å¤šä¿¡æ¯ã€‚

è¾“å…¥æ¨¡å¼ä¸‹ GPIO å¼•è„šä¸Šçš„ `watch` æ–¹æ³•ç›‘è§†ä¸Šè¿°äº‹ä»¶ã€‚è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¼ é€’ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶è¾“å…¥é«˜ï¼ˆ1ï¼‰æˆ–è¾“å…¥ä½ï¼ˆ0ï¼‰å€¼ã€‚

ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ `both` å€¼ï¼Œæ‰€ä»¥ `watch` æ–¹æ³•å°†åœ¨è¾“å…¥ç”µå‹ä¸Šå‡æ—¶ä»¥åŠè¾“å…¥ç”µå‹ä¸‹é™æ—¶éƒ½æ‰§è¡Œå›è°ƒã€‚æŒ‰ä¸‹æŒ‰é’®ï¼Œä½ åº”è¯¥ä¼šåœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°ä¸‹é¢çš„å€¼ï¼š

```
Pin value 1 (æŒ‰ä¸‹æŒ‰é’®)
Pin value 0 (é‡Šæ”¾æŒ‰é’®)
Pin value 1 (æŒ‰ä¸‹æŒ‰é’®)
Pin value 1 (é‡å¤å€¼)
Pin value 0 (æŒ‰ä¸‹æŒ‰é’®)
```

å¦‚æœä»”ç»†æ£€æŸ¥ä»¥ä¸Šè¾“å‡ºå°±èƒ½å‘ç°ï¼Œæˆ‘ä»¬æœ‰æ—¶ä¼šåœ¨æŒ‰ä¸‹æˆ–é‡Šæ”¾æŒ‰é’®æ—¶å¾—åˆ°é‡å¤çš„å€¼ã€‚ç”±äºå¼€å…³æœºåˆ¶çš„ä¸¤ä¸ªè¿æ¥å™¨ä¹‹é—´çš„ç‰©ç†è¿æ¥å¹¶ä¸æ€»é‚£ä¹ˆé¡ºç•…ï¼Œæ‰€ä»¥ï¼Œä¸å°å¿ƒæŒ‰ä¸‹å¼€å…³æ—¶ï¼Œå®ƒå¯ä»¥å¤šæ¬¡è¿æ¥å’Œæ–­å¼€ã€‚

ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¼€å…³ç”µè·¯ä¸­å¢åŠ ç”µå®¹ï¼Œåœ¨å®é™…ç”µæµæµå…¥ GPIO å¼•è„šä¹‹å‰å……ç”µï¼Œå¹¶åœ¨æŒ‰é’®é‡Šæ”¾æ—¶å¹³ç¨³æ”¾ç”µã€‚è¿™ç§æ–¹æ³•éå¸¸ç®€å•ï¼Œä½ å¯ä»¥è¯•ä¸€è¯•ã€‚

## ç»„åˆ I/O ç¤ºä¾‹

ç°åœ¨æˆ‘ä»¬å·²ç»å……åˆ†ç†è§£äº† GPIO å¼•è„šçš„å·¥ä½œåŸç†ä»¥åŠé…ç½®æ–¹æ³•ï¼Œè®©æˆ‘ä»¬ç»“åˆæœ€åä¸¤ä¸ªä¾‹å­è¿›è¡Œè®²è§£ã€‚æ›´é‡è¦çš„æ˜¯ï¼ŒæŒ‰ä¸‹æŒ‰é’®æ—¶ï¼Œæ‰“å¼€ LED è€Œé‡Šæ”¾æŒ‰é’®æ—¶å…³é—­ LEDã€‚è®©æˆ‘ä»¬å…ˆçœ‹çœ‹ç”µè·¯å›¾ï¼š

![(ç®€å• I/O ç¤ºä¾‹)](https://cdn-images-1.medium.com/max/3126/1*c0iV6t3t2yPUVyT0mhU3OA.png)

ä»ä»¥ä¸Šä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬æ²¡æœ‰ä»ä¸Šé¢çš„ä¸¤ä¸ªä¾‹å­ä¸­æ”¹å˜ä»»ä½•ä¸œè¥¿ã€‚å¦å¤–ï¼ŒLED å’Œå¼€å…³ç”µè·¯éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¹‹å‰çš„ç¨‹åºåœ¨è¿™æ¡çº¿è·¯ä¸Šåº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œã€‚

```JavaScript
const { Gpio } = require( 'onoff' );

// set BCM 4 pin as 'output'
const ledOut = new Gpio( '4', 'out' );

// set BCM 17 pin as 'input'
const switchIn = new Gpio( '17', 'in', 'both' );

// listen for pin voltage change
switchIn.watch( ( err, value ) => {
  if( err ) {
    console.log( 'Error', err );
  }

  // write the input value (0 or 1) 'ledOut' pin
  ledOut.writeSync( value );
} );
```

åœ¨ä¸Šè¿°ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å°† GPIO å¼•è„šåˆ†åˆ«é…ç½®ä¸ºè¾“å…¥å’Œè¾“å‡ºæ¨¡å¼ã€‚ç”±äºè¾“å…¥å¼•è„šä¸Šçš„ `watch` æ–¹æ³•æä¾›çš„å€¼æ˜¯ **0** æˆ– **1**ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠè¿™äº›å€¼å†™å…¥è¾“å‡ºå¼•è„šã€‚

å› ä¸ºæˆ‘ä»¬åœ¨ `both` æ¨¡å¼ä¸‹ç”¨ `watch` æ–¹æ³•ç›‘è§†è¾“å…¥å¼•è„šï¼Œå½“æŒ‰ä¸‹æŒ‰é’®å‘é€ **1** æˆ–è€…é‡Šæ”¾æŒ‰é’®å‘é€ **0** æ—¶ï¼Œ`watch` æ–¹æ³•çš„å›è°ƒå°†è¢«è§¦å‘ã€‚

æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å€¼å†™å…¥ `ledOut` å¼•è„šã€‚å› æ­¤ï¼ŒæŒ‰ä¸‹æŒ‰é’®æ—¶ï¼Œ`value` ä¸º `1` å¹¶æ‰§è¡Œ `ledOut.writeSync(1)`ï¼Œä¼šæ‰“å¼€ LEDã€‚æ¾å¼€æŒ‰é’®æ—¶åˆ™åä¹‹ã€‚

---

![(æ¼”ç¤º)](https://cdn-images-1.medium.com/max/2000/1*a35VFbnt_AUM0ch8ftCxMA.gif)

ä»¥ä¸Šæ˜¯æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„å®Œæ•´è¾“å…¥/è¾“å‡ºç”µè·¯çš„æ¼”ç¤ºã€‚ä¸ºäº†ä½ æœ¬äººå’Œæ ‘è“æ´¾çš„å®‰å…¨ï¼Œå»ºè®®ä¹°ä¸€ä¸ªå¥½çš„å¤–å£³å’Œ 40 é’ˆ GPIO æ‰©å±•å¸¦çŠ¶ç”µç¼†ã€‚

å¸Œæœ›ä½ ä»Šå¤©èƒ½å­¦åˆ°ä¸€ç‚¹ä¸œè¥¿ã€‚åœ¨æ¥ä¸‹æ¥çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€äº›å¤æ‚çš„ç”µè·¯å¹¶å­¦ä¹ è¿æ¥ä¸€äº›æœ‰æ„æ€çš„è®¾å¤‡ï¼Œå¦‚å­—ç¬¦ LCD æ˜¾ç¤ºå±å’Œæ•°å­—è¾“å…¥æ¿ã€‚

> å¦‚æœå‘ç°è¯‘æ–‡å­˜åœ¨é”™è¯¯æˆ–å…¶ä»–éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Œæ¬¢è¿åˆ° [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner) å¯¹è¯‘æ–‡è¿›è¡Œä¿®æ”¹å¹¶ PRï¼Œä¹Ÿå¯è·å¾—ç›¸åº”å¥–åŠ±ç§¯åˆ†ã€‚æ–‡ç« å¼€å¤´çš„ **æœ¬æ–‡æ°¸ä¹…é“¾æ¥** å³ä¸ºæœ¬æ–‡åœ¨ GitHub ä¸Šçš„ MarkDown é“¾æ¥ã€‚

---

> [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner) æ˜¯ä¸€ä¸ªç¿»è¯‘ä¼˜è´¨äº’è”ç½‘æŠ€æœ¯æ–‡ç« çš„ç¤¾åŒºï¼Œæ–‡ç« æ¥æºä¸º [æ˜é‡‘](https://juejin.im) ä¸Šçš„è‹±æ–‡åˆ†äº«æ–‡ç« ã€‚å†…å®¹è¦†ç›– [Android](https://github.com/xitu/gold-miner#android)ã€[iOS](https://github.com/xitu/gold-miner#ios)ã€[å‰ç«¯](https://github.com/xitu/gold-miner#å‰ç«¯)ã€[åç«¯](https://github.com/xitu/gold-miner#åç«¯)ã€[åŒºå—é“¾](https://github.com/xitu/gold-miner#åŒºå—é“¾)ã€[äº§å“](https://github.com/xitu/gold-miner#äº§å“)ã€[è®¾è®¡](https://github.com/xitu/gold-miner#è®¾è®¡)ã€[äººå·¥æ™ºèƒ½](https://github.com/xitu/gold-miner#äººå·¥æ™ºèƒ½)ç­‰é¢†åŸŸï¼Œæƒ³è¦æŸ¥çœ‹æ›´å¤šä¼˜è´¨è¯‘æ–‡è¯·æŒç»­å…³æ³¨ [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)ã€[å®˜æ–¹å¾®åš](http://weibo.com/juejinfanyi)ã€[çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/juejinfanyi)ã€‚
