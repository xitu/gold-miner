> * ÂéüÊñáÂú∞ÂùÄÔºö[Running UITests with Facebook login in iOS](https://hackernoon.com/running-uitests-with-facebook-login-in-ios-4ac998940c42)
> * ÂéüÊñá‰ΩúËÄÖÔºö[Khoa Pham](https://hackernoon.com/@onmyway133?source=post_header_lockup)
> * ËØëÊñáÂá∫Ëá™Ôºö[ÊéòÈáëÁøªËØëËÆ°Âàí](https://github.com/xitu/gold-miner)
> * Êú¨ÊñáÊ∞∏‰πÖÈìæÊé•Ôºö[https://github.com/xitu/gold-miner/blob/master/TODO1/running-uitests-with-facebook-login-in-ios.md](https://github.com/xitu/gold-miner/blob/master/TODO1/running-uitests-with-facebook-login-in-ios.md)
> * ËØëËÄÖÔºö [LoneyIsError](https://github.com/LoneyIsError)
> * Ê†°ÂØπËÄÖÔºö[Alan](https://github.com/Wangalan30)

# Âú® iOS ‰∏≠‰ΩøÁî® UITests ÊµãËØï Facebook ÁôªÂΩïÂäüËÉΩ

![](https://cdn-images-1.medium.com/max/800/0*Opf2sAlTPclE_4kE.jpg)

ÂõæÁâáÊù•Ê∫êÔºöË∞∑Ê≠å

‰ªäÂ§©ÊàëÊ≠£ËØïÂõæÂú®ÊàëÁöÑÂ∫îÁî®Á®ãÂ∫è‰∏äËøêË°å‰∏Ä‰∫õ UITestÔºåÂÆÉÈõÜÊàê‰∫Ü Facebook ÁôªÂΩïÂäüËÉΩ„ÄÇ‰ª•‰∏ãÊòØÊàëÁöÑ‰∏Ä‰∫õÁ¨îËÆ∞„ÄÇ

![](https://cdn-images-1.medium.com/max/600/0*e0lQASZpw5qGT7jn.gif)

### ÊåëÊàò

*   ÂØπÊàë‰ª¨Êù•ËØ¥Ôºå‰ΩøÁî® Facebook ÁöÑÊåëÊàò‰∏ªË¶ÅÂú®‰∫éÔºåÂÆÉ‰ΩøÁî®‰∫Ü `Safari controller`ÔºåËÄåÊàë‰ª¨‰∏ªË¶ÅÂ§ÑÁêÜ `web view`„ÄÇ‰ªé iOS 9+ ÂºÄÂßãÔºåFacebook ÂÜ≥ÂÆö‰ΩøÁî® `safari` Âèñ‰ª£ `native facebook app` ‰ª•Ê≠§Êù•ÈÅøÂÖçÂ∫îÁî®Èó¥ÁöÑÂàáÊç¢„ÄÇ‰Ω†ÂèØ‰ª•Âú®ËøôÈáåÈòÖËØªËØ¶ÁªÜ‰ø°ÊÅØ [Âú® iOS 9 ‰∏ä‰∏∫‰∫∫‰ª¨ÊûÑÂª∫ÊúÄ‰Ω≥ÁöÑ Facebook ÁôªÂΩï‰ΩìÈ™å](https://developers.facebook.com/blog/post/2015/10/29/Facebook-Login-iOS9/)„ÄÇ
*   ÂÆÉÂπ∂Ê≤°ÊúâÊàë‰ª¨ÊÉ≥Ë¶ÅÁöÑ `accessibilityIdentifier` ÊàñËÄÖ `accessibilityLabel`„ÄÇ
*   webview ÂÜÖÂÆπÂ∞ÜÊù•ÂèØËÉΩ‰ºöÂèëÁîüÂèòÂåñ üò∏

### ÂàõÂª∫‰∏Ä‰∏™ Facebook ÊµãËØïÁî®Êà∑

Âπ∏ËøêÁöÑÊòØÔºåÊÇ®‰∏çÂøÖÂàõÂª∫Ëá™Â∑±ÁöÑ Facebook Áî®Êà∑Áî®‰∫éÊµãËØï„ÄÇFacebook ÊîØÊåÅÂàõÂª∫ÊµãËØïÁî®Êà∑ÔºåÂèØ‰ª•ÁÆ°ÁêÜÊùÉÈôêÂíåÂ•ΩÂèãÔºåÈùûÂ∏∏Êñπ‰æø„ÄÇ

![](https://cdn-images-1.medium.com/max/800/0*kVdiqx7CB7b43dRw.png)

ÂΩìÊàë‰ª¨ÂàõÂª∫ÊµãËØïÁî®Êà∑Êó∂ÔºåÊÇ®ËøòÂèØ‰ª•ÈÄâÊã©‰∏çÂêåËØ≠Ë®Ä„ÄÇËøôÂ∞ÜÊòØ Safari Web ËßÜÂõæ‰∏≠ÊòæÁ§∫ÁöÑËØ≠Ë®Ä„ÄÇÊàëÁé∞Âú®ÈÄâÊã©ÁöÑÊòØ `Norwegian` üá≥üá¥„ÄÇ

![](https://cdn-images-1.medium.com/max/800/0*H7V1GZN413eb1y4n.png)

### ÂçïÂáªÁôªÂΩïÊåâÈíÆÂπ∂ÊòæÁ§∫ Facebook ÁôªÂΩï

ËøôÈáåÊàë‰ª¨‰ΩøÁî®ÈªòËÆ§ÁöÑ `FBSDKLoginButton`„ÄÇ

```
var showFacebookLoginFormButton: XCUIElement {
  return buttons["Continue with Facebook"]
}
```

ÁÑ∂ÂêéÁÇπÂáªÂÆÉ

```
app.showFacebookLoginFormButton.tap()
```

### Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ

ÂΩìÂú® Safari ËÆøÈóÆ Facebook Ë°®ÂçïÊó∂ÔºåÁî®Êà∑‰πüËÆ∏Â∑≤ÁªèÁôªÂΩïËøáÔºå‰πüËÆ∏Ê≤°Êúâ„ÄÇÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂ§ÑÁêÜËøô‰∏§ÁßçÊÉÖÂÜµ„ÄÇÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂ§ÑÁêÜËøô‰∏§‰∏™Âú∫ÊôØ„ÄÇÂΩìÁî®Êà∑Â∑≤ÁªèÁôªÂΩïÊó∂ÔºåFacebook ‰ºöËøîÂõû`‰Ω†Â∑≤ÁªèÁôªÂΩï`Êàñ `OK` ÊåâÈíÆ„ÄÇ

ËøôÈáåÁöÑÂª∫ËÆÆÊòØÊ∑ªÂä†Êñ≠ÁÇπÔºåÁÑ∂Âêé‰ΩøÁî® `lldb` ÂëΩ‰ª§ `po app.staticTexts` Âíå `po app.buttons`ÔºåÊü•ÁúãÂΩìÂâçÊñ≠ÁÇπ‰∏ãÁöÑ UI ÂÖÉÁ¥†„ÄÇ

ÊÇ®ÂèØ‰ª•Ê£ÄÊü•ÈùôÊÄÅÊñáÊú¨ÔºåÊàñÂè™ÊòØÁÇπÂáª `OK` ÊåâÈíÆ„ÄÇ

```
var isAlreadyLoggedInSafari: Bool {
  return buttons["OK"].exists || staticTexts["Du har allerede godkjent Blue Sea."].exists
}
```

### Á≠âÂæÖÂπ∂Âà∑Êñ∞

Âõ†‰∏∫ Facebook Ë°®ÂçïÊòØ‰∏Ä‰∏™ webviewÔºåÊâÄ‰ª•ÂÆÉÁöÑÂÜÖÂÆπÊòØÊúâÁÇπÂä®ÊÄÅÁöÑ„ÄÇÂπ∂‰∏î UITest ‰ºº‰πé‰ºöÁºìÂ≠òÂÜÖÂÆπ‰ª•‰æøÂø´ÈÄüÊü•ËØ¢ÔºåÂõ†Ê≠§Âú®Ê£ÄÊü• `staticTexts` ‰πãÂâçÔºåÊàë‰ª¨ÈúÄË¶Å `wait` Âíå `refresh the cache`„ÄÇ

```
app.clearCachedStaticTexts()
```

ËøôÈáåÂÆûÁé∞‰∫Ü `wait` ÂäüËÉΩ„ÄÇ

```
extension XCTestCase {
  func wait(for duration: TimeInterval) {
    let waitExpectation = expectation(description: "Waiting")

    let when = DispatchTime.now() + duration
    DispatchQueue.main.asyncAfter(deadline: when) {
      waitExpectation.fulfill()
    }

    // We use a buffer here to avoid flakiness with Timer on CI
    waitForExpectations(timeout: duration + 0.5)
  }
}
```

### Á≠âÂæÖÂÖÉÁ¥†Âá∫Áé∞

‰ΩÜÊõ¥‰øùÈô©ÁöÑÊñπÊ≥ïÊòØÁ≠âÂæÖÂÖÉÁ¥†Âá∫Áé∞„ÄÇÂØπ‰∫é Facebook ÁôªÂΩïË°®ÂçïÊù•ËØ¥Ôºå‰ªñ‰ª¨‰ºöÂú®Âä†ËΩΩÂêéÊòæÁ§∫ `Facebook` ÁöÑÊ†áÁ≠æ„ÄÇÊâÄ‰ª•Êàë‰ª¨Â∫îËØ•Á≠âÂæÖËøô‰∏™ÂÖÉÁ¥†Âá∫Áé∞„ÄÇ

```
extension XCTestCase {
  /// Wait for element to appear
  func wait(for element: XCUIElement, timeout duration: TimeInterval) {
    let predicate = NSPredicate(format: "exists == true")
    let _ = expectation(for: predicate, evaluatedWith: element, handler: nil)

    // Here we don't need to call `waitExpectation.fulfill()`

    // We use a buffer here to avoid flakiness with Timer on CI
    waitForExpectations(timeout: duration + 0.5)
  }
}
```

Âú®ÂØπ Facebook ÁôªÂΩïË°®Âçï‰∏≠ÁöÑÂÖÉÁ¥†ËøõË°å‰ªª‰ΩïËøõ‰∏ÄÊ≠•Ê£ÄÊü•‰πãÂâçÔºåËØ∑Ë∞ÉÁî®Ê≠§ÊñπÊ≥ï„ÄÇ

```
wait(for: app.staticTexts["Facebook"], timeout: 5)
```

### Â¶ÇÊûúÁî®Êà∑Â∑≤ÁôªÂΩï

ÁôªÂΩïÂêéÔºåÊàëÁöÑÂ∫îÁî®Á®ãÂ∫è‰ºöÂú®‰∏ªÊéßÂà∂Âô®‰∏≠ÊòæÁ§∫‰∏Ä‰∏™Âú∞ÂõæÈ°µÈù¢„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÈúÄË¶ÅÁÆÄÂçïÁöÑÊµãËØï‰∏Ä‰∏ãÔºåÊ£ÄÊü•ËØ•Âú∞ÂõæÊòØÂê¶Â≠òÂú®„ÄÇ

```
if app.isAlreadyLoggedInSafari {
  app.okButton.tap()

  handleLocationPermission()
  // Check for the map
  XCTAssertTrue(app.maps.element(boundBy: 0).exists)
}
```

### Â§ÑÁêÜ‰∏≠Êñ≠

Êàë‰ª¨Áü•ÈÅìÔºåÂΩìË¶ÅÊòæÁ§∫‰ΩçÁΩÆÂú∞ÂõæÊó∂Ôºå`Core Location` ‰ºöÂèëÈÄÅËØ∑Ê±ÇËÆ∏ÂèØ„ÄÇÊâÄ‰ª•Êàë‰ª¨‰πüÈúÄË¶ÅÂ§ÑÁêÜËøôÁßç‰∏≠Êñ≠„ÄÇ‰Ω†ÈúÄË¶ÅÁ°Æ‰øùÂú®ÂºπÊ°ÜÂºπÂá∫‰πãÂâçÂ∞ΩÊó©Ë∞ÉÁî®ÂÆÉ„ÄÇ

```
fileprivate func handleLocationPermission() {
  addUIInterruptionMonitor(withDescription: "Location permission", handler: { alert in
    alert.buttons.element(boundBy: 1).tap()
    return true
  })
}
```

ËøòÊúâ‰∏Ä‰∏™ÈóÆÈ¢òÔºåËøô‰∏™`ÁõëËßÜÂô®`‰∏ç‰ºöË¢´Ë∞ÉÁî®„ÄÇÊâÄ‰ª•Ëß£ÂÜ≥ÊñπÊ≥ïÊòØÂú®ÂºπÊ°ÜÂºπËµ∑Êó∂ÂÜçÊ¨°Ë∞ÉÁî® `app.tap()`„ÄÇ ÂØπÊàëÊù•ËØ¥ÔºåÊàë‰ºöÂú®ÊàëÁöÑ ‚ÄòÂú∞Âõæ‚Äô ÊòæÁ§∫1Âà∞2ÁßíÂêéË∞ÉÁî® `app.tap()`ÔºåËøôÊòØ‰∏∫‰∫ÜÁ°Æ‰øùÂú®ÊòæÁ§∫ÂºπÊ°Ü‰πãÂêéÂÜçË∞ÉÁî® `app.tap()`„ÄÇ

Êõ¥ËØ¶ÁªÜÁöÑÊåáÂçóÔºåËØ∑ÈòÖËØª [#48](https://github.com/onmyway133/blog/issues/48)

### Â¶ÇÊûúÁî®Êà∑Êú™ÁôªÂΩï

Âú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÈúÄË¶ÅÂ°´ÂÜôÈÇÆÁÆ±Ë¥¶Êà∑ÂíåÂØÜÁ†Å„ÄÇ ÊÇ®ÂèØ‰ª•Êü•Áúã‰∏ãÈù¢ÁöÑ`ÂÆåÊï¥Ê∫ê‰ª£Á†Å`ÈÉ®ÂàÜ„ÄÇÂΩìÂ¶ÇÊûúÊñπÊ≥ï‰∏çËµ∑‰ΩúÁî®ÊàñËÄÖ `po` ÂëΩ‰ª§Âπ∂Ê≤°ÊúâÊâìÂç∞Âá∫‰Ω†ÈúÄË¶ÅÁöÑÂÖÉÁ¥†Êó∂ÔºåËøôÂèØËÉΩÊòØÂõ†‰∏∫ÁºìÂ≠òÊàñËÄÖ‰Ω†ÈúÄË¶ÅÁ≠âÂà∞Âä®ÊÄÅÂÜÖÂÆπÊ∏≤ÊüìÂÆåÊàêÂêéÂú®ÂÜçÂ∞ùËØï„ÄÇ

ÊÇ®ÈúÄË¶ÅÁ≠âÂæÖÂÖÉÁ¥†Âá∫Áé∞„ÄÇ

### ÁÇπÂáªÊñáÊú¨ËæìÂÖ•Ê°Ü

Â¶ÇÊûúÈÅáÂà∞ËøôÁßçÊÉÖÂÜµ `Neither element nor any descendant has keyboard focus`ÔºåËøôÊòØËß£ÂÜ≥ÊñπÊ≥ï„ÄÇ

*   Â¶ÇÊûú‰Ω†Âú®Ê®°ÊãüÂô®‰∏äÊµãËØï, ËØ∑Á°Æ‰øùÊ≤°ÊúâÈÄâ‰∏≠ `Simulator -> Hardware -> Keyboard -> Connect Hardware Keyboard`„ÄÇ
*   ÁÇπÂáªÂêéÁ®çÂæÆ `Á®çÁ≠â` ‰∏Ä‰∏ã„ÄÇ

```
app.emailTextField.tap()
```

### Ê∏ÖÈô§ÊâÄÊúâÊñáÂ≠ó

Ê≠§‰∏æÊòØ‰∏∫‰∫ÜÂ∞ÜÂÖâÊ†áÁßªÂä®Âà∞ÊñáÊú¨Ê°ÜÊú´Â∞æÔºåÁÑ∂Âêé‰æùÊ¨°Âà†Èô§ÊØè‰∏Ä‰∏™Â≠óÁ¨¶ÔºåÂπ∂ÈîÆÂÖ•Êñ∞ÁöÑÊñáÊú¨„ÄÇ

```
extension XCUIElement {
  func deleteAllText() {
    guard let string = value as? String else {
      return
    }

    let lowerRightCorner = coordinate(withNormalizedOffset: CGVector(dx: 0.9, dy: 0.9))
    lowerRightCorner.tap()

    let deletes = string.characters.map({ _ in XCUIKeyboardKeyDelete }).joined(separator: "")
    typeText(deletes)
  }
}
```

### ‰øÆÊîπËØ≠Ë®ÄÁéØÂ¢É

ÂØπÊàëÊù•ËØ¥ÔºåÊàëÊÉ≥Áî®Êå™Â®ÅËØ≠ËøõË°åÊµãËØïÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÊâæÂà∞ `Norwegian` ÈÄâÈ°πÂπ∂ÁÇπÂáªÂÆÉ„ÄÇÂÆÉË¢´ `UI Test` ËØÜÂà´‰∏∫`ÈùôÊÄÅÊñáÊú¨`„ÄÇ

```
var norwegianText: XCUIElement {
  return staticTexts["Norsk (bokm√•l)"]
}

wait(for: app.norwegianText, timeout: 1)
app.norwegianText.tap()
```

### ÈÇÆÁÆ±Ë¥¶Êà∑ËæìÂÖ•Ê°Ü

Âπ∏ËøêÁöÑÊòØÔºåÈÇÆÁÆ±Ë¥¶Êà∑ËæìÂÖ•Ê°ÜÂèØ‰ª•Ë¢´ `UI Test` Ê£ÄÊµã‰∏∫ `text field` ÂÖÉÁ¥†ÔºåÂõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•Êü•ËØ¢ÂÆÉ„ÄÇËøôÈáå‰ΩøÁî®Ë∞ìËØç„ÄÇ

```
var emailTextField: XCUIElement {
  let predicate = NSPredicate(format: "placeholderValue == %@", "E-post eller mobil")
  return textFields.element(matching: predicate)
}
```

### ÂØÜÁ†ÅËæìÂÖ•Ê°Ü

`UI Test` ‰ºº‰πéÊó†Ê≥ïËØÜÂà´Âá∫ÂØÜÁ†ÅËæìÂÖ•Ê°ÜÔºåÂõ†Ê≠§Êàë‰ª¨ÈúÄË¶ÅÈÄöËøá `coordinate` ËøõË°åÊêúÁ¥¢„ÄÇ

```
var passwordCoordinate: XCUICoordinate {
  let vector = CGVector(dx: 1, dy: 1.5)
  return emailTextField.coordinate(withNormalizedOffset: vector)
}
```

‰∏ãÈù¢ÊòØËøô‰∏™ÊñπÊ≥ïÁöÑÊñáÊ°£ÊèèËø∞`func coordinate(withNormalizedOffset normalizedOffset: CGVector) -> XCUICoordinate`

> **ÂàõÂª∫Âπ∂ËøîÂõûÂ∏¶ÊúâÊ†áÂáÜÂåñÂÅèÁßªÈáèÁöÑÊñ∞ÂùêÊ†á„ÄÇ**
> **ÂùêÊ†áÁöÑÂ±èÂπïÁÇπÊòØÈÄöËøáÂ∞Ü normalizedOffset ‰πò‰ª•ÂÖÉÁ¥† `frame` ÁöÑÂ§ßÂ∞è‰∏éÂÖÉÁ¥† `frame` ÁöÑÂéüÁÇπÁõ∏Âä†Êù•ËÆ°ÁÆóÁöÑ„ÄÇ**

ÁÑ∂ÂêéËæìÂÖ•ÂØÜÁ†Å

```
app.passwordCoordinate.tap()
app.typeText("My password")
```

Êàë‰ª¨‰∏çÂ∫îËØ•‰ΩøÁî® `app.passwordCoordinate.referencedElement` Âõ†‰∏∫ÂÆÉ‰ºöÊåáÂêëÈÇÆÁÆ±Ë¥¶Êà∑ËæìÂÖ•Ê°Ü ‚ùóÔ∏è üò¢

### ÂÜçÊ¨°ËøêË°åËØ•ÊµãËØï

ËøôÈáåÊàë‰ª¨‰ªé `Xcode -> Product -> Perform Actions -> Test Again` ÂÜçÊ¨°ËøêË°å‰∏ä‰∏Ä‰∏™ÊµãËØï„ÄÇ

![](https://cdn-images-1.medium.com/max/800/0*kYHd-HY0mLvgdXUs.png)

‰ª•‰∏ãÊòØÂÆåÊï¥ÁöÑÊ∫ê‰ª£Á†Å

```
import XCTest
class LoginTests: XCTestCase {
  var app: XCUIApplication!
  func testLogin() {
    continueAfterFailure = false
    app = XCUIApplication()
    app.launch()
    passLogin()
  }
}
extension LoginTests {
  func passLogin() {
    // Tap login
    app.showFacebookLoginFormButton.tap()
    wait(for: app.staticTexts["Facebook"], timeout: 5) // This requires a high timeout
     
    // There may be location permission popup when showing map
    handleLocationPermission()    
    if app.isAlreadyLoggedInSafari {
      app.okButton.tap()
      // Show map
      let map = app.maps.element(boundBy: 0)
      wait(for: map, timeout: 2)
      XCTAssertTrue(map.exists)
      // Need to interact with the app for interruption monitor to work
      app.tap()
    } else {
      // Choose norsk
     wait(for: app.norwegianText, timeout: 1)
      app.norwegianText.tap()
      app.emailTextField.tap()
      app.emailTextField.deleteAllText()
      app.emailTextField.typeText("mujyhwhbby_1496155833@tfbnw.net")
      app.passwordCoordinate.tap()
      app.typeText("Bob Alageaiecghfb Sharpeman")
      // login
      app.facebookLoginButton.tap()
      // press OK
      app.okButton.tap()
      // Show map
      let map = app.maps.element(boundBy: 0)
      wait(for: map, timeout: 2)
      XCTAssertTrue(map.exists)
      // Need to interact with the app for interruption monitor to work
      app.tap()
    }
  }
  fileprivate func handleLocationPermission() {
    addUIInterruptionMonitor(withDescription: "Location permission", handler: { alert in
      alert.buttons.element(boundBy: 1).tap()
      return true
    })
  }
}
fileprivate extension XCUIApplication {
  var showFacebookLoginFormButton: XCUIElement {
    return buttons["Continue with Facebook"]
  }
  var isAlreadyLoggedInSafari: Bool {
    return buttons["OK"].exists || staticTexts["Du har allerede godkjent Blue Sea."].exists
  }
  var okButton: XCUIElement {
    return buttons["OK"]
  }
  var norwegianText: XCUIElement {
    return staticTexts["Norsk (bokm√•l)"]
  }
  var emailTextField: XCUIElement {
    let predicate = NSPredicate(format: "placeholderValue == %@", "E-post eller mobil")
    return textFields.element(matching: predicate)
  }
  var passwordCoordinate: XCUICoordinate {
    let vector = CGVector(dx: 1, dy: 1.5)
    return emailTextField.coordinate(withNormalizedOffset: vector)
  }
  var facebookLoginButton: XCUIElement {
    return buttons["Logg inn"]
  }
}
extension XCTestCase {
  func wait(for duration: TimeInterval) {
    let waitExpectation = expectation(description: "Waiting")
    let when = DispatchTime.now() + duration
    DispatchQueue.main.asyncAfter(deadline: when) {
      waitExpectation.fulfill()
    }
    // We use a buffer here to avoid flakiness with Timer on CI
    waitForExpectations(timeout: duration + 0.5)
  }
  /// Wait for element to appear
  func wait(for element: XCUIElement, timeout duration: TimeInterval) {
    let predicate = NSPredicate(format: "exists == true")
    let _ = expectation(for: predicate, evaluatedWith: element, handler: nil)
    // We use a buffer here to avoid flakiness with Timer on CI
    waitForExpectations(timeout: duration + 0.5)
  }
}
extension XCUIApplication {
  // Because of "Use cached accessibility hierarchy"
  func clearCachedStaticTexts() {
    let _ = staticTexts.count
  }
  func clearCachedTextFields() {
    let _ = textFields.count
  }
  func clearCachedTextViews() {
    let _ = textViews.count
  }
}
extension XCUIElement {
  func deleteAllText() {
    guard let string = value as? String else {
      return
    }
    let lowerRightCorner = coordinate(withNormalizedOffset: CGVector(dx: 0.9, dy: 0.9))
    lowerRightCorner.tap()
    let deletes = string.characters.map({ _ in XCUIKeyboardKeyDelete }).joined(separator: "")
    typeText(deletes)
  }
}
```

### Âè¶Â§ñ‰∏ÄÁÇπ

ÊÑüË∞¢Ëøô‰∫õÊàëÂéüÂàõÊñáÁ´†ÁöÑÊúâÁî®ÂèçÈ¶à [https://github.com/onmyway133/blog/issues/44](https://github.com/onmyway133/blog/issues/44)ÔºåËøôÈáåÊúâ‰∏Ä‰∫õÊõ¥Â§öÁöÑÁÇπÂ≠ê„ÄÇ

*   Ë¶ÅÊü•ÊâæÂØÜÁ†ÅËæìÂÖ•Ê°ÜÔºåÂÆûÈôÖ‰∏äÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® `secureTextFields` Êù•‰ª£Êõø‰ΩøÁî® `coordinate`„ÄÇ
*   `wait` ÂáΩÊï∞Â∫îËØ•‰Ωú‰∏∫ `XCUIElement` ÁöÑÊâ©Â±ïÔºå‰ª•‰æø‰∫éÂÖ∂‰ªñÂÖÉÁ¥†ÂèØ‰ª•‰ΩøÁî®ÂÆÉ„ÄÇÊàñËÄÖ‰Ω†ÂèØ‰ª•‰ΩøÁî®ÊóßÁöÑ `expectation` Ê†∑ÂºèÔºåËøô‰∏çÊ∂âÂèäÁ°¨ÁºñÁ†ÅÁöÑÈó¥ÈöîÂÄº„ÄÇ

### Ëøõ‰∏ÄÊ≠•ÊãìÂ±ï

Ëøô‰∫õÊåáÂçóÊ∂µÁõñ‰∫Ü UITests ËÆ∏Â§öÊñπÈù¢ÁöÑÂÜÖÂÆπÔºåÂÄºÂæó‰∏ÄÁúã„ÄÇ

*   [UI-Testing-Cheat-Sheet](https://github.com/joemasilotti/UI-Testing-Cheat-Sheet)
*   [Everything About Xcode UI Testing](http://samwize.com/2016/02/28/everything-about-xcode-ui-testing-snapshot/)

> Â¶ÇÊûúÂèëÁé∞ËØëÊñáÂ≠òÂú®ÈîôËØØÊàñÂÖ∂‰ªñÈúÄË¶ÅÊîπËøõÁöÑÂú∞ÊñπÔºåÊ¨¢ËøéÂà∞ [ÊéòÈáëÁøªËØëËÆ°Âàí](https://github.com/xitu/gold-miner) ÂØπËØëÊñáËøõË°å‰øÆÊîπÂπ∂ PRÔºå‰πüÂèØËé∑ÂæóÁõ∏Â∫îÂ•ñÂä±ÁßØÂàÜ„ÄÇÊñáÁ´†ÂºÄÂ§¥ÁöÑ **Êú¨ÊñáÊ∞∏‰πÖÈìæÊé•** Âç≥‰∏∫Êú¨ÊñáÂú® GitHub ‰∏äÁöÑ MarkDown ÈìæÊé•„ÄÇ


---

> [ÊéòÈáëÁøªËØëËÆ°Âàí](https://github.com/xitu/gold-miner) ÊòØ‰∏Ä‰∏™ÁøªËØë‰ºòË¥®‰∫íËÅîÁΩëÊäÄÊúØÊñáÁ´†ÁöÑÁ§æÂå∫ÔºåÊñáÁ´†Êù•Ê∫ê‰∏∫ [ÊéòÈáë](https://juejin.im) ‰∏äÁöÑËã±ÊñáÂàÜ‰∫´ÊñáÁ´†„ÄÇÂÜÖÂÆπË¶ÜÁõñ [Android](https://github.com/xitu/gold-miner#android)„ÄÅ[iOS](https://github.com/xitu/gold-miner#ios)„ÄÅ[ÂâçÁ´Ø](https://github.com/xitu/gold-miner#ÂâçÁ´Ø)„ÄÅ[ÂêéÁ´Ø](https://github.com/xitu/gold-miner#ÂêéÁ´Ø)„ÄÅ[Âå∫ÂùóÈìæ](https://github.com/xitu/gold-miner#Âå∫ÂùóÈìæ)„ÄÅ[‰∫ßÂìÅ](https://github.com/xitu/gold-miner#‰∫ßÂìÅ)„ÄÅ[ËÆæËÆ°](https://github.com/xitu/gold-miner#ËÆæËÆ°)„ÄÅ[‰∫∫Â∑•Êô∫ËÉΩ](https://github.com/xitu/gold-miner#‰∫∫Â∑•Êô∫ËÉΩ)Á≠âÈ¢ÜÂüüÔºåÊÉ≥Ë¶ÅÊü•ÁúãÊõ¥Â§ö‰ºòË¥®ËØëÊñáËØ∑ÊåÅÁª≠ÂÖ≥Ê≥® [ÊéòÈáëÁøªËØëËÆ°Âàí](https://github.com/xitu/gold-miner)„ÄÅ[ÂÆòÊñπÂæÆÂçö](http://weibo.com/juejinfanyi)„ÄÅ[Áü•‰πé‰∏ìÊ†è](https://zhuanlan.zhihu.com/juejinfanyi)„ÄÇ
