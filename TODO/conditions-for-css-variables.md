> * åŸæ–‡åœ°å€ï¼š[Conditions for CSS Variables](http://kizu.ru/en/fun/conditions-for-css-variables/)
* åŸæ–‡ä½œè€…ï¼š[Roman Komarov](https://twitter.com/kizmarh)
* è¯‘æ–‡å‡ºè‡ªï¼š[æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)
* è¯‘è€…ï¼š[rottenpen](https://github.com/rottenpen)
* æ ¡å¯¹è€…ï¼š[cyseria](https://github.com/cyseria) [Tina92](https://github.com/Tina92)

# Conditions for CSS Variables

æˆ‘å°†ä»è¿™é‡Œå¼€å§‹ï¼š[ä¸æ˜¯è¿™](#not-those)ï¼ˆè¿™æ˜¯ä¸€ä¸ªåä¸ºâ€œ[ CSS çš„æ¡ä»¶è§„åˆ™](https://www.w3.org/TR/css3-conditional/)æ¨¡å—â€ï¼Œä½†ä¸è¦æœŸæœ›ç€å®ƒèƒ½åŒ…å« CSS çš„å˜é‡ â€”â€” å®ƒæ¶µç›–äº†ä¸€äº› @è§„åˆ™ï¼ˆat-rulesï¼‰ã€‚ç”šè‡³æœ‰ä¸€ä¸ªå…³äº `@when`/`@else` @è§„åˆ™çš„[æè®®](https://tabatkins.github.io/specs/css-when-else/)ï¼Œå†æ¬¡ï¼Œä¸å˜é‡æ²¡æœ‰ä»€ä¹ˆå…±åŒç‚¹ã€‚ï¼‰[](#x) è§„èŒƒä½¿ç”¨ [ CSS å˜é‡](https://www.w3.org/TR/css-variables-1/) çš„æ¡ä»¶ã€‚æˆ‘è®¤ä¸ºè¿™æ˜¯åœ¨è§„èŒƒé‡Œçš„ä¸€ä¸ªé‡å¤§ç¼ºé™·ã€‚å› ä¸ºå˜é‡å·²ç»æä¾›äº†è®¸å¤šä»¥å‰æ— æ³•å®ç°çš„ä¸œè¥¿ã€‚æ²¡æœ‰æ¡ä»¶æ˜¯çœŸçš„ä»¤äººæ²®ä¸§ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½æœ‰å¾ˆå¤šç”¨é€”ã€‚

ä½†å¦‚æœæˆ‘ä»¬ç°åœ¨éœ€è¦é‚£äº›è™šæ„çš„æ¡ä»¶è¯­å¥ç”¨åœ¨ CSS å˜é‡ä¸Šå‘¢ï¼Ÿå¥½ï¼Œæ­£å¦‚ä¸€äº›å…¶ä»–çš„ CSS å‚è€ƒæ‰‹å†Œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç›¸åŒæƒ…å†µä¸‹è¿›è¡Œ hack ã€‚

## [](#the-problem-39-s-definition)é—®é¢˜çš„å®šä¹‰

å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸€ç§ç®€å•çš„ CSS å˜é‡ä½¿ç”¨æ–¹æ³•ï¼Œä¸ºä¸åŒçš„å€¼è®¾å®šä¸åŒçš„ CSS ç‰¹å¾ã€‚ä½†è¿™ç§æ–¹æ³•å¹¶ä¸èƒ½ç›´æ¥æºäºå˜é‡ï¼ˆå°±æ˜¯è¯´â€”â€”å®ƒä»¬çš„å€¼ä¸èƒ½é€šè¿‡æˆ‘ä»¬çš„å˜é‡è®¡ç®—å‡ºæ¥ï¼‰ã€‚è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦è§„å®š**æ¡ä»¶**ã€‚

## [](#using-calculations-for-binary-conditions)ä½¿ç”¨äºŒå…ƒæ¡ä»¶çš„è®¡ç®—

é•¿è¯çŸ­è¯´ï¼Œæˆ‘é©¬ä¸Šå°±ä»‹ç»è§£å†³æ–¹æ³•ç»™ä½ ï¼Œç¨åè¿˜æœ‰å®ƒçš„è§£é‡Šï¼š

    :root {
        --is-big: 0;
    }

    .is-big {
        --is-big: 1;
    }

    .block {
        padding: calc(
            25px * var(--is-big) +
            10px * (1 - var(--is-big))
        );
        border-width: calc(
            3px * var(--is-big) +
            1px * (1 - var(--is-big))
        );
    }

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰çš„ `.block` å…ƒç´ è®¾å®š padding ä¸º `10px` ï¼Œ border è®¾å®šä¸º `1px` ï¼Œä¸€æ—¦è¿™äº›å…ƒç´ çš„ `--is-big` å˜é‡å€¼ç­‰äº`1`ï¼Œå®ƒä»¬çš„å€¼ä¼šåˆ†åˆ«å˜ä¸º `25px` å’Œ `3px`ã€‚

æƒ³è·³è¿‡è¿™ä¸ªæœºåˆ¶ç›¸å½“ç®€å•ï¼šæˆ‘ä»¬å¯ä»¥åœ¨ä½¿ç”¨åˆ° 'calc()' çš„è®¡ç®—ä¸­ï¼ŒåŸºäºå˜é‡çš„å€¼é€‰æ‹©ä¿ç•™å…¶ä¸­ä¸€ä¸ªæœ‰å¯èƒ½çš„å€¼å¹¶ä¸”åºŸé™¤å¦ä¸€ä¸ªå€¼ï¼Œè¯¥å€¼å¯ä»¥æ˜¯ '1' æˆ– '0'ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸€ä¸ªæ¡ˆä¾‹ä¸­é‡åˆ° `25px * 1 + 10px * 0` ï¼Œè€Œåœ¨å¦å¤–ä¸€ä¸ªæ¡ˆä¾‹ä¸­é‡åˆ° `25px * 0 + 10px * 1`ã€‚

## [](#more-complex-conditions)æ›´å¤æ‚çš„æ¡ä»¶

æˆ‘ä»¬ä½¿ç”¨æ­¤æ–¹æ³•ä¸ä»…å¯ä»¥ä» 2 ä¸ªæœ‰å¯èƒ½çš„å€¼ä¸­é€‰æ‹©ï¼Œè€Œä¸”å¯ä»¥ä» 3 ä¸ªæˆ–æ›´å¤šä¸ªå€¼ä¸­è¿›è¡Œé€‰æ‹©ã€‚ç„¶è€Œï¼Œæ¯æ·»åŠ ä¸€ä¸ªæ–°çš„å¯èƒ½å€¼ï¼Œéƒ½ä¼šä½¿è®¡ç®—æ›´åŠ å¤æ‚ã€‚ä¸ºäº†åœ¨ 3 ä¸ªå¯èƒ½å€¼ä¹‹é—´è¿›è¡Œé€‰æ‹©ï¼Œå®ƒå°†çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

    .block {
        padding: calc(
            100px * (1 - var(--foo)) * (2 - var(--foo)) * 0.5 +
             20px * var(--foo) * (2 - var(--foo)) +
              3px * var(--foo) * (1 - var(--foo)) * -0.5
        );
    }

è¿™é‡Œå˜é‡ `-foo` å¯ä»¥æ¥å— `0` ï¼Œ `1` å’Œ `2` ï¼Œå¹¶ä¸”ç›¸åº”çš„å°†å…ƒç´ çš„ padding è®¾ä¸º `100px`ï¼Œ`20px`æˆ–`3px`ã€‚

åŸç†æ˜¯ä¸€æ ·çš„ï¼šæˆ‘ä»¬åªéœ€è¦å°†æ¯ä¸ªå¯èƒ½çš„å€¼ä¹˜ä»¥ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå½“è¿™ä¸ªå€¼çš„æ¡ä»¶æ˜¯æˆ‘ä»¬éœ€è¦çš„å€¼æ—¶ï¼Œè¯¥å€¼ç­‰äº`1`ï¼Œåœ¨å…¶ä»–æƒ…å†µä¸‹ä¸º`0`ã€‚ å¹¶ä¸”è¿™ä¸ªè¡¨è¾¾å¼å¯ä»¥å¾ˆå®¹æ˜“åœ°ç»„æˆï¼šæˆ‘ä»¬åªéœ€è¦ä½¿æˆ‘ä»¬çš„æ¡ä»¶å˜é‡çš„æ¯ä¸ªå…¶ä»–å¯èƒ½çš„å€¼æ— æ•ˆè€Œå·²ã€‚ è¿™æ ·åšåï¼Œæˆ‘ä»¬éœ€è¦åœ¨é‚£é‡Œæ·»åŠ è§¦å‘å€¼ï¼Œçœ‹çœ‹æ˜¯å¦éœ€è¦è°ƒæ•´ç»“æœï¼Œä½¿å…¶ç­‰äº 1\ã€‚ å°±æ˜¯è¿™æ ·ã€‚

### [](#a-possible-trap-in-the-specs)åœ¨è§„æ ¼ä¸­å¯èƒ½çš„é™·é˜±

éšç€è¿™ç§è®¡ç®—å¤æ‚æ€§çš„å¢åŠ ï¼Œåœ¨æŸä¸ªç‚¹ï¼Œå®ƒä»¬æœ‰å¯èƒ½å¤±æ•ˆã€‚ ä¸ºä»€ä¹ˆï¼Ÿ è¿™ä¸ªç¬”è®°åœ¨[è§„èŒƒä¸­](https://drafts.csswg.org/css-values-3/#calc-syntax):

> ç”¨æˆ·ä»£ç†å¿…é¡»æ”¯æŒè‡³å°‘20ä¸ªæœ¯è¯­çš„ calcï¼ˆï¼‰ è¡¨è¾¾å¼ï¼Œå…¶ä¸­æ¯ä¸ªæ•°å­—ï¼Œå°ºå¯¸æè¿°æˆ–ç™¾åˆ†æ¯”éƒ½æ˜¯æ˜¯ä¸€ä¸ªæœ¯è¯­ã€‚ å¦‚æœ calcï¼ˆï¼‰ è¡¨è¾¾å¼ä¸­åŒ…å«çš„æœ¯è¯­è¶…è¿‡äº†è¿™ä¸ªèŒƒå›´ï¼Œåˆ™å¿…é¡»è§†å…¶æ— æ•ˆã€‚

å½“ç„¶ï¼Œæˆ‘æµ‹è¯•è¿‡è¿™ä¸€ç‚¹ï¼Œåœ¨æˆ‘æµ‹è¯•çš„æµè§ˆå™¨ä¸­æ²¡æ‰¾åˆ°è¿™æ ·çš„é™åˆ¶ã€‚ä½†åœ¨ä½ å†™ä¸€äº›çœŸæ­£å¤æ‚çš„ä»£ç æ—¶å€™ï¼Œæˆ–è€…æœªæ¥ä¸€äº›æµè§ˆå™¨å¼•å…¥è¿™ä¸ªé™åˆ¶çš„æ—¶å€™å¯èƒ½ï¼Œå°±æœ‰æœºä¼šè¾¾åˆ°è¿™ä¸ªé™åˆ¶äº†ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨çœŸæ­£å¤æ‚çš„è®¡ç®—æ—¶ä½ è¦å°å¿ƒäº†ã€‚

## [](#conditions-for-colors)é¢œè‰²çš„æ¡ä»¶

ä½ å¯ä»¥çœ‹åˆ°ï¼Œè¿™äº›æ•°å€¼åªèƒ½ç”¨äºä½ å¯ä»¥ _è®¡ç®—_ çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰åŠæ³•ä½¿ç”¨å®ƒæ¥åˆ‡æ¢ `display` å±æ€§æˆ–ä»»ä½•å…¶ä»–éæ•°å­—çš„å€¼ã€‚ ä½†æ˜¯é¢œè‰²æ€ä¹ˆæ ·ï¼Ÿå®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—é¢œè‰²çš„å„ä¸ªç»„æˆéƒ¨åˆ†ã€‚å¯æ‚²çš„æ˜¯ï¼Œç°åœ¨å®ƒåªèƒ½åœ¨ Webkits å’Œ Blinks ä¸­å·¥ä½œï¼Œä¾‹å¦‚Â [ Firefox è¿˜ä¸æ”¯æŒ](https://bugzilla.mozilla.org/show_bug.cgi?id=984021 "Bugzilla ticket") åœ¨ `rgba()` é‡Œä½¿ç”¨ `calc()` å’Œå…¶ä»–æ•°å­¦å‡½æ•°ã€‚

ä¸è¿‡å½“æ”¯æŒå°†åœ¨å“ªé‡Œï¼ˆæˆ–è€…å¦‚æœä½ æƒ³åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ç°æœ‰çš„æ”¯æŒè¿›è¡Œå®éªŒæ—¶ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åšè¿™æ ·çš„äº‹æƒ…ï¼š

    :root {
        --is-red: 0;
    }

    .block {
        background: rgba(
            calc(
                255*var(--is-red) +
                0*(1 - var(--is-red))
                ),
            calc(
                0*var(--is-red) +
                255*(1 - var(--is-red))
                ),
            0, 1);
    }

è¿™é‡Œæˆ‘ä»¬é»˜è®¤ä½¿ç”¨ç°è‰²ï¼Œå¦‚æœ `--is-red` è¢«è®¾ç½®ä¸º `1` ï¼Œåˆ™ä¸ºçº¢è‰²ï¼ˆè¯·æ³¨æ„ï¼Œè¯¥ç»„ä»¶å¯ä»¥æ˜¯é›¶ï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥å®ƒï¼Œä½¿åˆ¶ä½œå‡ºæ¥çš„ä»£ç æ›´ç´§å‡‘ï¼Œ è¿™é‡Œæˆ‘ä¿ç•™äº†é‚£äº›å…³äºæ¸…æ™°åº¦çš„ç®—æ³•ï¼‰ã€‚

æ­£å¦‚ä½ å¯ä»¥åœ¨ä»»ä½•ç»„ä»¶è¿›è¡Œè¿™äº›è®¡ç®—ï¼Œä½ å®Œå…¨å¯ä»¥ä¸ºä»»ä½•é¢œè‰²åˆ›å»ºè¿™äº›æ¡ä»¶ï¼ˆç”šè‡³å¯ä»¥æ˜¯æ¸å˜è‰²ï¼Œä½ åº”è¯¥å°è¯•ï¼ï¼‰ã€‚

### [](#another-trap-in-the-specs)è§„èŒƒä¸­çš„å¦ä¸€ä¸ªé™·é˜±

å½“æˆ‘æµ‹è¯•é¢œè‰²çš„æ¡ä»¶å¦‚ä½•å·¥ä½œï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªçœŸæ­£çš„ _really_ [è§„æ ¼ä¸­çš„å¥‡æ€ªçš„é™åˆ¶](#issue-resolved) (Tab Atkins [commented](https://github.com/kizu/kizu.github.com/issues/186) è¿™ä¸ªé—®é¢˜ä¸é¢œè‰²ç»„ä»¶æ˜¯å›ºå®šçš„è§„æ ¼ï¼ˆä½†æµè§ˆå™¨å°šæœªæ”¯æŒï¼‰ã€‚ å¥½æäº†ï¼ å¦å¤–ä»–è¯´ï¼Œä½œä¸ºå¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `rgba` é‡Œé¢çš„ç™¾åˆ†æ¯”ï¼Œæˆ‘å®Œå…¨å¿˜äº†è¿™ä¸ªåŠŸèƒ½ï¼Œå“ˆå“ˆã€‚)[](#x). ItÂ isÂ called [â€œType Checkingâ€](https://twitter.com/kizmarh/status/788504161864261632)ã€‚æˆ‘ç°åœ¨æ­£å¼åœ°è®¨åŒå®ƒäº†ã€‚ è¿™æ„å‘³ç€å¦‚æœå±æ€§åªæ¥å— `&lt;integer&gt;` ä½œä¸ºå€¼ï¼Œæˆ–è€…ä½ åœ¨ `calc()` é‡Œé¢æœ‰ä»»ä½•åˆ†å‰²æˆ–éæ•´æ•°ï¼Œå“ªæ€•ç»“æœæ˜¯æ•´æ•°, â€œresolved typeâ€ éƒ½ä¸ä¼šæ˜¯ `&lt;integer&gt;` ï¼Œå®ƒå°†æ˜¯ `&lt;integer&gt;` ï¼Œè¿™æ„å‘³ç€è¿™äº›å±æ€§ä¸ä¼šæ¥å—è¿™æ ·çš„å€¼ã€‚ å½“æˆ‘ä»¬è®¡ç®—æ¶‰åŠä¸¤ä¸ªä»¥ä¸Šçš„å¯èƒ½å€¼æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªéæ•´æ•°ä¿®é¥°ç¬¦ã€‚ è¿™å°†ä½¿æˆ‘ä»¬çš„è®¡ç®—å¯¹äºä½¿ç”¨é¢œè‰²æˆ–å…¶ä»–åªæœ‰æ•´æ•°çš„å±æ€§ï¼ˆå¦‚ `z-index` ï¼‰æ— æ•ˆã€‚

å¦‚ä¸‹æ‰€ç¤º:

    calc(255 * (1 - var(--bar)) * (var(--bar) - 2) * -0.5)

è¿™åœ¨ `rgbaï¼ˆï¼‰` é‡Œé¢æ˜¯æ— æ•ˆçš„ã€‚ æœ€åˆæˆ‘è®¤ä¸ºè¿™ç§è¡Œä¸ºæ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œç‰¹åˆ«æ˜¯çŸ¥é“é¢œè‰²å‡½æ•°å®é™…æ¥å—çš„å€¼æ˜¯æ€æ ·è¶…å‡ºå¯èƒ½èŒƒå›´çš„å€¼ï¼ˆä½ å¯ä»¥åš `rgbaï¼ˆ9001ï¼Œ+9001ï¼Œ-9001ï¼Œ42ï¼‰` ï¼Œå¹¶å¾—åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„é»„è‰²ï¼‰ï¼Œä½†è¿™ç±»ä¸œè¥¿ä¼¼ä¹å¤ªéš¾ä»¥è®©æµè§ˆå™¨æ¥å¤„ç†ã€‚

#### [](#solutions-)è§£å†³æ–¹æ¡ˆï¼Ÿ

æœ‰ä¸€ä¸ªä¸æ€ä¹ˆå®Œç¾çš„è§£å†³æ–¹æ¡ˆã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“æœŸæœ›çš„å€¼å’Œæœ‰é—®é¢˜çš„ä¿®é¥°ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥é¢„å…ˆè®¡ç®—å®ƒä»¬ï¼Œç„¶åå››èˆäº”å…¥ã€‚ æ˜¯çš„ï¼Œè¿™æ„å‘³ç€ç»“æœå€¼å¯èƒ½ä¸å®Œå…¨ç›¸åŒï¼Œå› ä¸ºæˆ‘ä»¬å°†å¤±å»ä¸€äº›ç²¾åº¦åœ¨æŸäº›æƒ…å†µä¸‹ã€‚ ä½†å®ƒæ¯”æ²¡æœ‰ä»€ä¹ˆå¥½ï¼Œå¯¹å§ï¼Ÿ

ä½†æ˜¯æœ‰å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆå¯ä»¥ç”¨äºé¢œè‰² â€”â€” æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `hsla` å–ä»£ `rgba` ï¼Œå› ä¸ºå®ƒä¸æ¥å—æ•´æ•°ï¼Œè€Œæ˜¯æ•°å­—å’Œç™¾åˆ†æ¯”ï¼Œå› æ­¤ç±»å‹è§£æä¸­ä¸ä¼šæœ‰å†²çªã€‚ ä½†æ˜¯å¯¹äºå…¶ä»–å±æ€§ï¼Œå¦‚ `z-index` ï¼Œè§£å†³æ–¹æ¡ˆå°†ä¸å·¥ä½œã€‚ ä½†å³ä½¿ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œå¦‚æœä½ è¦å°† `rgb` è½¬æ¢ä¸º `hsl` ï¼Œä»ç„¶ä¼šæœ‰ä¸€äº›ç²¾åº¦çš„æŸå¤±ã€‚ ä½†æ˜¯åº”è¯¥æ¯”ä»¥å‰çš„è§£å†³æ–¹æ¡ˆå°‘ã€‚

## [](#preprocessing)é¢„å¤„ç†
å½“æ¡ä»¶æ˜¯äºŒè¿›åˆ¶æ—¶ï¼Œä½ ä»ç„¶å¯ä»¥ç”¨æ‰‹å†™ã€‚ ä½†æ˜¯å½“æˆ‘ä»¬å¼€å§‹ä½¿ç”¨æ›´å¤æ‚çš„æ¡ä»¶æ—¶ï¼Œæˆ–è€…å½“æˆ‘ä»¬å¾—åˆ°é¢œè‰²æ—¶ï¼Œæˆ‘ä»¬æœ€å¥½æœ‰ä¸€äº›å·¥å…·ï¼Œä½¿å†™å…¥æ›´å®¹æ˜“ã€‚ å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬æœ‰é¢„å¤„ç†å™¨ã€‚


è¿™é‡Œæ˜¯æˆ‘è®¾æ³•åšçš„Â [Stylus](#pen) (ä½ å¯ä»¥çœ‹çœ‹ [ CodePen é‡Œçš„è¿™ä¸ªä»£ç ](http://codepen.io/kizu/pen/zKmyvG) )[](#x)ï¼š

    conditional($var, $values...)
      $result = ''

      // If there is only an array passed, use its contents
      if length($values) == 1
        $values = $values[0]

      // Validating the values and check if we need to do anything at all
      $type = null
      $equal = true

      for $value, $i in $values
        if $i > 0 and $value != $values[0]
          $equal = false

        $value_type = typeof($value)
        $type = $type || $value_type
        if !($type == 'unit' or $type == 'rgba')
          error('Conditional function can accept only numbers or colors')

        if $type != $value_type
          error('Conditional function can accept only same type values')

      // If all the values are equal, just return one of them
      if $equal
        return $values[0]

      // Handling numbers
      if $type == 'unit'
        $result = 'calc('
        $i_count = 0
        for $value, $i in $values
          $multiplier = ''
          $modifier = 1
          $j_count = 0
          for $j in 0..(length($values) - 1)
            if $j != $i
              $j_count = $j_count + 1
              // We could use just the general multiplier,
              // but for 0 and 1 we can simplify it a bit.
              if $j == 0
                $modifier = $modifier * $i
                $multiplier = $multiplier + $var
              else if $j == 1
                $modifier = $modifier * ($j - $i)
                $multiplier = $multiplier + '(1 - ' + $var + ')'
              else
                $modifier = $modifier * ($i - $j)
                $multiplier = $multiplier + '(' + $var + ' - ' + $j + ')'

              if $j_count  0 ? ' + ' : '') + $value + ' * ' + $multiplier
            $i_count = $i_count + 1

        $result = $result + ')'

      // Handling colors
      if $type == 'rgba'
        $hues = ()
        $saturations = ()
        $lightnesses = ()
        $alphas = ()

        for $value in $values
          push($hues, unit(hue($value), ''))
          push($saturations, saturation($value))
          push($lightnesses, lightness($value))
          push($alphas, alpha($value))

        $result = 'hsla(' + conditional($var, $hues) + ', ' + conditional($var, $saturations) + ', ' + conditional($var, $lightnesses) + ', ' + conditional($var, $alphas) +  ')'

      return unquote($result)


æ˜¯çš„ï¼Œè¿™æœ‰å¾ˆå¤šä»£ç ï¼Œä½†æ˜¯è¿™ä¸ª mixin å¯ä»¥ç”ŸæˆåŒ…æ‹¬æ•°å­—å’Œé¢œè‰²åœ¨å†…çš„å¤šç§æœ‰å¯èƒ½çš„æ¡ä»¶ã€‚

å®ƒçš„çš„ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•:

    border-width: conditional(var(--foo), 10px, 20px)


ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬çš„å˜é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°å½“å˜é‡ç­‰äº`0`æ—¶åº”ç”¨çš„å€¼ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å½“å®ƒç­‰äº`1`æ—¶......

è¿™ä¸ªè°ƒç”¨ä¼šäº§ç”Ÿæ­£ç¡®çš„æ¡ä»¶ï¼š

    border-width: calc(10px * (1 - var(--foo)) + 20px * var(--foo));

è¿™é‡Œæ˜¯ä¸€ä¸ªæ›´åŠ å¤æ‚çš„é¢œè‰²æ¡ä»¶ä¾‹å­ï¼š

    color: conditional(var(--bar), red, lime, rebeccapurple, orange)

è¿™è¿˜ä¼šäº§ç”Ÿä¸€äº›ä½ è‚¯å®šä¸æƒ³æ‰‹å†™çš„ä¸œè¥¿ï¼š

    color: hsla(calc(120 * var(--bar) * (var(--bar) - 2) * (var(--bar) - 3) * 0.5 + 270 * var(--bar) * (1 - var(--bar)) * (var(--bar) - 3) * 0.5 + 38.82352941176471 * var(--bar) * (1 - var(--bar)) * (var(--bar) - 2) * -0.16666666666666666), calc(100% * (1 - var(--bar)) * (var(--bar) - 2) * (var(--bar) - 3) * 0.16666666666666666 + 100% * var(--bar) * (var(--bar) - 2) * (var(--bar) - 3) * 0.5 + 49.99999999999999% * var(--bar) * (1 - var(--bar)) * (var(--bar) - 3) * 0.5 + 100% * var(--bar) * (1 - var(--bar)) * (var(--bar) - 2) * -0.16666666666666666), calc(50% * (1 - var(--bar)) * (var(--bar) - 2) * (var(--bar) - 3) * 0.16666666666666666 + 50% * var(--bar) * (var(--bar) - 2) * (var(--bar) - 3) * 0.5 + 40% * var(--bar) * (1 - var(--bar)) * (var(--bar) - 3) * 0.5 + 50% * var(--bar) * (1 - var(--bar)) * (var(--bar) - 2) * -0.16666666666666666), 1);

æ³¨æ„ï¼Œæ²¡æœ‰æ£€æµ‹ `&lt; integer&gt;` æ¥å—å±æ€§ï¼Œæ‰€ä»¥å®ƒä¸èƒ½ç”¨äº `z-index` ç­‰ï¼Œä½†æ˜¯å®ƒå·²ç»å°†é¢œè‰²è½¬æ¢ä¸º `hslaï¼ˆï¼‰` ï¼Œä½¿å®ƒä»¬å¯æ§ï¼ˆå³ä½¿æŠ€æœ¯å¯ä»¥å¢å¼ºï¼Œè¿™ç§è½¬æ¢ä»å°†å‘ç”Ÿï¼Œåªæœ‰å½“å®ƒå°†éœ€è¦ï¼‰ã€‚ å¦ä¸€ä»¶äº‹æˆ‘æ²¡æœ‰å®ç°åœ¨è¿™ä¸ª mixinï¼ˆè¿˜æ²¡ï¼Ÿï¼‰æ˜¯ä½¿ç”¨CSSå˜é‡çš„å€¼çš„èƒ½åŠ›ã€‚ è¿™å¯¹äºéæ•´æ•°æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºé‚£äº›å€¼å°†å¦‚æ¡ä»¶è®¡ç®—ä¸­é‚£æ ·æ’å…¥ã€‚ ä¹Ÿè®¸ï¼Œå½“æˆ‘æ‰¾åˆ°æ—¶é—´æ—¶ï¼Œæˆ‘å°†ä¿®å¤ mixin ï¼Œä½¿å®ƒä¸ä»…æ¥å—æ•°å­—æˆ–é¢œè‰²ï¼Œè€Œä¸”æ¥å—å˜é‡ã€‚ ç›®å‰ä»ç„¶å¯ä»¥ä½¿ç”¨æœ¬æ–‡ä¸­è§£é‡Šçš„ç®—æ³•ã€‚

## [](#fallbacks)åé€€

å½“ç„¶ï¼Œå¦‚æœä½ è®¡åˆ’å®é™…ä½¿ç”¨è¿™ä¸ªï¼Œä½ éœ€è¦æœ‰ä¸€ä¸ªæ–¹æ³•æ¥è®¾ç½®å›é€€ã€‚ å¯¹äºä¸æ”¯æŒå˜é‡çš„æµè§ˆå™¨ï¼Œå¾ˆç®€å•ï¼šåªéœ€åœ¨æ¡ä»¶å£°æ˜ä¹‹å‰å£°æ˜fallbackå€¼ï¼š

    .block {
        padding: 100px; /* fallback */
        padding: calc(
            100px * ((1 - var(--foo)) * (2 - var(--foo)) / 2) +
             20px * (var(--foo) * (2 - var(--foo))) +
              3px * (var(--foo) * (1 - var(--foo)) / -2)
        );
    }

ä½†æ˜¯å½“æ¶‰åŠåˆ°é¢œè‰²æˆ‘ä»¬æœ‰ä¸€ä¸ªé—®é¢˜ï¼šå½“æœ‰ä¸€ä¸ªæ”¯æŒå˜é‡ï¼Œäº‹å®ä¸Šï¼ˆè¿™æ˜¯è§„èŒƒé‡Œçš„å¦ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„åœ°æ–¹ï¼‰ï¼Œ_æ‰€æœ‰_åŒ…å«è¯¥å˜é‡çš„å£°æ˜å°†è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚ è¿™æ„å‘³ç€åœ¨CSSä¸­ä¸å¯èƒ½å¯¹åŒ…å«å˜é‡çš„ä¸œè¥¿åšå‡ºå›é€€ï¼š

    background: blue;
    background: I ğŸ’© CSS VAR(--I)ABLES;

æ˜¯æœ‰æ•ˆçš„CSSå’Œè§„èŒƒï¼Œè¿™èƒŒæ™¯å°†å¾—åˆ°ä¸€ä¸ªâ€œåˆå§‹â€å€¼ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåå¤‡æä¾›çš„å€¼ï¼ˆå³ä½¿å…¶ä»–éƒ¨åˆ†çš„å€¼æ˜æ˜¾é”™è¯¯ï¼‰ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨è¿™äº›æƒ…å†µä¸‹éœ€è¦æä¾›ä¸€ä¸ªå›è°ƒ - æ·»åŠ  `@ support` æµ‹è¯•è¢«æ”¯æŒçš„éƒ¨åˆ†æ¥**æ’é™¤**å˜é‡ã€‚

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæˆ‘ä»¬ Firefox çš„æ¡ä»¶é¢œè‰²åŒ…è£…ï¼Œåƒè¿™æ ·ï¼š

    .block {
        color: #f00;
    }
    @supports (color: rgb(0, calc(0), 0)) {
        .block {
            color: rgba(calc(255 * (1 - var(--foo))), calc(255 * var(--foo)), 0, 1);
      }
    }

è¿™é‡Œæˆ‘ä»¬æµ‹è¯•ä¸€ä¸ªå…³äºé¢œè‰²ç®—æ³•çš„æ”¯æŒï¼Œå¹¶ä»…åœ¨è¿™ç§æƒ…å†µä¸‹åº”ç”¨æ¡ä»¶é¢œè‰²ã€‚

ä¹Ÿå¯ä»¥è‡ªåŠ¨åˆ›å»ºè¿™æ ·çš„å¤‡ä»½ï¼Œä½†æ˜¯æˆ‘ä¸å»ºè®®æ‚¨ä¸ºå®ƒä»¬ä½¿ç”¨é¢„å¤„ç†å™¨ï¼Œå› ä¸ºåˆ›å»ºè¿™æ ·çš„ä¸œè¥¿çš„å¤æ‚æ€§è¿œä¸æ­¢é¢„å¤„ç†å™¨æä¾›çš„åŠŸèƒ½ã€‚

## [](#use-cases)ä½¿ç”¨å®ä¾‹

æˆ‘çœŸçš„ä¸è§‰å¾—æœ‰å¿…è¦ä¸ºå¦‚æ­¤æ˜¾è€Œæ˜“è§çš„ä¸œè¥¿æä¾›ä½¿ç”¨å®ä¾‹ã€‚ æ‰€ä»¥æˆ‘ä¼šå¾ˆç®€çŸ­ã€‚åŒæ—¶æˆ‘å°†ä¸ä»…æè¿°å˜é‡çš„æ¡ä»¶ï¼Œè€Œä¸”æè¿°ä¸€èˆ¬æ¡ä»¶ï¼Œä¾‹å¦‚ 'calcï¼ˆï¼‰' çš„ç»“æœã€‚

*   CSS å˜é‡çš„æ¡ä»¶å¯¹äºåŒºåˆ†å—æ˜¯å®Œç¾çš„ã€‚è¿™æ ·ï¼Œä½ å¯ä»¥æœ‰ä¸€äº›ç¼–å·çš„ä¸»é¢˜ï¼Œç„¶åå°†å®ƒä»¬åº”ç”¨åˆ°å—ï¼ˆå’ŒåµŒå¥—çš„ï¼ï¼‰åªä½¿ç”¨ä¸€ä¸ªåƒ `--block-variantï¼š1` çš„ CSS å˜é‡ã€‚è¿™æ˜¯ä¸æ˜¯å°±å¯ä»¥é€šè¿‡ä¸åŒçš„æ¡ä»¶å–ä»£å˜é‡ï¼Œå½“ä½ æƒ³è¦ä¸åŒçš„ä¸»ä½“ï¼Œä¸åŒçš„é“å…·ï¼Œä¸åŒçš„å€¼ï¼Œå¦‚æœæ²¡æœ‰æ¡ä»¶ï¼Œä½ å°†éœ€è¦æœ‰å¾ˆå¤šçš„å˜é‡å¹¶åº”ç”¨ä¸ä»–ä»¬æ¯ä¸€ä¸ªæ¡ˆä¾‹ä¸­å»ã€‚

*   æ’ç‰ˆã€‚ å¦‚æœæœ‰å¯èƒ½ä½¿ç”¨Â  `&lt;` ,  `&lt;=` ,  `&gt;`  å’ŒÂ  `&gt;=` ä¸ºå˜é‡çš„æƒ…å†µä¸‹ï¼Œæœ‰å¯èƒ½æœ‰ä¸åŒå­—ä½“å¤§å°çš„ä¸€äº›â€œè§„åˆ™â€ï¼Œ å› æ­¤æ‚¨å¯ä»¥æ ¹æ®ç»™å®šçš„å­—ä½“å¤§å°è®¾ç½®ä¸åŒçš„è¡Œé«˜ï¼Œå­—ä½“ç²—ç»†å’Œå…¶ä»–å±æ€§ã€‚ç°åœ¨è¿™æ˜¯å¯èƒ½çš„ï¼Œä½†ç°åœ¨ï¼Œä½ éœ€è¦é‚£äº›å€¼æœ‰ä¸€äº›â€œåœé¡¿â€ï¼Œè€Œä¸ä»…ä»…æ˜¯ä» `em`s è·å¾—çš„å€¼ã€‚

*   å“åº”è®¾è®¡ã€‚ å¥½å§ï¼Œå¦‚æœæœ‰è®¡ç®—çš„æ¡ä»¶ï¼Œé‚£ä¹ˆå®ƒå‡ ä¹ä¸é‚£äº›éš¾ä»¥æ‰æ‘¸çš„â€œå…ƒç´ æŸ¥è¯¢â€ç›¸åŒ â€”â€” ä½ å¯ä»¥æ£€æŸ¥ `vw` æˆ–çˆ¶å…ƒç´ çš„å®½åº¦ç™¾åˆ†æ¯”ï¼Œå¹¶å†³å®šåœ¨ä¸åŒçš„æƒ…å†µä¸‹åº”ç”¨ä»€ä¹ˆã€‚

å¦‚æœä½ æ‰¾åˆ°å…¶ä»–ä½¿ç”¨æ¡ˆä¾‹ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚æˆ‘ç›¸ä¿¡è¿˜æœ‰å¾ˆå¤šè¿™æ ·çš„æ¡ˆä¾‹ï¼Œä½†æˆ‘æ²¡æœ‰é‚£ä¹ˆå¥½çš„è®°å¿†åŠ›æŠŠå®ƒä»¬å…¨éƒ¨è®°ä¸‹æ¥ã€‚æˆ‘æ›¾ç»æƒ³ç”¨ CSS æŠŠå®ƒåšå‡ºæ¥ã€‚å› ä¸ºè¿™æ˜¯å®ƒçš„ä¸€åˆ‡ã€‚ 

## [](#future)æœªæ¥

æˆ‘çœŸçš„æƒ³çœ‹åˆ°CSSè§„èŒƒä¸­æè¿°çš„æ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ä¼šä¾èµ– calc hacks ï¼Œå¹¶ä¸”å¯ä»¥ä¸ºéè®¡ç®—å€¼ä½¿ç”¨é€‚å½“çš„æ¡ä»¶ã€‚ ç°åœ¨ä¹Ÿä¸å¯èƒ½æœ‰é™¤äº†ä¸¥æ ¼ç›¸ç­‰çš„æ¡ä»¶ï¼Œæ‰€ä»¥æ²¡æœ‰â€œå½“å˜é‡è¶…è¿‡ X â€å’Œå…¶ä»–ç±»ä¼¼çš„ä¸œè¥¿ã€‚ æˆ‘æ²¡æœ‰çœ‹åˆ°ä»»ä½•ç†ç”±ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½åœ¨ CSS ä¸­æœ‰é€‚å½“çš„æ¡ä»¶ï¼Œæ‰€ä»¥å¦‚æœä½ çŸ¥é“ä¸€ä¸ªè§„èŒƒå¼€å‘äººå‘˜ï¼Œæç¤ºä»–ä»¬è¿™ä¸ªé—®é¢˜ã€‚ æˆ‘å”¯ä¸€çš„å¸Œæœ›æ˜¯ï¼Œä»–ä»¬ä¸ä¼šå‘Šè¯‰æˆ‘ä»¬â€œåªæ˜¯ä½¿ç”¨ JS â€æˆ–æ‰¾å‡ºåŸå› ï¼Œä¸ºä»€ä¹ˆæ˜¯ä¸å¯èƒ½çš„ã€‚ åœ¨è¿™é‡Œï¼Œç°åœ¨å·²ç»å¯ä»¥ä½¿ç”¨ hacksï¼Œä¸èƒ½æœ‰ä»»ä½•å€Ÿå£ã€‚

å‘è¡¨åœ¨ 10 æœˆ 21 æ—¥ï¼Œ äº[å®éªŒ](../)ä¸­.



å¦‚æœä½ å‘ç°ä»€ä¹ˆç¼–å†™é”™è¯¯æˆ–è€…å°æ¼æ´åˆæˆ–è€…ä½ æƒ³æ·»åŠ ç‚¹ä»€ä¹ˆï¼Œä½ å¯ä»¥ [å†™åœ¨è¿™](https://github.com/kizu/kizu.github.com/issues/new?title=Feedback%20for%20%E2%80%9CConditions%20for%20CSS%20Variables%E2%80%9D) æˆ–è€… [åœ¨ Github ç¼–å†™è¿™ç¯‡æ–‡ç« ](https://github.com/kizu/kizu.github.com/blob/source/src/documents/posts/2016-10-21-(fun)-conditions-for-css-variables/index.en.md).



