> * åŸæ–‡åœ°å€ï¼š[JavaScript Visualized: The JavaScript Engine](https://javascript.plainenglish.io/javascript-visualized-the-javascript-engine-1e3fc5d5310d)
> * åŸæ–‡ä½œè€…ï¼š[Harsh Patel](https://medium.com/@harsh-patel)
> * è¯‘æ–‡å‡ºè‡ªï¼š[æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)
> * æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼š[https://github.com/xitu/gold-miner/blob/master/article/2021/javascript-visualized-the-javascript-engine.md](https://github.com/xitu/gold-miner/blob/master/article/2021/javascript-visualized-the-javascript-engine.md)
> * è¯‘è€…ï¼š[æ²¡äº‹å„¿](https://github.com/Tong-H)
> * æ ¡å¯¹è€…ï¼š[KimYangOfCat](https://github.com/KimYangOfCat) [Usualminds](https://github.com/Usualminds)

# å¯è§†åŒ– JavaScript å¼•æ“

![](https://cdn-images-1.medium.com/max/2000/0*XIjsf6eB35MwgNCg.png)

ä½œä¸º JavaScript å¼€å‘äººå‘˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¸éœ€è¦äº²è‡ªä¸ç¼–è¯‘å™¨æ‰“äº¤é“ã€‚ä½†çŸ¥æ™“ JavaScript å¼•æ“çš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥åŠäº†è§£å®ƒæ˜¯å¦‚ä½•å¤„ç†æˆ‘ä»¬å„è‡ªä¸åŒçš„ JS ä»£ç å¹¶å°†å…¶è½¬åŒ–ä¸ºæœºå™¨èƒ½ç†è§£çš„ä¸œè¥¿ï¼Œä¹Ÿæ˜¯å¾ˆå¥½çš„ï¼ğŸ¥³

> **æ³¨æ„ï¼š** è¿™ç¯‡æ–‡ç« ä¸»è¦åŸºäº Node.js å’Œä»¥ Chromium ä¸ºåŸºç¡€çš„æµè§ˆå™¨ä½¿ç”¨çš„ V8 å¼•æ“ã€‚

---

HTML è§£æå™¨åœ¨ä½ çš„ä»£ç ä¸­å¯»æ‰¾ `script` æ ‡ç­¾ä»¥åŠå…¶å¯¹åº”çš„æ¥æºï¼Œå¹¶ä»å…¶æ¥æºåŠ è½½ç¨‹åºæˆ–ä»£ç ã€‚å®ƒå¯èƒ½æ¥è‡ª **ç½‘ç»œ**ï¼Œ**ä¸´æ—¶å­˜å‚¨**ï¼Œæˆ–è€…å…¶å®ƒ**service worker**ã€‚ç„¶åä»¥**å­—èŠ‚æµ**çš„æ ¼å¼å“åº”ï¼Œç¨åè¯¥å­—èŠ‚æµå°†è¢«å­—èŠ‚æµè§£ç å™¨æ¥ç®¡ï¼ä¸»è¦æ˜¯**å­—èŠ‚æµè§£ç å™¨**ä¼šè§£ç åˆ°æ¥çš„æµæ•°æ®ã€‚

![](https://cdn-images-1.medium.com/max/2000/1*cOoWhcaQqt7YIefpVMjTYw.gif)

---

å­—èŠ‚æµè§£ç å™¨æ ¹æ®å·²è§£ç çš„å­—èŠ‚æµåˆ›å»º tokenã€‚æ¯”å¦‚ï¼Œ`0066` è§£ç ä¸º `f`ï¼Œ`0075` å˜` u`ï¼Œ`006e` å˜ `n`ï¼Œ`0063` å˜ `c`ï¼Œ`0074` å˜ `t`ï¼Œ`0069` å˜ `i`ï¼Œ`006f` å˜ `o`ï¼Œ006e` å˜ä¸º `n` å’Œä¸€ä¸ªç©ºæ ¼ã€‚çœ‹ä¸Šå»å¥½åƒæ˜¯ä½ å†™äº† functionï¼è¿™åœ¨ JavaScript ä¸­æ˜¯ä¸€ä¸ªä¿ç•™å…³é”®å­—ï¼Œä¸€ä¸ª token è¢«åˆ›å»ºå¹¶å‘é€ç»™è§£æå™¨ï¼ˆä»¥åŠé¢„è§£æå™¨ï¼Œè¿™å¹¶æ²¡æœ‰æ¶µç›–åœ¨åŠ¨å›¾é‡Œä½†ç¨åä¼šè§£é‡Šï¼‰ã€‚å…¶ä½™å­—èŠ‚æµçš„å¤„ç†ä¹Ÿä¸€æ ·ã€‚

![](https://cdn-images-1.medium.com/max/2000/1*Eb2a3HrsWCQogSpEW9gHjA.gif)

---

å¼•æ“ä½¿ç”¨ä¸¤ä¸ªè§£æå™¨ï¼šé¢„è§£æå™¨ï¼ˆpre-parserï¼‰å’Œè§£æå™¨ï¼ˆparserï¼‰ã€‚ä¸ºäº†å‡å°‘ç½‘ç«™åŠ è½½èŠ±è´¹çš„æ—¶é—´ï¼Œå¼•æ“ä¼šå°½é‡é¿å…å»è§£æä¸ä¼šè¢«ç«‹å³ä½¿ç”¨çš„ä»£ç ã€‚é¢„è§£æå™¨å¤„ç†å¯èƒ½ç¨åä¼šç”¨åˆ°çš„ä»£ç ï¼Œè€Œè§£æå™¨å¤„ç†é©¬ä¸Šéœ€è¦ä½¿ç”¨çš„ä»£ç ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°åªä¼šåœ¨ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åè¢«è°ƒç”¨ï¼Œé‚£ä¹ˆæ²¡æœ‰å¿…è¦ä¸€å®šè¦åœ¨ç½‘ç«™åŠ è½½æ—¶ç¼–è¯‘å®ƒã€‚å¦‚æœæœ€ç»ˆç”¨æˆ·ç‚¹å‡»äº†æŒ‰é’®ä¸”éœ€è¦è¿™æ®µä»£ç ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«å‘é€ç»™è§£æå™¨ã€‚

è§£æå™¨æ ¹æ®ä»å­—èŠ‚æµè§£ç å™¨å¤„æ¥æ”¶çš„ token æ¥åˆ›å»ºèŠ‚ç‚¹ï¼Œå¹¶ç”¨è¿™äº›èŠ‚ç‚¹æ¥åˆ›å»ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ã€‚ğŸŒ³

![](https://cdn-images-1.medium.com/max/2000/1*r4CyGfK7TWvm1sFl1jaOWQ.gif)

---

ä¸‹ä¸€æ­¥ï¼Œè§£é‡Šå™¨å‡ºåœºï¼è§£é‡Šå™¨éå† AST å¹¶æ ¹æ® AST æ‰€åŒ…å«çš„ä¿¡æ¯æ¥ç”Ÿæˆå­—èŠ‚ç ã€‚ä¸€æ—¦å­—èŠ‚ç ç”Ÿæˆå®Œæ¯•ï¼ŒAST å°±ä¼šè¢«åˆ é™¤ä»è€Œæ¸…ç©ºå†…å­˜ç©ºé—´ã€‚æœ€åï¼Œæˆ‘ä»¬å°±æ‹¥æœ‰äº†æœºå™¨å¯ä»¥ä½¿ç”¨çš„ä¸œè¥¿ã€‚ğŸ‰

![](https://cdn-images-1.medium.com/max/2000/1*5WJid_AePzCASZ0NTLZv-w.gif)

---

å°½ç®¡å­—èŠ‚ç å¾ˆå¿«ï¼Œä½†å®ƒè¿˜å¯ä»¥æ›´å¿«ã€‚å­—èŠ‚ç è¿è¡Œæ—¶ä¼šç”Ÿæˆä¸€äº›ä¿¡æ¯ã€‚å®ƒå¯ä»¥æ£€æµ‹åˆ°æŸäº›è¡Œä¸ºæ˜¯å¦ç»å¸¸å‘ç”Ÿä»¥åŠè¢«ä½¿ç”¨çš„æ•°æ®ç±»å‹ã€‚å¯èƒ½æŸä¸ªå‡½æ•°ä½ è°ƒç”¨äº†å‡ åæ¬¡ï¼Œé‚£ä¹ˆæ˜¯æ—¶å€™åšä¼˜åŒ–äº†ï¼Œä½¿å…¶è¿è¡Œé€Ÿåº¦æ›´å¿«ã€‚ğŸƒğŸ½â€â™€ï¸

å­—èŠ‚ç ä»¥åŠäº§ç”Ÿçš„ç±»å‹åé¦ˆä¼šä¸€èµ·å‘é€ç»™ä¼˜åŒ–ç¼–è¯‘å™¨ã€‚ä¼˜åŒ–ç¼–è¯‘å™¨æ¥æ”¶å­—èŠ‚ç å’Œç±»å‹åé¦ˆï¼Œå¹¶ä»ä¸­ç”Ÿæˆé«˜åº¦ä¼˜åŒ–åçš„æœºå™¨ç ã€‚ğŸš€

![](https://cdn-images-1.medium.com/max/2000/1*xJ3kFQ776JaMquxron2-gQ.gif)

---

JavaScript æ˜¯åŠ¨æ€ç±»å‹çš„è¯­è¨€ï¼Œè¿™ä»£è¡¨æ•°æ®ç±»å‹å¯ä»¥ä¸æ–­æ”¹å˜ã€‚å¦‚æœ JavaScript å¼•æ“æ¯æ¬¡éƒ½éœ€è¦æ£€æŸ¥æŸä¸ªå€¼çš„æ•°æ®ç±»å‹ï¼Œè¿™ä¼šå¯¼è‡´å…¶è¿è¡Œé€Ÿåº¦éå¸¸ç¼“æ…¢ã€‚

ä¸ºäº†å‡å°‘ä»£ç è§£é‡Šçš„æ—¶é—´ï¼Œä¼˜åŒ–åçš„æœºå™¨ç åªå¤„ç†å¼•æ“åœ¨è¿è¡Œå­—èŠ‚ç æ—¶ä¹‹å‰è§è¿‡çš„æƒ…å†µã€‚å¦‚æœæˆ‘ä»¬é‡å¤ä½¿ç”¨æŸæ®µä»£ç ï¼Œè¯¥ä»£ç ä¸€éåˆä¸€éçš„è¿”å›ç›¸åŒçš„æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆä¸ºäº†åŠ å¿«è¿è¡Œé€Ÿåº¦ï¼Œå°±å¯ä»¥ç®€å•çš„å†æ¬¡ä½¿ç”¨ä¼˜åŒ–åçš„æœºå™¨ç ã€‚ç„¶è€Œï¼ŒJavaScript æ˜¯åŠ¨æ€ç±»å‹ï¼Œç›¸åŒçš„ä»£ç å¯èƒ½ä¼šçªç„¶è¿”å›ä¸€ä¸ªä¸åŒçš„æ•°æ®ç±»å‹ã€‚å¦‚æœå‘ç”Ÿäº†è¿™ç§æƒ…å†µï¼Œæœºå™¨ç æ€§èƒ½ä¼šé€€åŒ–ï¼Œå¼•æ“ä¼šé€€å›åˆ°è§£é‡Šå·²äº§ç”Ÿçš„å­—èŠ‚ç çš„æ­¥éª¤ã€‚

å¦‚æœæŸå—ä»£ç è¢«è°ƒç”¨ 100 æ¬¡ï¼Œè€Œä¸”åˆ°ç›®å‰ä¸ºæ­¢è¿”å›ç›¸åŒçš„å€¼ã€‚é‚£ä¹ˆå¼•æ“ä¼šå‡è®¾ï¼Œå½“ä½ ç¬¬ 101 æ¬¡è°ƒç”¨çš„æ—¶å€™ä¾ç„¶è¿”å›è¯¥å€¼ã€‚

æ¯”å¦‚è¯´æˆ‘ä»¬æœ‰ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„æ±‚å’Œå‡½æ•°ï¼Œç›®å‰ä¸ºæ­¢è¯¥å‡½æ•°æ¯ä¸€æ¬¡è°ƒç”¨éƒ½ä¼šå¸¦æœ‰æ•°å­—ç±»å‹çš„å‚æ•°ã€‚

![](https://cdn-images-1.medium.com/max/2000/1*2VZ1b9rX099PDz_wDtwJSw.png)

è¯¥å‡½æ•°ä¼šè¿”å›æ•°å­— 3ï¼å½“æˆ‘ä»¬å†æ¬¡è°ƒç”¨æ—¶ï¼Œå¼•æ“ä¼šå‡å®šæˆ‘ä»¬ä¾ç„¶æºå¸¦ä¸¤ä¸ªæ•°å­—ç±»å‹çš„å‚æ•°ã€‚

å¦‚æœè¿™æ˜¯çœŸçš„ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦åŠ¨æ€æ£€æŸ¥ï¼Œå¼•æ“å¯ä»¥å†æ¬¡ä½¿ç”¨ä¼˜åŒ–åçš„æœºå™¨ç ã€‚åä¹‹ï¼Œå¦‚æœè¯¥å‡è®¾ä¸æ­£ç¡®ï¼Œé‚£ä¹ˆå¼•æ“ä¼šé€€å›åˆ°ä½¿ç”¨åŸæ¥çš„å­—èŠ‚ç è€Œä¸æ˜¯ä¼˜åŒ–çš„æœºå™¨ç ã€‚

æ¯”å¦‚ä¸‹ä¸€æ¬¡è°ƒç”¨å®ƒæ—¶æˆ‘ä»¬ä¼ é€’çš„æ˜¯å­—ç¬¦ä¸²è€Œä¸æ˜¯æ•°å­—ã€‚å› ä¸º JavaScript æ˜¯åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšè€Œä¸”ä¸ä¼šå¼•å‘æŠ¥é”™ã€‚

![](https://cdn-images-1.medium.com/max/2000/1*7IlQ3bxyDA7cdl4Gn1lbCA.png)

è¿™æ„å‘³ç€æ•°å­— `2` å°†ä¼šå¼ºåˆ¶è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œè€Œè¯¥å‡½æ•°å°†ä¼šè¿”å›å­—ç¬¦ä¸² `"12"`ã€‚å¼•æ“å°†å›é€€å»è§£é‡Šå­—èŠ‚ç ä»¥åŠæ›´æ–°ç±»å‹åé¦ˆã€‚

---

æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼ğŸ˜Š å½“ç„¶ï¼Œè¿˜æœ‰å¾ˆå¤šæœ‰å…³å¼•æ“çš„çŸ¥è¯†ç‚¹åœ¨è¿™ç¯‡æ–‡ç« å†…æˆ‘æ²¡æœ‰ä»‹ç»ï¼ˆJS å †ï¼Œè°ƒç”¨æ ˆç­‰ç­‰ï¼‰ï¼Œè¿™äº›æˆ‘å¯èƒ½ç¨åä¼šæ¶µç›–ã€‚å¦‚æœä½ å¯¹ Javascript å†…éƒ¨è¿ä½œæ„Ÿå…´è¶£ï¼Œæˆ‘éå¸¸é¼“åŠ±å¼€å§‹è‡ªå·±åšä¸€äº›ç ”ç©¶ï¼ŒV8 æ˜¯å¼€æºçš„ï¼Œè€Œä¸”æœ‰ä¸€äº›å¾ˆæ£’çš„æ–‡æ¡£æ˜¯å…³äºå®ƒå¦‚ä½•åœ¨åå°å·¥ä½œçš„ã€‚ğŸ¤–

æ„Ÿè°¢é˜…è¯»ï¼Œç¥ä½ æœ‰ç¾å¥½çš„ä¸€å¤©ï¼â¤

> å¦‚æœå‘ç°è¯‘æ–‡å­˜åœ¨é”™è¯¯æˆ–å…¶ä»–éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Œæ¬¢è¿åˆ° [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner) å¯¹è¯‘æ–‡è¿›è¡Œä¿®æ”¹å¹¶ PRï¼Œä¹Ÿå¯è·å¾—ç›¸åº”å¥–åŠ±ç§¯åˆ†ã€‚æ–‡ç« å¼€å¤´çš„ **æœ¬æ–‡æ°¸ä¹…é“¾æ¥** å³ä¸ºæœ¬æ–‡åœ¨ GitHub ä¸Šçš„ MarkDown é“¾æ¥ã€‚

---

> [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner) æ˜¯ä¸€ä¸ªç¿»è¯‘ä¼˜è´¨äº’è”ç½‘æŠ€æœ¯æ–‡ç« çš„ç¤¾åŒºï¼Œæ–‡ç« æ¥æºä¸º [æ˜é‡‘](https://juejin.im) ä¸Šçš„è‹±æ–‡åˆ†äº«æ–‡ç« ã€‚å†…å®¹è¦†ç›– [Android](https://github.com/xitu/gold-miner#android)ã€[iOS](https://github.com/xitu/gold-miner#ios)ã€[å‰ç«¯](https://github.com/xitu/gold-miner#å‰ç«¯)ã€[åç«¯](https://github.com/xitu/gold-miner#åç«¯)ã€[åŒºå—é“¾](https://github.com/xitu/gold-miner#åŒºå—é“¾)ã€[äº§å“](https://github.com/xitu/gold-miner#äº§å“)ã€[è®¾è®¡](https://github.com/xitu/gold-miner#è®¾è®¡)ã€[äººå·¥æ™ºèƒ½](https://github.com/xitu/gold-miner#äººå·¥æ™ºèƒ½)ç­‰é¢†åŸŸï¼Œæƒ³è¦æŸ¥çœ‹æ›´å¤šä¼˜è´¨è¯‘æ–‡è¯·æŒç»­å…³æ³¨ [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)ã€[å®˜æ–¹å¾®åš](http://weibo.com/juejinfanyi)ã€[çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/juejinfanyi)ã€‚
