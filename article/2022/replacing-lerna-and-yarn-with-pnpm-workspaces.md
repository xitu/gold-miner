> * åŸæ–‡åœ°å€ï¼š[Replacing Lerna + Yarn with PNPM Workspaces](https://www.raulmelo.dev/blog/replacing-lerna-and-yarn-with-pnpm-workspaces)
> * åŸæ–‡ä½œè€…ï¼š[Raul Melo](https://www.raulmelo.dev/)
> * è¯‘æ–‡å‡ºè‡ªï¼š[æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)
> * æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼š[https://github.com/xitu/gold-miner/blob/master/article/2022/replacing-lerna-and-yarn-with-pnpm-workspaces.md](https://github.com/xitu/gold-miner/blob/master/article/2022/replacing-lerna-and-yarn-with-pnpm-workspaces.md)
> * è¯‘è€…ï¼š[CarlosChenN](https://github.com/CarlosChenN)
> * æ ¡å¯¹è€…ï¼š[xyj1020](https://github.com/xyj1020) [finalwhy](https://github.com/finalwhy)

# ç”¨ PNPM Workspaces æ›¿æ¢ Lerna + Yarn

è¿‘å¹´æ¥ï¼ŒMonorepo æ¶æ„ä»¥è¶Šæ¥è¶Šæµè¡Œï¼Œé‰´äºå®ƒè§£å†³çš„é—®é¢˜ï¼Œè¿™æ˜¯å¯ä»¥ç†è§£çš„ã€‚ç„¶è€Œï¼Œæœ€å¤§çš„æŒ‘æˆ˜æ˜¯æ‰¾åˆ°ä¸€ä¸ªç®€å•æ˜“ç”¨çš„å·¥å…·å»å¤„ç†ç±»ä¼¼çš„æ¶æ„ã€‚

å¦‚æœä½ æœç´¢ â€œmonorepo tool javascriptâ€ï¼Œä½ ä¼šå‘ç°æœ‰å¾ˆå¤šæ–‡ç« éƒ½åœ¨å‘æˆ‘ä»¬å±•ç¤ºå½“ä¸‹éå¸¸æµè¡Œçš„ä¸€äº›å·¥å…·ï¼Œä½†æ˜¯å¥‡æ€ªçš„æ˜¯æ¯ä¸€ç§å·¥å…·éƒ½åœ¨ç”¨ä¸€ç§æˆªç„¶ä¸åŒçš„æ–¹å¼å»è§£å†³ monorepo èƒ½è§£å†³çš„é—®é¢˜ã€‚

ä»æˆ‘ä»¬ç°æœ‰çš„é€‰é¡¹æ¥çœ‹ï¼Œä¸€äº›å·¥å…·ï¼ˆä¾‹å¦‚ Lernaï¼‰å·²ç»å­˜åœ¨ä¸€æ®µæ—¶é—´ï¼Œä½†å·²ç»ä¸å†æŒç»­ç»´æŠ¤äº†ï¼›å¦ä¸€äº›å·¥å…·ï¼ˆä¾‹å¦‚ Boltï¼‰ï¼Œæ–¹æ¡ˆè¿˜æ²¡æœ‰è¢«é€šè¿‡ï¼›è¿˜æœ‰ä¸€äº›å·¥å…·å¯ä»¥è¿è¡Œï¼Œä½†åªé€‚ç”¨äºæŸç§ç‰¹å®šçš„é¡¹ç›®ã€‚

ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¸€ä¸ªå¥½çš„å·¥å…·é€‚ç”¨äºæ‰€æœ‰ JavaScript/Typescript ç±»å‹çš„é¡¹ç›®å’Œæ‰€æœ‰å›¢é˜Ÿè§„æ¨¡ï¼Œä½†è¿™æ˜¯å¯ä»¥ç†è§£çš„ã€‚

ç„¶è€Œï¼Œç°åœ¨æœ‰ä¸€ä¸ªï¼ˆâ€œæ–°â€ï¼‰é€‰é¡¹ï¼Œå¯èƒ½åœ¨å¤§å¤šæ•°åœºæ™¯ä¸­ï¼Œå¯¹æˆ‘ä»¬æœ‰æ‰€å¸®åŠ©ï¼š**pnpm workspaces**ã€‚

ä½†åœ¨è°ˆåˆ° pnpm ä¹‹å‰ï¼Œè®©æˆ‘å‘Šè¯‰ä½ ï¼Œæˆ‘çš„ monorepo/workspaces ç”¨æ³•ï¼Œä»¥åŠæˆ‘æ˜¯å¦‚ä½•å°è¯•è§£å†³ä½¿ç”¨ monorepo ä¸­é‡åˆ°çš„é—®é¢˜çš„ã€‚

## æˆ‘çš„åšå®¢

åœ¨æˆ‘ç¬¬ä¸€æ¬¡åˆ›å»ºæˆ‘çš„åšå®¢ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ª Next.js åº”ç”¨ï¼ŒæŠŠå®ƒæ”¾åˆ°ä¸€ä¸ª git ä»“åº“ï¼Œå¹¶ä¸”åŒæ—¶æŠŠè„šæ‰‹æ¶çš„ä»£ç æäº¤ï¼ˆæˆ–è€… pushï¼‰è¿›äº†åŒä¸€ä¸ªä»“åº“ã€‚

åœ¨æ­¤ä¹‹åï¼Œæˆ‘éœ€è¦å»ºç«‹ä¸€ä¸ª CMSï¼ˆå†…å®¹ç®¡ç†ç³»ç»Ÿï¼‰å­˜æ”¾æˆ‘çš„å†…å®¹ã€‚ç„¶åï¼Œæˆ‘åˆ›å»ºä¸€ä¸ª Strapi åº”ç”¨ï¼ŒæŠŠå®ƒæ”¾åˆ°å¦ä¸€ä¸ª git ä»“åº“ï¼Œç„¶åå°†å®ƒæ¨é€åˆ°å¦ä¸€ä¸ª Github ä»“åº“ã€‚

ç„¶åï¼Œæˆ‘å†³å®š fork ä¸€ä¸ªå« `mdx-prism` çš„åº“å»ä¿®å¤å®ƒçš„ä¸€äº›å°é—®é¢˜ï¼Œå¹¶ä¸”è®©å®ƒèƒ½å¤Ÿè‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚åŒæ ·çš„ï¼Œæˆ‘åˆæ–°å»ºäº†ä¸€ä¸ªæ–°çš„ git ä»“åº“ï¼Œé‡Œé¢æ”¾ç€ `mdx-prism` çš„ä»£ç ä»¥åŠå®ƒçš„åˆå§‹åŒ–é…ç½®ã€‚

æˆ‘æœ‰ 3 ä¸ª git ä»“åº“ï¼Œæ„å‘³ç€æˆ‘æœ‰äº†ä¸‰ä¸ª eslintï¼Œprettierï¼Œjestï¼Œbabelï¼Œå’Œ typescript é…ç½®ï¼Œæˆ‘æœ‰ 3 ä¸ª git ä»“åº“ï¼Œæ„å‘³ç€æˆ‘æœ‰äº†ä¸‰ä¸ª eslintï¼Œprettierï¼Œjestï¼Œbabelï¼Œå’Œ typescript é…ç½®ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯ç»´æŠ¤äº†ä¸€æ®µæ—¶é—´ã€‚

å¾ˆå¿«ï¼Œæˆ‘å¯¹æ¯æ¬¡çš„ä¾èµ–ï¼ˆåƒ TypeScriptï¼‰æ›´æ–°æ„Ÿåˆ°å›°æ‰°ï¼Œå› ä¸ºæ¯æ¬¡æˆ‘éƒ½éœ€è¦æ›´æ–°ä¸‰ä¸ªä»“åº“ï¼Œä¹Ÿå°±æ„å‘³ç€æˆ‘éœ€è¦ pull ä¸‰æ¬¡ã€‚æ¯å½“æˆ‘å­¦ä¼šäº†æ–°çš„çŸ¥è¯†ï¼Œæ¯”å¦‚è¯´å­¦ä¹ äº† eslint çš„æ–°è§„åˆ™ï¼Œæˆ‘éƒ½ä¸å¾—ä¸æ›´æ”¹ä¸‰ä¸ªä»£ç åº“ä¸­çš„ä»£ç ç­‰ç­‰ã€‚

æˆ‘çš„ç¬¬ä¸€ååº”æ˜¯ï¼š

> å¦‚æœæˆ‘æŠŠæ‰€æœ‰é¡¹ç›®æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶å¤¹å’Œä»“åº“é‡Œï¼Œåˆ›å»ºæˆ‘çš„åŸºç¡€é…ç½®ï¼Œç„¶åç”¨å®ƒå»æ‰©å±•åˆ°æ¯ä¸ªé¡¹ç›®é…ç½®é‡Œå‘¢ï¼Ÿ

ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä¸èƒ½ç®€å•åœ°å°†æ–‡ä»¶æ”¾åœ¨ä¸€èµ·ï¼Œæ‰©å±•é…ç½®ï¼Œç„¶åå¸Œæœ›å®ƒèƒ½å¤Ÿè¿è¡Œï¼Œå› ä¸ºå®é™…æ¯”é‚£å¤æ‚å¾—å¤šã€‚è¿™äº›å·¥å…·éœ€è¦æ¨¡å—/æ–‡ä»¶è¿›è¡Œè§£æï¼Œå¹¶ä¸”æˆ‘ä¹Ÿä¸æƒ³åœ¨å³å°†éƒ¨ç½²æœåŠ¡å‰å‘å¸ƒæ‰€æœ‰é¡¹ç›®ã€‚

è¿™æ—¶ï¼Œæˆ‘æ„è¯†åˆ°æˆ‘éœ€è¦ä¸€ä¸ª monorepo å·¥å…·å»è¿æ¥åˆ†æ•£çš„å„ä¸ªé¡¹ç›®ï¼Œè®©æˆ‘çš„ä½“éªŒæ›´å¥½ã€‚

æˆ‘å°è¯•ä¸€äº›è§£å†³æ–¹æ¡ˆï¼Œæœ€ç®€å•æ„å»ºå’Œè¿è¡Œçš„æ–¹å¼æ˜¯ Lerna + Yarn Workspacesã€‚

å½“ç„¶ï¼Œåœ¨æ„å»ºæµç¨‹ä¸­ï¼Œæˆ‘æœ‰ä¸€äº›æ„Ÿæ‚Ÿï¼Œæ¯”å¦‚ç†è§£ä¸ºä»€ä¹ˆæœ‰äº›æ„å»ºå¤±è´¥ï¼ˆä¸æ˜¯æ‰€æœ‰çš„åº”ç”¨å–œæ¬¢æå‡ä¾èµ–å…³ç³»ï¼‰ï¼Œå¿…é¡»é€‚é…æˆ‘çš„ pipelinesï¼Œä»¥åŠå¦‚ä½•æˆ‘å¦‚ä½•éƒ¨ç½²æ¯ä¸ªé¡¹ç›®ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘è¿˜æ˜¯ç®¡ç†æ‰€æœ‰ä¸œè¥¿ï¼Œå¹¶æœ‰ä¸ªåˆé€‚çš„é…ç½®ã€‚

æœ‰äº†ä¹‹å‰æœ€ç®€å•çš„è®¾ç½®ï¼Œæˆ‘å¼€å§‹åˆ›å»ºæ›´å°çš„ç‹¬ç«‹æ¨¡å—/åº”ç”¨å»å¤ç”¨ï¼Œæ‰©å±•ï¼Œå¹¶ä¸”åœ¨ä¸å½±å“æˆ‘ç°æœ‰çš„ä»£ç æ¡ä»¶ä¸‹ï¼Œå°è¯•æ–°çš„å·¥å…·ã€‚è¿™æ˜¯æˆ‘äº²çœ¼è§è¯å®ƒåœ¨ä¸€ä¸ª monorepo è¿è¡Œå¾—è®©äººæƒŠè®¶çš„æ—¶åˆ»ã€‚

## å…³äº Lerna + Yarn Workspaces

Lerna æ˜¯ä¸€ä¸ªé«˜çº§ monorepo å·¥å…·ï¼Œå®ƒæä¾›åŒæ—¶ç®¡ç†ä¸€ä¸ªæˆ–å¤šä¸ªåº”ç”¨/åŒ…çš„æŠ½è±¡ã€‚ 

ä½ å¯ä»¥é€šè¿‡è¿è¡Œç”¨ä¸€æ¡å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼šbuild, test, lint ç­‰ï¼‰ï¼Œæ¥æ§åˆ¶ä½ æ‰€æœ‰çš„é¡¹ç›®ï¼Œæˆ–è€…æ ¹æ®ä½ çš„éœ€è¦ï¼Œé€šè¿‡ `--scope` æ ‡è®°äº†æ¥è¿‡æ»¤æŸä¸ªæŒ‡å®šçš„é¡¹ç›®ã€‚

Yarn Workspaces æ˜¯ä¸€ä¸ªåº•å±‚çš„å·¥å…·ï¼Œå®ƒè´Ÿè´£å¤„ç†åŒ…çš„å®‰è£…ã€åœ¨é¡¹ç›®ä¹‹é—´åˆ›å»ºç¬¦å·é“¾æ¥ï¼Œå’Œåœ¨æ ¹ç›®å½•å’Œå—æ§çš„é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹ä¸­åˆ†é…æ¨¡å—ã€‚

ä½ å¯ä»¥ä½¿ç”¨ Lerna æˆ–è€… Yarn Workspaces å»ç®¡ç†ä½ çš„ä»“åº“ï¼Œä½†ä½ å¯èƒ½æ³¨æ„åˆ°ï¼Œç›¸æ¯”äºè¿™ä¸¤ä¸ªå·¥å…·çš„æ’ä»–æ€§æ¥è¯´ï¼Œå®ƒä»¬ä¹‹é—´çš„äº’è¡¥æ€§æ˜¯æ›´åŠ çªå‡ºçš„ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä»¬ä¸€èµ·è¿è¡Œçš„å¾ˆå¥½ã€‚

ç›´åˆ°ç°åœ¨ï¼Œè¿™ä¸ªç»„åˆä»ç„¶æ˜¯ä¸€ä¸ªå®è·µ monorepo çš„å¥½é€‰æ‹©ï¼Œä½†å¯èƒ½ä¼šçªç°å‡ºä¸€äº›â€œé—®é¢˜â€ï¼š

* Yarn Workspacesï¼ˆv1ï¼‰å·²ç»ä¸å†ç»´æŠ¤ï¼ˆä¸Šæ¬¡æ›´æ–°æ˜¯åœ¨ 2018ï¼‰ï¼›
* Lerna æ–‡æ¡£æ˜¯å¯ä»¥çš„ï¼ˆä½†ä¸å¤Ÿè¯¦ç»†ï¼‰ï¼Œä½ éœ€è¦è‡ªå·±å¼„æ˜ç™½å¾ˆå¤šé—®é¢˜ï¼›
* Lerna å‘å¸ƒç³»ç»Ÿå¹¶ä¸åƒçœ‹ä¸Šå»é‚£ä¹ˆç®€å•ï¼Œç‰¹åˆ«æ˜¯ç”¨ commit lint ç”Ÿæˆè‡ªåŠ¨å‘å¸ƒæ—¶ã€‚
* ä½ å¯èƒ½ä¼šä¸å¤ªç†è§£ä½ éœ€è¦è¿è¡Œçš„å‘½ä»¤æ˜¯ä»€ä¹ˆæ„æ€æˆ–è€…ä½ ä¸çŸ¥é“ä½ åœ¨è¿è¡Œå…¶å®ƒå‘½ä»¤çš„æ—¶å€™ï¼Œè¿˜æœ‰ä»€ä¹ˆå‘½ä»¤æ­£åœ¨è¿è¡Œä¸­ï¼›
* Lerna CLI æœ‰ä¸€äº›åƒ[ä½ æ— æ³•åœ¨åŒä¸€æ—¶é—´å®‰è£…å¤šä¸ªä¾èµ–](https://github.com/lerna/lerna/issues/2004) ç­‰é—®é¢˜ã€‚
* Lerna CLI `--scope` å¹¶ä¸å¯é å¹¶ä¸”éš¾ä»¥ç†è§£å’Œä½¿ç”¨ï¼›
* æœ‰ä¸€ä¸ª [wizard](https://github.com/webuniverseio/lerna-wizard) åœ¨å¸¸è§ä»»åŠ¡ä¸­å¸®åŠ©æˆ‘ä»¬ï¼Œä½†å®ƒæ›´åƒæ˜¯åœ¨ä¸»ä»“åº“ä¹‹å¤–ç»´æŠ¤çš„ã€‚
* [Lerna ç›®å‰æ˜¯æ²¡æœ‰ç»´æŠ¤çš„](https://github.com/lerna/lerna/issues/2703#issuecomment-744601134);

Lernaæ˜¯äº 2015 å¹´åˆ›å»ºçš„ï¼Œè¿™ä¸ªå·¥å…·çš„å‡ºç°å¸®åŠ©æˆ‘ä»¬è§£å†³äº†ç¼ºå°‘å·¥å…·ç®¡ç† JS monorepos çš„ç°çŠ¶ï¼Œå¹¶ä¸”å®ƒåœ¨ç®¡ç† JS monorepos ä¸Šåšå¾—å¾ˆå¥½ã€‚

ç„¶è€Œ Lerna å› ä¸ºæ²¡æœ‰ä¸€ä¸ªè‡´åŠ›äºå®ƒå‘å±•çš„å›¢é˜Ÿæˆ–æˆå‘˜å»æ›´æ–°å’Œè§„åˆ’è¿™ä¸ªå·¥å…·çš„æœªæ¥ï¼Œæ‰€ä»¥ Lerna æ­£åœ¨æ…¢æ…¢çš„é€€å‡ºç®¡ç† JS monorepos çš„èˆå°ã€‚

æˆ‘åœ¨è¿™é‡Œä¸æ˜¯æŠ±æ€¨åˆ›å»ºè€…å’Œç»´æŠ¤è€…ï¼Œå¼€æºçš„ä¸–ç•Œæœ‰è®¸å¤šçš„é—®é¢˜ï¼Œä½†è¿™æ˜¯å¦ä¸€ç¯‡æ–‡ç« çš„ä¸»é¢˜ã€‚

ä½ ç°åœ¨å¯èƒ½ä¼šè¿™ä¹ˆæƒ³ï¼š

> å¦‚æœ Lerna åœ¨è¿™ä¸ªæ—¶ä»£ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰ä»€ä¹ˆé€‰é¡¹ï¼Ÿ

## pnpm ç®€ä»‹

å¦‚æœä½ ä¸çŸ¥é“ï¼Œåƒ **npm** å’Œ **Yarn**ï¼Œ**pnpm** ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª JavaScript é¡¹ç›®çš„åŒ…ç®¡ç†å·¥å…·ã€‚å®ƒå’Œå‰ä¸¤è€…åšçš„æ˜¯ä¸€æ ·çš„äº‹ï¼Œåªæ˜¯æ›´åŠ é«˜æ•ˆã€‚

ä½¿ç”¨ **pnpm** æœ€å¤§çš„å¥½å¤„æ˜¯ **pnpm** è§£å†³äº† npm å¼•å…¥å’Œå¹¶ä¸”ä¹Ÿè¢« Yarn å¤åˆ¶äº†çš„é—®é¢˜ï¼Œå³ npm å’Œ Yarn å®‰è£…ä¾èµ–é¡¹çš„æ–¹å¼ã€‚

**pnpm** æ—¨åœ¨è§£å†³ä¸¤ä¸ªå¤§é—®é¢˜ï¼š

### ç£ç›˜ç©ºé—´

æ¯”å¦‚è¯´ä½ æœ‰ 5 ä¸ªåŒ…å« `react@17.0.2` ä½œä¸ºä¾èµ–çš„é¡¹ç›®ã€‚

å½“ä½ åœ¨æ‰€æœ‰é¡¹ç›®é‡Œ  **npm** or **Yarn** install æ—¶ï¼Œæ¯ä¸ªé¡¹ç›®å°†ä¼šåœ¨  `node_modules` ä¸­æœ‰å®ƒè‡ªå·±çš„ React å‰¯æœ¬ã€‚è€ƒè™‘åˆ°ä¸€ä¸ª React åŒ…çš„å¤§å°å¤§æ¦‚æ˜¯ **6.9kB**ï¼Œ é‚£ä¹ˆåœ¨5ä¸ªä»“åº“ä¸­ï¼Œæˆ‘ä»¬çš„ç£ç›˜ä¸­å°±ä¼šæœ‰ **34.5kB** ç›¸åŒçš„ä¾èµ–ã€‚

è¿™ä¸ªä¾‹å­çœ‹èµ·æ¥å¾ˆå°ï¼Œä½†æ¯ä¸ªä½¿ç”¨ JS çš„äººçŸ¥é“ï¼Œæœ‰æ—¶å€™ `node_modules` ç›®å½•çš„ä½“ç§¯å¾ˆå®¹æ˜“è¾¾åˆ° GB çº§åˆ«ã€‚

å¦‚æœä½¿ç”¨ **pnpm** å®‰è£…ä¾èµ–çš„è¯ï¼Œå®ƒé¦–å…ˆä¼šå°†ä¾èµ–ä¸‹è½½åˆ°å®ƒè‡ªå·±çš„ã€Œä»“åº“ã€ï¼ˆ`~/.pnpm-store`ï¼‰ä¸­ã€‚ä¹‹åï¼Œpnpm å°†åœ¨ä½ çš„é¡¹ç›®ä¸­çš„ `node_modules` ä¸­åˆ›å»ºä¸€ä¸ªè¯¥æ¨¡å—çš„ç¡¬é“¾æ¥ã€‚

æ‹¿ä¹‹å‰çš„ä¾‹å­ä¸¾ä¾‹ï¼Œ**pnpm** å°†åœ¨å®ƒè‡ªå·±çš„å­˜å‚¨æ–‡ä»¶å¤¹ä¸­å®‰è£… `react@17.0.2`ï¼Œå½“æˆ‘ä»¬å®‰è£…é¡¹ç›®çš„ä¾èµ–æ—¶ï¼Œå®ƒä¼šå…ˆæ£€æŸ¥ 17.0.2 ç‰ˆæœ¬çš„ React æ˜¯å¦å·²ç»ä¿å­˜ã€‚å¦‚æœæ˜¯ï¼Œåˆ™å®ƒä¼šåœ¨é¡¹ç›®çš„ `node_modules` åˆ›å»ºä¸€ä¸ªç¡¬é“¾æ¥ï¼ˆæŒ‡å‘ç£ç›˜ä¸­çš„æŸä¸ªæ–‡ä»¶ï¼‰ã€‚

ç›¸æ¯”äºåœ¨ç£ç›˜ä¸­ä¿å­˜ 5 ä¸ª `react@17.0.2` çš„å‰¯æœ¬ï¼ˆ**34.5kB**ï¼‰ï¼Œç°åœ¨æˆ‘ä»¬åªæœ‰ 1 ä¸ªå­˜æ”¾åœ¨ pnpm çš„ store çš„ç‰ˆæœ¬ï¼ˆ**6.9kB**ï¼‰ä»¥åŠåœ¨æ¯ä¸ªé¡¹ç›®ä¸­éƒ½æœ‰ä¸€ä¸ªå’Œ react çš„å‰¯æœ¬æ–‡ä»¶æœ‰ç›¸åŒåŠŸèƒ½çš„ç¡¬é“¾æ¥ï¼ˆhard linkï¼‰ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬èŠ‚çœäº†å¾ˆå¤šç£ç›˜ç©ºé—´ï¼Œå¹¶ä¸”å¦‚æœæˆ‘ä»¬çš„æ–°é¡¹ç›®ä½¿ç”¨äº†æˆ‘ä»¬å·²ç»å®‰è£…è¿‡çš„ä¾èµ–ï¼Œé‚£ä¹ˆæ–°é¡¹ç›®å®‰è£…ä¾èµ–çš„é€Ÿåº¦ä¼šæ›´åŠ çš„å¿«ã€‚

## å¹½çµä¾èµ–

å½“æˆ‘ä»¬ç”¨ **npm** å®‰è£…ä¾èµ–æ—¶ï¼Œä»–ä¼šæŠŠæ‰€æœ‰çš„ä¾èµ–å’Œä¾èµ–ä¸­çš„æ‰€æœ‰ä¸œè¥¿éƒ½æ‰“åŒ…åˆ° `node_modules` æ–‡ä»¶å¤¹ä¸‹ã€‚è¿™ç§æ–¹å¼å°±æ˜¯æ‰€è°“çš„â€œæ‰å¹³åŒ–æ–¹å¼â€ã€‚

è®©æˆ‘ä»¬åœ¨å®è·µä¸­æ¥çœ‹çœ‹ã€‚ä¸‹é¢æ˜¯ `package.json`ï¼š 

```json
{
  "dependencies": {
    "unified": "10.1.0"
  }
}
```

åœ¨è¿è¡Œ `npm install` ä¹‹åï¼Œ`node_modules` ä¼šå˜æˆä¸‹é¢è¿™æ ·ï¼š 

```text
node_modules
â”œâ”€â”€ @types
â”œâ”€â”€ bail
â”œâ”€â”€ extend
â”œâ”€â”€ is-buffer
â”œâ”€â”€ is-plain-obj
â”œâ”€â”€ trough
â”œâ”€â”€ unified
â”œâ”€â”€ unist-util-stringify-position
â”œâ”€â”€ vfile
â””â”€â”€ vfile-message
```

è™½ç„¶è¿™ç§æ–¹å¼å·²ç»å·¥ä½œäº†è®¸å¤šå¹´ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬ç§°è¿™ç§é—®é¢˜å«åšï¼šâ€œå¹½çµä¾èµ–â€ã€‚

ï¼ˆä¾‹å¦‚ï¼‰åœ¨æˆ‘ä»¬é¡¹ç›®ä¸­å£°æ˜çš„å”¯ä¸€çš„ä¾èµ–æ˜¯ `unified`ï¼Œä½†æˆ‘ä»¬ä»ç„¶èƒ½åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä»£ç ä¸­å¼•ç”¨åˆ° `is-plain-obj` æ¨¡å— (unified çš„ä¾èµ–)ï¼š

```js
import ob from "is-plain-obj";

console.log(ob); // [Function: isPlainObject]
```

å› ä¸ºä¸Šè¿°è¿™ç§æƒ…å†µæ˜¯å¯èƒ½å‘ç”Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å£°æ˜çš„ä¾èµ–ä»¥åŠä¾èµ–çš„ä¾èµ–ä¹Ÿå¯èƒ½å‡ºç°è¿™ç§é—®é¢˜ï¼Œå³åœ¨æ²¡æœ‰å£°æ˜æŸä¸ªä¾èµ–ä½œä¸ºä¾èµ–æˆ–å¯¹ç­‰ä¾èµ–ï¼ˆpeerDependencyï¼‰çš„å‰æä¸‹ï¼Œä» `node_modules` ä¸­å¼•å…¥äº†è¿™ä¸ªä¾èµ–ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ **pnpm** æ˜¯å¦‚ä½•å¤„ç†çš„ã€‚

ç”¨ç›¸åŒçš„ `package.json`ï¼Œç„¶åè¿è¡Œ `pnpm install`ï¼Œæˆ‘ä»¬å°†ä¼šæœ‰ä¸‹é¢çš„ `node_modules`ï¼š

```text
node_modules
â”œâ”€â”€ .pnpm
â”œâ”€â”€ @types
â”œâ”€â”€ unified -> .pnpm/unified@10.1.0/node_modules/unified
â””â”€â”€ .modules.yaml
```

å¦‚ä½ æ‰€è§ï¼Œ`node_module` ä¸­æœ‰ä¸”ä»…æœ‰ `unified` è¿™ä¸€ä¸ªä¾èµ–ï¼Œä½†æœ‰ä¸€ä¸ªç®­å¤´è¡¨æ˜è¿™ä¸ªæ¨¡å—æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ã€‚

ç„¶åï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ `.pnpm` é‡Œé¢æœ‰ä»€ä¹ˆï¼š

```text
node_modules
â”œâ”€â”€ .pnpm
â”‚ â”œâ”€â”€ @types+unist@2.0.6
â”‚ â”œâ”€â”€ bail@2.0.1
â”‚ â”œâ”€â”€ extend@3.0.2
â”‚ â”œâ”€â”€ is-buffer@2.0.5
â”‚ â”œâ”€â”€ is-plain-obj@4.0.0
â”‚ â”œâ”€â”€ node_modules
â”‚ â”œâ”€â”€ trough@2.0.2
â”‚ â”œâ”€â”€ unified@10.1.0
â”‚ â”œâ”€â”€ unist-util-stringify-position@3.0.0
â”‚ â”œâ”€â”€ vfile-message@3.0.2
â”‚ â”œâ”€â”€ vfile@5.2.0
â”‚ â””â”€â”€ lock.yaml
â”œâ”€â”€ @types
â”‚ â””â”€â”€ unist -> ../.pnpm/@types+unist@2.0.6/node_modules/@types/unist
â”œâ”€â”€ unified -> .pnpm/unified@10.1.0/node_modules/unified
â””â”€â”€ .modules.yaml
```

**pnpm** ä¼šå°†æ¯ä¸ªä¾èµ–é¡¹å®‰è£…åœ¨ `.pnpm` çš„å¯¹åº”ç›®å½•ï¼ˆåŒ…å+ç‰ˆæœ¬ï¼‰ä¸­ï¼Œç„¶åå°†ä½ å·²ç»åœ¨é¡¹ç›®çš„ package.json ä¸­æ˜ç¡®å®šä¹‰çš„é‚£äº›ä¾èµ–â€œç§»åŠ¨â€ï¼ˆè¯‘è€…æ³¨ï¼šå®é™…ä¸Šæ˜¯åˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥æŒ‡å‘ `.pnpm` ä¸­çš„å¯¹åº”æ¨¡å—ï¼‰åˆ°é¡¹ç›®çš„ `node_modules` ä¸­ã€‚

ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•åƒä»¥å‰ä¸€æ ·å†™ç›¸åŒçš„ä»£ç ï¼Œæˆ‘ä»¬å°†ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸º `is-plain-obj` æ²¡æœ‰å®‰è£…åœ¨ `node_modules` ä¸­ï¼š

```
internal/process/esm_loader.js:74
 internalBinding('errors').triggerUncaughtException(
 ^

Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'is-plain-obj' imported from /Users/raulmelo/development/sandbox/test-pnpm-npm/pnpm/index.js
```

è™½ç„¶ç”¨è¿™ç§æ–¹å¼å®‰è£… `node_modules` æ›´åŠ å¯é ï¼Œä½†è¿™å¯èƒ½ç ´å pnpm ä¸é‚£äº›åŸºäºæ‰å¹³åŒ– `node_modules` ç»“æ„æ„å»ºçš„åº”ç”¨çš„å…¼å®¹æ€§ã€‚

> ä¸€ä¸ªä¾‹å­å°±æ˜¯ Strapi v3ã€‚ä½ å¯ä»¥åœ¨[è¿™](https://github.com/strapi/strapi/issues/9604)çœ‹åˆ°, ä»–ä»¬ä¹Ÿæ„è¯†åˆ°äº†è¿™ä¸€ç‚¹ï¼Œåœ¨å°†æ¥æŸå¤©ä¹Ÿä¼šè§£å†³çš„ã€‚

å¹¸è¿çš„æ˜¯ï¼Œ**pnpm** è€ƒè™‘äº†è¿™äº›é—®é¢˜ï¼Œå¹¶ä¸”æä¾›äº†ä¸ªå« [`shamefully-hoist`](https://pnpm.io/npmrc#shamefully-hoist) çš„æ ‡è®°æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚

å½“æˆ‘ä»¬ç”¨è¿™ä¸ªæ ‡è®°æ—¶ï¼Œé¡¹ç›®ä¾èµ–ä¼šä¾ç…§â€œæ‰å¹³åŒ–çš„æ–¹å¼â€è¢«å®‰è£…ï¼Œè¿™ä½¿å¾—è¯¸å¦‚ Strapi è¿™æ ·çš„åº”ç”¨èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚

## pnpm Workspaces

**pnpm** åœ¨ v2 ä¸­å¼•å…¥äº†å·¥ä½œåŒºç‰¹æ€§ã€‚

å®ƒæ—¨åœ¨å¡«è¡¥å½“ä¸‹æ˜“äºä½¿ç”¨å’Œç»´æŠ¤è‰¯å¥½çš„ monorepo å·¥å…·çš„ç©ºç¼ºã€‚

å› ä¸ºå®ƒä»¬ï¼ˆæŒ‡ pnpm çš„å¼€å‘è€…ï¼‰å·²ç»æœ‰äº†åº•å±‚å·¥å…·ï¼ˆå³åŒ…ç®¡ç†å™¨ï¼‰ï¼Œæ‰€ä»¥ä»–ä»¬æ—¨åœ¨åœ¨ pnpm ä¸­æ–°åŠ å…¥ä¸€ä¸ªæ–°æ¨¡å—æ¥å¤„ç†å·¥ä½œåŒºï¼Œåªè¦ä½ åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `pnpm-workspace.yaml` æ–‡ä»¶ã€‚

å®ƒä¸ Lerna + Yarn Workspaces çš„é…ç½®å‡ ä¹ä¸€æ ·ï¼Œä½†æœ‰ä¸‰ä¸ªæ˜¾è‘—çš„ä¼˜åŠ¿ï¼š

1. æˆ‘ä»¬ä» **pnpm** æ§åˆ¶ç£ç›˜ç©ºé—´ä¿®å¤;
2. pnpm CLI å¾ˆå¥½ç”¨ï¼ˆå®ƒæ˜¯å†…ç½®çš„ï¼‰ï¼›
3. å®ƒè§£å†³äº†è®¸å¤š Lerna CLI å­˜åœ¨çš„é—®é¢˜ï¼Œåƒè¿‡æ»¤ã€å®‰è£…åŒä¸€ä¸ªåŒ…çš„å¤šä¸ªç‰ˆæœ¬ã€‚

ï¼ˆå‡ ä¹ï¼‰**pnpm** æ‰€æœ‰çš„å‘½ä»¤éƒ½æ”¯æŒ `--filter` æ ‡è¯†ç¬¦ã€‚æˆ‘è®¤ä¸ºè¿™ä¸ªæ ‡è¯†ç¬¦çš„æ„æ€æ˜¯ä¸è¨€è‡ªæ˜çš„ï¼Œï¼ˆä½†è¿˜æ˜¯è¦è¯´ä¸€ä¸‹ï¼‰ï¼Œå®ƒè¡¨ç¤ºåªä¼šä¸ºè¿‡æ»¤åçš„ä»“åº“æ‰§è¡Œè¿™æ¡å‘½ä»¤ã€‚

å‡è®¾ä½ æœ‰ä¸¤ä¸ªå®Œæ•´çš„åº”ç”¨ï¼Œä¸¤è€…éƒ½æœ‰ç‹¬ç«‹çš„æµæ°´çº¿ã€‚ä½¿ç”¨ Lerna + **npm** æˆ–è€… **Yarn**ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œå®‰è£…æ—¶ï¼Œæˆ‘ä»¬ä¼šä¸ºæ¯ä¸ªé¡¹ç›®éƒ½å•ç‹¬å®‰è£…ä¸€æ¬¡ä¾èµ–ã€‚

è¿™æ„å‘³ç€ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šä¸‹è½½ 1GB çš„ä¾èµ–æ–‡ä»¶è€Œé 300MBã€‚

æœ‰äº† **pnpm**ï¼Œæˆ‘å¯ä»¥ç®€å•åœ°è¿è¡Œä¸‹é¢çš„æŒ‡ä»¤ï¼š

```bash
pnpm install --filter website
```

ç°åœ¨ï¼Œåªæœ‰æ ¹ç›®å½•ä¾èµ–å’Œæˆ‘çš„ç½‘ç«™çš„ä¾èµ–ä¼šè¢«å®‰è£…ã€‚

`filter` å‘½ä»¤å·²ç»è¶³å¤Ÿä¾¿æ·äº†ï¼Œä½†æ˜¯å®ƒçš„å¥½å¤„ä¸æ­¢äºæ­¤ï¼Œå¹¶ä¸”è¿˜æä¾›äº†æ›´å¤šçš„çµæ´»æ€§ã€‚

æˆ‘ååˆ†å»ºè®®ä½ é˜…è¯»ä¸€ä¸‹ [pnpm's "Filtering" æ–‡æ¡£](https://pnpm.io/filtering) ç„¶åçœ‹ä¸€ä¸‹å®ƒæ˜¯æœ‰å¤šä¹ˆä»¤äººæƒŠè®¶ã€‚

> å¦ä¸€ä¸ªå»ºè®®ï¼š["pnpm vs Lernaï¼šåœ¨å¤šåŒ…ä»“åº“ä¸­ç­›é€‰"](https://medium.com/pnpm/pnpm-vs-lerna-filtering-in-a-multi-package-repository-1f68bc644d6a)

è¿™çœ‹èµ·æ¥æ˜¯ä¸€ä»¶ç‰¹åˆ«å°çš„äº‹æƒ…ï¼Œä½†å½“ä½ åœ¨ä¸åŒå·¥ä½œç¯å¢ƒä¸­å·¥ä½œæ—¶ï¼Œæ­£æ˜¯è¿™äº›å°ç»†èŠ‚ä¼šäº§ç”Ÿå¾ˆå¤§çš„ä¸åŒã€‚

## è¿ç§»

å¦‚æœä½ æŸ¥çœ‹æˆ‘å·²ç»åˆå¹¶çš„åŒ…å«æ‰€æœ‰è¿ç§»æ”¹åŠ¨çš„ PRï¼Œä½ å¯ä»¥çœ‹[è¿™é‡Œ](https://github.com/raulfdm/raulmelo-studio/pull/803) ã€‚æˆ‘å°†åªé«˜äº®æ‰€æœ‰æˆ‘éœ€è¦å±•ç¤ºçš„æ”¹åŠ¨ã€‚

### æ›¿æ¢å‘½ä»¤

æˆ‘æœ‰å¾ˆå¤šæ‰§è¡Œ `yarn` CLIçš„è„šæœ¬ã€‚å¯¹äºè¿™äº›ï¼Œæˆ‘åªéœ€è¦ç”¨ `pnpm <command>` æˆ–è€… `pnpm run <command>` æ›¿æ¢æ‰ï¼›

### ç§»é™¤ Yarn Workspace é…ç½®

åœ¨æˆ‘çš„ package.jsonï¼Œæˆ‘å·²ç»ä¸º Yarn å®šä¹‰äº†å·¥ä½œåŒºç›®å½•å¹¶ä¸”å®šä¹‰ä¸€äº›ä¸éœ€è¦æå‡åˆ°æ ¹ node_modules ç›®å½•ä¸‹çš„åŒ…ï¼›

```json
{
"workspaces": {
   "packages": [
     "packages/*",
     "apps/*"
   ],
   "nohoist": [
     "**/netlify-lambda",
     "**/netlify-lambda/**"
   ]
 }
}
```

æ‰€æœ‰çš„è¿™äº›è®¾ç½®éƒ½æˆä¸ºäº†è¿‡å»å¼ï¼ˆå³ä¸å†éœ€è¦äº†ï¼‰

### ç”¨ `pnpm-workspace.yml` ä»£æ›¿ `lerna.json` 

æˆ‘å·²ç»ç§»é™¤äº†ä¸‹é¢çš„é…ç½®ï¼š

```json
{
  "version": "independent",
  "packages": ["packages/*", "apps/*"],
  "npmClient": "yarn",
  "useWorkspaces": true,
  "command": {
    "version": {
      "allowBranch": "main"
    },
    "publish": {
      "conventionalCommits": true,
      "message": "chore(release): publish",
      "ignoreChanges": ["*.md", "!packages/**/*"]
    }
  }
}
```

æ¢æˆï¼š

```yml
prefer-workspace-packages: true
packages:
  - 'packages/*'
  - 'apps/*'
```

### é€‚é… pipelinesï¼ŒDockerfileï¼Œå’Œä¸»å¹³å°

ä¸€ä»¶äº‹æˆ‘å¿…é¡»æ”¹å˜çš„æ˜¯ï¼Œåœ¨æˆ‘çš„ Github Actionsã€Docker é•œåƒå’Œ Vercel çš„å®‰è£…è„šæœ¬ä¸­ç¡®ä¿åœ¨å®‰è£…é¡¹ç›®ä¾èµ–å‰å·²ç»å®‰è£…äº† `pnpm`ï¼š

```bash
npm install -g pnpm && pnpm install --filter <project-name>
```

è¿™æ˜¯å¿…ä¸å¯å°‘çš„æ­¥éª¤å› ä¸ºå¤§å¤šæ•°ç¯å¢ƒåŒ…å«å¼€ç®±å³ç”¨çš„ yarnï¼Œè€Œä¸æ˜¯ pnpmï¼ˆæˆ‘å¸Œæœ›è¿™ä¼šå¾ˆå¿«æ”¹å˜ï¼‰ã€‚

### ç§»é™¤ `yarn.lock` æ–‡ä»¶

è¿™ä¸ªæ–‡ä»¶å·²ç»ä¸å†éœ€è¦äº†ã€‚Pnpm åˆ›å»ºäº†å®ƒè‡ªèº«çš„ `pnpm-lock.yaml` é”æ–‡ä»¶å»æ§åˆ¶ä¾èµ–ç‰ˆæœ¬ã€‚

### é€‚é…æ„å»ºå‘½ä»¤

åœ¨æˆ‘ä¸ºæˆ‘çš„ç½‘ç«™è¿è¡Œ `lerna run build` æ—¶ï¼Œå®ƒåŒæ—¶ä¹Ÿä¼šè‡ªåŠ¨æ„å»ºé‚£äº›æˆ‘çš„ç½‘ç«™é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„åŒ…ã€‚

å¯¹äº **pnpm**ï¼Œæˆ‘å¿…é¡»æ˜ç¡®è¯´æ˜ï¼š

```bash
pnpm run build --filter website # åªæ„å»ºç½‘ç«™

pnpm run build --filter website... # é¦–å…ˆæ„å»ºç½‘ç«™é¡¹ç›®ç”¨åˆ°çš„æ‰€æœ‰ä¾èµ–ï¼Œæ­¤åï¼Œæ‰å¼€å§‹æ‰§è¡Œæˆ‘çš„ç½‘ç«™é¡¹ç›®çš„æ„å»º
```

è¿™äº›å£°æ˜æ˜¯ååˆ†é‡è¦çš„ï¼Œå› ä¸ºæˆ‘ä¸æ˜¯æŠŠæ‰€æœ‰åŒ…å‘å¸ƒåœ¨ NPMã€‚

### æ·»åŠ  `.npmrc`

pnpm é€šè¿‡ CLI æ¥æ”¶ä¸€å †æ ‡è¯†å’Œé€‰é¡¹ã€‚å¦‚æœæˆ‘ä¸æƒ³ä¸€ç›´é€šè¿‡å®ƒä»¬ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ª `.npmrc` æ–‡ä»¶ä¸­å®šä¹‰å®ƒä»¬ã€‚

æˆ‘æ·»åŠ åœ¨é‚£é‡Œçš„å”¯ä¸€é€‰é¡¹æ˜¯ï¼š

```bash
shamefully-hoist=true
```

æ­£å¦‚æˆ‘å‰é¢æ‰€è¯´ï¼ŒStrapi å¹¶ä¸é€‚é… pnpm å®‰è£… node_modules çš„æ–¹å¼ï¼Œè¿™å¾ˆå°´å°¬ã€‚

æäº¤è¿™äº›æ–‡ä»¶åï¼Œæˆ‘ä¿è¯äº†æ— è®ºåœ¨å“ªï¼Œæˆ‘è¿è¡Œ `pnpm install` æ—¶ï¼Œä¾èµ–éƒ½ä¼šè¢«æ­£ç¡®åœ°å®‰è£…ã€‚

### ç”¨ Changesets æ›¿æ¢ semantic-release

æˆ‘å¿…é¡»å¦ç™½ï¼Œæˆ‘ç°åœ¨è¿˜æ²¡æœ‰å®Œå…¨æµ‹è¯•è¿‡è¿™ä¸ªã€‚

æ€»è€Œè¨€ä¹‹ï¼Œåœ¨æˆ‘ä¹‹å‰çš„è®¾ç½®ä¸­ï¼Œæˆ‘è¢«è¿«ä»¥ä¸€ç§ç‰¹å®šçš„æ–¹å¼ç¼–å†™æäº¤ä¿¡æ¯ï¼Œä»¥ä¾¿è¯­ä¹‰å‘å¸ƒèƒ½å¤Ÿæ£€æŸ¥æˆ‘çš„æ›´æ”¹ï¼Œé€šè¿‡è¯»å–æäº¤ä¿¡æ¯è‡ªåŠ¨è¯†åˆ«æ›´æ”¹äº†ä»€ä¹ˆï¼Œæ›´æ”¹ç‰ˆæœ¬å·å¹¶å‘å¸ƒæˆ‘çš„åŒ…ã€‚

å®ƒä¸€ç›´è¿è¡Œçš„å¾ˆå¥½ï¼Œä½†ä»å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯è€ƒè™‘åˆ° Github Actions ç¯å¢ƒçš„å·¥ä½œæ–¹å¼ã€‚

å› æ­¤ï¼ŒPnpm å»ºè®®æˆ‘ä»¬ç”¨ [Atlassian çš„ changesets](https://pnpm.io/using-changesets) ã€‚

è¿™ä¸ªæ–¹å¼æœ‰ç‚¹ä¸åŒã€‚ç°åœ¨å¦‚æœæˆ‘æäº¤äº†ä¸€æ¬¡æ”¹åŠ¨ï¼Œæˆ‘å¿…é¡»åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ä¸€äº›å…ƒä¿¡æ¯å’Œæè¿°çš„ .md æ–‡ä»¶ï¼Œchangesets å°†ä¼šåŸºäºè¿™ä¸ªæ–‡ä»¶ï¼Œæ˜ç™½å¦‚ä½•ç”Ÿæˆæ”¹åŠ¨æ—¥å¿—ï¼Œä»¥åŠåº”è¯¥æ›´æ”¹å“ªä¸ªç‰ˆæœ¬ã€‚

æˆ‘ä»ç„¶éœ€è¦å®Œæˆè¿™ä¸ªè®¾ç½®ï¼Œä»¥åŠå¯èƒ½å†™ä¸€ç¯‡å…³äºå®ƒçš„æ–‡ç« ã€‚ ğŸ˜…

## ç»“è®º

è¿™å°±æ˜¯æˆ‘éœ€è¦ç”¨ **pnpm** workspaces ä»£æ›¿ Lerna + Yarn Workspaces çš„å…¨éƒ¨åŸºæœ¬çŸ¥è¯†ã€‚

è¯šå®è®²ï¼Œå®ƒæ¯”æˆ‘æœ€åˆè®¾æƒ³çš„æ›´ç®€å•ã€‚

æˆ‘è¶Šä½¿ç”¨ **pnpm** ï¼Œè¶Šäº«å—å®ƒã€‚è¿™ä¸ªé¡¹ç›®å¾ˆå¯é ï¼Œç”¨æˆ·ä½“éªŒä¹Ÿå¾ˆæ„‰å¿«ã€‚

## å‚è€ƒ

* [https://pnpm.io](https://pnpm.io)
* [https://github.com/lerna/lerna](https://github.com/lerna/lerna)
* [https://classic.yarnpkg.com/lang/en/docs/workspaces/](https://classic.yarnpkg.com/lang/en/docs/workspaces/)
* [https://medium.com/pnpm/pnpm-vs-lerna-filtering-in-a-multi-package-repository-1f68bc644d6a](https://medium.com/pnpm/pnpm-vs-lerna-filtering-in-a-multi-package-repository-1f68bc644d6a)
* [https://github.com/raulfdm/raulmelo-studio/pull/803/files](https://github.com/raulfdm/raulmelo-studio/pull/803/files)
* [https://medium.com/@307/hard-links-and-symbolic-links-a-comparison-7f2b56864cdd](https://medium.com/@307/hard-links-and-symbolic-links-a-comparison-7f2b56864cdd)

> å¦‚æœå‘ç°è¯‘æ–‡å­˜åœ¨é”™è¯¯æˆ–å…¶ä»–éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Œæ¬¢è¿åˆ° [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner) å¯¹è¯‘æ–‡è¿›è¡Œä¿®æ”¹å¹¶ PRï¼Œä¹Ÿå¯è·å¾—ç›¸åº”å¥–åŠ±ç§¯åˆ†ã€‚æ–‡ç« å¼€å¤´çš„ **æœ¬æ–‡æ°¸ä¹…é“¾æ¥** å³ä¸ºæœ¬æ–‡åœ¨ GitHub ä¸Šçš„ MarkDown é“¾æ¥ã€‚

---

> [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner) æ˜¯ä¸€ä¸ªç¿»è¯‘ä¼˜è´¨äº’è”ç½‘æŠ€æœ¯æ–‡ç« çš„ç¤¾åŒºï¼Œæ–‡ç« æ¥æºä¸º [æ˜é‡‘](https://juejin.im) ä¸Šçš„è‹±æ–‡åˆ†äº«æ–‡ç« ã€‚å†…å®¹è¦†ç›– [Android](https://github.com/xitu/gold-miner#android)ã€[iOS](https://github.com/xitu/gold-miner#ios)ã€[å‰ç«¯](https://github.com/xitu/gold-miner#å‰ç«¯)ã€[åç«¯](https://github.com/xitu/gold-miner#åç«¯)ã€[åŒºå—é“¾](https://github.com/xitu/gold-miner#åŒºå—é“¾)ã€[äº§å“](https://github.com/xitu/gold-miner#äº§å“)ã€[è®¾è®¡](https://github.com/xitu/gold-miner#è®¾è®¡)ã€[äººå·¥æ™ºèƒ½](https://github.com/xitu/gold-miner#äººå·¥æ™ºèƒ½)ç­‰é¢†åŸŸï¼Œæƒ³è¦æŸ¥çœ‹æ›´å¤šä¼˜è´¨è¯‘æ–‡è¯·æŒç»­å…³æ³¨ [æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)ã€[å®˜æ–¹å¾®åš](http://weibo.com/juejinfanyi)ã€[çŸ¥ä¹ä¸“æ ](https://zhuanlan.zhihu.com/juejinfanyi)ã€‚
